//
// This Protobuf definition was generated by Visual ReCode 2.0.3.1140
//
syntax = "proto3";

option csharp_namespace = "Viking.AnnotationServiceTypes.gRPC.V1.Protos";

package Viking.AnnotationServiceTypes.gRPC.V1;

import "Protos/AnnotationTypes.proto";
import "google/protobuf/timestamp.proto";

service AnnotateLocations {
  rpc CreateLocation (CreateLocationRequest) returns (CreateLocationResponse);
  rpc GetLocationByID (GetLocationByIDRequest) returns (GetLocationByIDResponse);
  rpc GetLocationsByID (GetLocationsByIDRequest) returns (GetLocationsByIDResponse);
  rpc GetLastModifiedLocation (GetLastModifiedLocationRequest) returns (GetLastModifiedLocationResponse);
  rpc GetLinkedLocations (GetLinkedLocationsRequest) returns (GetLinkedLocationsResponse);
  rpc GetLocationsForSection (GetLocationsForSectionRequest) returns (GetLocationsForSectionResponse);
  rpc GetLocationChangesInMosaicRegion (GetLocationChangesInMosaicRegionRequest) returns (GetLocationChangesInMosaicRegionResponse);
  rpc GetAnnotationsInMosaicRegion (GetAnnotationsInMosaicRegionRequest) returns (GetAnnotationsInMosaicRegionResponse);
  rpc GetLocationChanges (GetLocationChangesRequest) returns (GetLocationChangesResponse);
  rpc Update (UpdateLocationsRequest) returns (UpdateLocationsResponse);
  rpc CreateLocationLink (CreateLocationLinkRequest) returns (CreateLocationLinkResponse);
  rpc DeleteLocationLink (DeleteLocationLinkRequest) returns (DeleteLocationLinkResponse);
  rpc GetLocationLinksForSection (GetLocationLinksForSectionRequest) returns (GetLocationLinksForSectionResponse);
  rpc GetLocationLinksForSectionInMosaicRegion (GetLocationLinksForSectionInMosaicRegionRequest) returns (GetLocationLinksForSectionInMosaicRegionResponse);
  rpc GetLocationChangeLog (GetLocationChangeLogRequest) returns (GetLocationChangeLogResponse);
  rpc GetStructureLocations (GetStructureLocationsRequest) returns (GetStructureLocationsResponse);
}
 
message LocationChangeRequest {
		oneof action {
			Location create = 1;
			Location update = 2;
			int64 delete = 3;
		}
}

message LocationChangeResponse {
		bool success = 1;     //True if the change was applied
		oneof Action {
			Location created = 2;
			Location updated = 3;
			int64 deletedId = 4;
		}
}

message CreateLocationRequest {
  Location obj = 1; 
}


message GetLocationByIDRequest {
  int64 id = 1;
}


message GetLocationsByIDRequest {

  repeated int64 ids = 1;
}


message GetLastModifiedLocationRequest { }

message GetLinkedLocationsRequest {

  int64 id = 1;
}


message GetLocationsForSectionRequest {

  int64 section = 1;
}




message GetLocationChangesInMosaicRegionRequest {

  int64 z = 1;
  Geometry region = 2;
  double min_radius = 3;
  optional google.protobuf.Timestamp modified_after_this_utc_time = 4;
}


message GetAnnotationsInMosaicRegionRequest {

  int64 z = 1;
  Geometry region = 2;
  double min_radius = 3;
  optional google.protobuf.Timestamp modified_after_this_utc_time = 4;
}


message GetLocationChangesRequest {

  int64 section = 1;
  optional google.protobuf.Timestamp modified_after_this_utc_time = 2;   
}


message UpdateLocationsRequest {

  repeated LocationChangeRequest locations = 1;
}


message CreateLocationLinkRequest {

  int64 source_id = 1;
  int64 target_id = 2;
}


message DeleteLocationLinkRequest {

  int64 source_id = 1;
  int64 target_id = 2;
}


message GetLocationLinksForSectionRequest {

  int64 section = 1;
  int64 modified_after_this_time = 2;
  int64 query_executed_time = 3;
  repeated LocationLink deleted_links = 4;
}


message GetLocationLinksForSectionInMosaicRegionRequest {

  int64 section = 1;
  BoundingRectangle bbox = 2;
  double min_radius = 3;
  int64 modified_after_this_utc_time = 4;
  int64 query_executed_time = 5;
  repeated LocationLink deleted_links = 6;
}


message GetLocationChangeLogRequest {

  int64 structure_id = 1;
  optional google.protobuf.Timestamp begin_time = 2;
  optional google.protobuf.Timestamp end_time = 3;
}


message CreateLocationResponse { 
  Location result = 1;
}


message GetLocationByIDResponse {

  Location result = 1;
}


message GetLocationsByIDResponse {

  repeated Location results = 1;
}


message GetLastModifiedLocationResponse {

  Location result = 1;
}


message GetLinkedLocationsResponse {

  repeated int64 results = 1;
}


message GetLocationsForSectionResponse {

  repeated Location results = 1; 
  google.protobuf.Timestamp query_executed_time = 2;
}




message GetLocationChangesInMosaicRegionResponse {

  repeated Location results = 1;
  repeated int64 deleted_ids = 2;
  google.protobuf.Timestamp query_executed_time = 3;
}


message GetAnnotationsInMosaicRegionResponse {

  AnnotationSet result = 1;
  repeated int64 deleted_ids = 2;
  google.protobuf.Timestamp query_executed_time = 3;
}


message GetLocationChangesResponse {

  repeated Location results = 1;
  repeated int64 deleted_ids = 2;
  google.protobuf.Timestamp query_executed_time = 3;
}



message UpdateLocationsResponse {

  repeated LocationChangeResponse results = 1;
}
 
message CreateLocationLinkResponse { }

message DeleteLocationLinkResponse { }

message GetLocationLinksForSectionResponse {

  repeated LocationLink results = 1; 
  repeated LocationLink deleted = 2;
  google.protobuf.Timestamp query_executed_time = 3;
}
 
message GetLocationLinksForSectionInMosaicRegionResponse {

  repeated LocationLink results = 1;
}
 
message GetLocationChangeLogResponse {

  repeated LocationHistory results = 1;
}
  
message AnnotationSet { 
  repeated Structure structures = 1;
  repeated Location locations = 2;
}
 
message LocationHistory {

  int64 changed_column_mask = 1;
} 

message GetStructureLocationsRequest {

	int64 structure_id = 1;
}
 
message GetStructureLocationsResponse {

	repeated Location results = 1;
}