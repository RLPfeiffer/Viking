<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Identity Service &mdash; Viking 1.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="top" title="Viking 1.1 documentation" href="../../index.html" />
    <link rel="up" title="Developer Documentation" href="../toctree.html" />
    <link rel="next" title="Web Services" href="../IIS/webservices.html" />
    <link rel="prev" title="Database deployment" href="../SQL/database.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../http-routingtable.html" title="HTTP Routing Table"
             >routing table</a> |</li>
        <li class="right" >
          <a href="../IIS/webservices.html" title="Web Services"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../SQL/database.html" title="Database deployment"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Viking 1.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../toctree.html" accesskey="U">Developer Documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="identity-service">
<h1>Identity Service<a class="headerlink" href="#identity-service" title="Permalink to this headline">¶</a></h1>
<p>Viking uses the Apache licensed <a class="reference external" href="https://github.com/IdentityManager/IdentityManager">Identity Manager</a> and <a class="reference external" href="https://github.com/IdentityServer/IdentityServer3">Identity Server</a> projects to manage users, roles, and claims.</p>
<a class="reference internal image-reference" href="../../_images/IdentityServerOverview.png"><img alt="../../_images/IdentityServerOverview.png" class="align-center" src="../../_images/IdentityServerOverview.png" style="width: 796.0px; height: 316.0px;" /></a>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>IIS must be configured to use SSL.  Identity Server requires the use of SSL.</li>
<li>Make sure the Identity Server is running in an application pool with access rights to the identity database.</li>
<li>When the Identity Server first runs it will create the database if it is missing.  If the identity server IIS application does not have sufficient permissions to create tables in the database it will fail.</li>
<li>The default admin account in Identity Server is &#8220;admin&#8221; with password &#8220;administrator&#8221;.</li>
</ol>
<dl class="docutils">
<dt>Identity Server maps two sub domains,</dt>
<dd>/ids - The identity server.  Connect here to authenticate users.
/idm - The identity manager.  Connect here to manage users.</dd>
</dl>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>Application settings</dt>
<dd><ul class="first last simple">
<li><strong>AuthorityUri</strong> - The Uri of the identity service.  Example: <a class="reference external" href="https://localhost:8080/IdentityDebug/ids">https://localhost:8080/IdentityDebug/ids</a></li>
<li><strong>RedirectUri</strong> - The Uri to use when authenticating clients for implicit flow. Example: <a class="reference external" href="https://localhost:8080/IdentityDebug/idm">https://localhost:8080/IdentityDebug/idm</a></li>
<li><strong>IdentityManagerUri</strong>  - The Uri of the identity manager. Example: <a class="reference external" href="https://localhost:8080/IdentityDebug/idm">https://localhost:8080/IdentityDebug/idm</a></li>
<li><strong>X509SerialNumber</strong> - The serial number of the certificate we should sign our tokens with from the machine&#8217;s root store.  Application identity must have sufficient rights to read the private key.</li>
<li><strong>EmbeddedX509Password</strong> - If Identity server is compiled to embed the certificate this is the password to open the embedded certificate</li>
<li><strong>VikingClientSecret</strong> - Client secret we expect for Authorization code flow from the Viking client.  The client must send this secret, hashed with SHA256, to interact with Identity Server.</li>
</ul>
</dd>
<dt>Connection strings</dt>
<dd><ul class="first last simple">
<li><strong>IdentityDB</strong> - Connects to the SQL database containing users and roles.  These are created if they do not exist.</li>
<li><strong>AspId</strong> - Connects to the SQL database containing the ASP.NET ID tables.  These are created if they do not exist.</li>
</ul>
</dd>
</dl>
</div>
</div>
<div class="section" id="troubleshooting">
<h1>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h1>
<ul>
<li><dl class="first docutils">
<dt>Make sure the application identity the Identity Server is running under has permission to access the private key.  Otherwise this exception is thrown internally.::</dt>
<dd><p class="first last">Exception:Thrown: &#8220;IDX10614: AsymmetricSecurityKey.GetSignatureFormater( &#8216;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&#8217; ) threw an exception.
Key: &#8216;System.IdentityModel.Tokens.X509AsymmetricSecurityKey&#8217;
SignatureAlgorithm: &#8216;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&#8217;, check to make sure the SignatureAlgorithm is supported.
Exception:&#8217;System.Security.Cryptography.CryptographicException: Keyset does not exist</p>
</dd>
</dl>
</li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Identity Service</a><ul>
<li><a class="reference internal" href="#setup">Setup</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#troubleshooting">Troubleshooting</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../SQL/database.html"
                        title="previous chapter">Database deployment</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../IIS/webservices.html"
                        title="next chapter">Web Services</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/server/Identity/identity.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, James Anderson.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.3</a>
      
      |
      <a href="../../_sources/server/Identity/identity.txt"
          rel="nofollow">Page source</a></li>
    </div>

    

    
  </body>
</html>