2022-02-17 15:25:41.066 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 15:25:41.658 -08:00 [INF] Executed DbCommand (54ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 15:25:41.725 -08:00 [INF] Executed DbCommand (57ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 15:25:41.776 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 15:25:41.821 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 15:25:41.873 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 15:25:41.889 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 15:25:42.095 -08:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2022-02-17 15:25:42.146 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:25:42.427 -08:00 [INF] Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 15:25:42.471 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 15:25:42.517 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 15:25:42.561 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 15:25:42.607 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 15:25:42.609 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 15:25:42.789 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[Name] = N'Administrator'
2022-02-17 15:25:42.813 -08:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2022-02-17 15:25:42.819 -08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2022-02-17 15:25:42.913 -08:00 [INF] User profile is available. Using 'C:\Users\u0490822\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2022-02-17 15:25:42.921 -08:00 [INF] Creating key {13d2ddb8-deab-4cbd-952a-709d0901e13b} with creation date 2022-02-17 23:25:42Z, activation date 2022-02-17 23:25:42Z, and expiration date 2022-05-18 23:25:42Z.
2022-02-17 15:25:42.930 -08:00 [INF] Writing data to file 'C:\Users\u0490822\AppData\Local\ASP.NET\DataProtection-Keys\key-13d2ddb8-deab-4cbd-952a-709d0901e13b.xml'.
2022-02-17 15:26:00.195 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 15:26:00.223 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 15:26:00.234 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:26:00.365 -08:00 [INF] Executed DbCommand (52ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:26:00.435 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 234.7120 ms
2022-02-17 15:26:00.439 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 245.5145ms
2022-02-17 15:26:00.483 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 15:26:00.485 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 15:26:00.519 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 35.0916 ms
2022-02-17 15:26:00.525 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 41.7601ms
2022-02-17 15:26:00.599 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 15:26:00.658 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 15:26:00.698 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:26:00.747 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:26:00.766 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIDJDML8KM:00000002","TimeStamp":"2022-02-17T23:26:00.0000000Z","ProcessId":24892,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 15:26:00.867 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:26:00.950 -08:00 [INF] Executed DbCommand (56ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 15:26:01.000 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:26:01.062 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 15:26:01.123 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 15:26:01.150 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIDJDML8KM:00000002","TimeStamp":"2022-02-17T23:26:01.0000000Z","ProcessId":24892,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 15:26:01.229 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 15:26:01.235 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 15:26:01.319 -08:00 [INF] Executed DbCommand (51ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 15:26:01.385 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 15:26:01.439 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 15:26:01.495 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 15:26:01.750 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****3SRg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIDJDML8KM:00000002","TimeStamp":"2022-02-17T23:26:01.0000000Z","ProcessId":24892,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 15:26:01.761 -08:00 [INF] HTTP POST /connect/token responded 200 in 1161.7218 ms
2022-02-17 15:26:01.763 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 1163.8958ms
2022-02-17 15:26:01.772 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 15:26:01.774 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 15:26:01.816 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:26:01.864 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:26:01.920 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 15:26:01.975 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 15:26:02.027 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 15:26:02.078 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 15:26:02.123 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 15:26:02.126 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 15:26:02.128 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 354.8347 ms
2022-02-17 15:26:02.129 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 356.4562ms
2022-02-17 15:26:02.136 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001//api/GetApplicationUser - -
2022-02-17 15:26:02.164 -08:00 [INF] HTTP GET //api/GetApplicationUser responded 404 in 28.2484 ms
2022-02-17 15:26:02.166 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001//api/GetApplicationUser - - - 404 0 - 30.5780ms
2022-02-17 15:26:12.970 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 15:26:13.028 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 15:26:13.033 -08:00 [INF] Removing 0 grants
2022-02-17 15:26:13.084 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 15:26:13.087 -08:00 [INF] Removing 0 device flow codes
2022-02-17 15:26:39.422 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 15:26:39.423 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 15:26:39.424 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:26:39.470 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:26:39.473 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 50.8643 ms
2022-02-17 15:26:39.474 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 52.6132ms
2022-02-17 15:26:39.517 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 15:26:39.518 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 15:26:39.520 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 2.4317 ms
2022-02-17 15:26:39.521 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 4.2302ms
2022-02-17 15:26:39.582 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 15:26:39.583 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 15:26:39.586 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:26:39.633 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:26:39.636 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIDJDML8KP:00000002","TimeStamp":"2022-02-17T23:26:39.0000000Z","ProcessId":24892,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 15:26:39.688 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:26:39.735 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 15:26:39.785 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:26:39.834 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 15:26:39.839 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 15:26:39.841 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIDJDML8KP:00000002","TimeStamp":"2022-02-17T23:26:39.0000000Z","ProcessId":24892,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 15:26:39.897 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 15:26:39.906 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 15:26:39.973 -08:00 [INF] Executed DbCommand (50ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 15:26:40.020 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 15:26:40.066 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 15:26:40.113 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 15:26:40.117 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****AUrg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIDJDML8KP:00000002","TimeStamp":"2022-02-17T23:26:40.0000000Z","ProcessId":24892,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 15:26:40.125 -08:00 [INF] HTTP POST /connect/token responded 200 in 542.3355 ms
2022-02-17 15:26:40.127 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 544.4916ms
2022-02-17 15:26:40.135 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 15:26:40.138 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 15:26:40.140 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:26:40.190 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:26:40.240 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 15:26:40.289 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 15:26:40.340 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 15:26:40.387 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 15:26:40.440 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 15:26:40.443 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 15:26:40.444 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 306.5335 ms
2022-02-17 15:26:40.446 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 310.1042ms
2022-02-17 15:26:42.847 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001//Api/GetApplicationUser - -
2022-02-17 15:26:42.848 -08:00 [INF] HTTP GET //Api/GetApplicationUser responded 404 in 0.4192 ms
2022-02-17 15:26:42.849 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001//Api/GetApplicationUser - - - 404 0 - 2.0589ms
2022-02-17 15:26:43.107 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 15:26:43.153 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 15:26:43.156 -08:00 [INF] Removing 0 grants
2022-02-17 15:26:43.199 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 15:26:43.202 -08:00 [INF] Removing 0 device flow codes
2022-02-17 15:27:13.212 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 15:27:13.262 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 15:27:13.263 -08:00 [INF] Removing 0 grants
2022-02-17 15:27:13.308 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 15:27:13.309 -08:00 [INF] Removing 0 device flow codes
2022-02-17 15:27:43.311 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 15:27:43.372 -08:00 [INF] Executed DbCommand (54ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 15:27:43.375 -08:00 [INF] Removing 0 grants
2022-02-17 15:27:43.420 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 15:27:43.428 -08:00 [INF] Removing 0 device flow codes
2022-02-17 15:28:24.676 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 15:28:25.261 -08:00 [INF] Executed DbCommand (59ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 15:28:25.322 -08:00 [INF] Executed DbCommand (52ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 15:28:25.367 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 15:28:25.412 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 15:28:25.461 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 15:28:25.475 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 15:28:25.677 -08:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2022-02-17 15:28:25.725 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:28:26.012 -08:00 [INF] Executed DbCommand (52ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 15:28:26.058 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 15:28:26.105 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 15:28:26.150 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 15:28:26.197 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 15:28:26.199 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 15:28:26.374 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[Name] = N'Administrator'
2022-02-17 15:28:26.398 -08:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2022-02-17 15:28:26.404 -08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2022-02-17 15:28:26.498 -08:00 [INF] User profile is available. Using 'C:\Users\u0490822\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2022-02-17 15:28:43.747 -08:00 [INF] Request starting HTTP/2 GET https://localhost:5001/ - -
2022-02-17 15:28:43.787 -08:00 [INF] Executing endpoint 'IdentityServer.Controllers.HomeController.Index (IdentityServer)'
2022-02-17 15:28:43.796 -08:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Index() on controller IdentityServer.Controllers.HomeController (IdentityServer).
2022-02-17 15:28:43.884 -08:00 [INF] Executing action method IdentityServer.Controllers.HomeController.Index (IdentityServer) - Validation state: "Valid"
2022-02-17 15:28:43.888 -08:00 [INF] Executed action method IdentityServer.Controllers.HomeController.Index (IdentityServer), returned result Microsoft.AspNetCore.Mvc.ViewResult in 0.5879ms.
2022-02-17 15:28:43.901 -08:00 [INF] Executing ViewResult, running view Index.
2022-02-17 15:28:43.998 -08:00 [INF] Executed ViewResult - view Index executed in 97.8664ms.
2022-02-17 15:28:44.000 -08:00 [INF] Executed action IdentityServer.Controllers.HomeController.Index (IdentityServer) in 201.6546ms
2022-02-17 15:28:44.001 -08:00 [INF] Executed endpoint 'IdentityServer.Controllers.HomeController.Index (IdentityServer)'
2022-02-17 15:28:44.002 -08:00 [INF] HTTP GET / responded 200 in 250.5366 ms
2022-02-17 15:28:44.006 -08:00 [INF] Request finished HTTP/2 GET https://localhost:5001/ - - - 200 - text/html;+charset=utf-8 260.5758ms
2022-02-17 15:28:44.013 -08:00 [INF] Request starting HTTP/2 GET https://localhost:5001/lib/bootstrap/dist/css/bootstrap.css - -
2022-02-17 15:28:44.015 -08:00 [INF] Request starting HTTP/2 GET https://localhost:5001/css/site.css - -
2022-02-17 15:28:44.015 -08:00 [INF] Request starting HTTP/2 GET https://localhost:5001/images/VikingBanner1.jpg - -
2022-02-17 15:28:44.016 -08:00 [INF] Request starting HTTP/2 GET https://localhost:5001/lib/bootstrap/dist/js/bootstrap.js - -
2022-02-17 15:28:44.017 -08:00 [INF] Request starting HTTP/2 GET https://localhost:5001/js/site.js?v=ji3-IxbEzYWjzzLCGkF1KDjrT2jLbbrSYXw-AhMPNIA - -
2022-02-17 15:28:44.015 -08:00 [INF] Request starting HTTP/2 GET https://localhost:5001/lib/jquery/dist/jquery.js - -
2022-02-17 15:28:44.015 -08:00 [INF] Request starting HTTP/2 GET https://localhost:5001/images/NetworkBanner.png - -
2022-02-17 15:28:44.035 -08:00 [INF] Sending file. Request path: '/js/site.js'. Physical path: 'C:\src\git\Viking\Servers\IdentityServer\IdentityServer\wwwroot\js\site.js'
2022-02-17 15:28:44.036 -08:00 [INF] HTTP GET /js/site.js?v=ji3-IxbEzYWjzzLCGkF1KDjrT2jLbbrSYXw-AhMPNIA responded 200 in 4.7615 ms
2022-02-17 15:28:44.058 -08:00 [INF] Sending file. Request path: '/css/site.css'. Physical path: 'C:\src\git\Viking\Servers\IdentityServer\IdentityServer\wwwroot\css\site.css'
2022-02-17 15:28:44.061 -08:00 [INF] Request finished HTTP/2 GET https://localhost:5001/js/site.js?v=ji3-IxbEzYWjzzLCGkF1KDjrT2jLbbrSYXw-AhMPNIA - - - 200 35 application/javascript 40.9422ms
2022-02-17 15:28:44.084 -08:00 [INF] HTTP GET /css/site.css responded 200 in 66.9519 ms
2022-02-17 15:28:44.099 -08:00 [INF] Sending file. Request path: '/lib/bootstrap/dist/js/bootstrap.js'. Physical path: 'C:\src\git\Viking\Servers\IdentityServer\IdentityServer\wwwroot\lib\bootstrap\dist\js\bootstrap.js'
2022-02-17 15:28:44.100 -08:00 [INF] Request finished HTTP/2 GET https://localhost:5001/css/site.css - - - 200 2102 text/css 85.0223ms
2022-02-17 15:28:44.101 -08:00 [INF] Sending file. Request path: '/images/VikingBanner1.jpg'. Physical path: 'C:\src\git\Viking\Servers\IdentityServer\IdentityServer\wwwroot\images\VikingBanner1.jpg'
2022-02-17 15:28:44.103 -08:00 [INF] HTTP GET /lib/bootstrap/dist/js/bootstrap.js responded 200 in 72.2046 ms
2022-02-17 15:28:44.101 -08:00 [INF] Sending file. Request path: '/images/NetworkBanner.png'. Physical path: 'C:\src\git\Viking\Servers\IdentityServer\IdentityServer\wwwroot\images\NetworkBanner.png'
2022-02-17 15:28:44.099 -08:00 [INF] Sending file. Request path: '/lib/bootstrap/dist/css/bootstrap.css'. Physical path: 'C:\src\git\Viking\Servers\IdentityServer\IdentityServer\wwwroot\lib\bootstrap\dist\css\bootstrap.css'
2022-02-17 15:28:44.099 -08:00 [INF] Sending file. Request path: '/lib/jquery/dist/jquery.js'. Physical path: 'C:\src\git\Viking\Servers\IdentityServer\IdentityServer\wwwroot\lib\jquery\dist\jquery.js'
2022-02-17 15:28:44.105 -08:00 [INF] HTTP GET /images/VikingBanner1.jpg responded 200 in 75.3632 ms
2022-02-17 15:28:44.107 -08:00 [INF] HTTP GET /images/NetworkBanner.png responded 200 in 74.5340 ms
2022-02-17 15:28:44.107 -08:00 [INF] Request finished HTTP/2 GET https://localhost:5001/lib/bootstrap/dist/js/bootstrap.js - - - 200 72084 application/javascript 91.3721ms
2022-02-17 15:28:44.108 -08:00 [INF] HTTP GET /lib/bootstrap/dist/css/bootstrap.css responded 200 in 94.0184 ms
2022-02-17 15:28:44.109 -08:00 [INF] HTTP GET /lib/jquery/dist/jquery.js responded 200 in 77.2887 ms
2022-02-17 15:28:44.110 -08:00 [INF] Request finished HTTP/2 GET https://localhost:5001/images/VikingBanner1.jpg - - - 200 552196 image/jpeg 94.6493ms
2022-02-17 15:28:44.111 -08:00 [INF] Request finished HTTP/2 GET https://localhost:5001/images/NetworkBanner.png - - - 200 475757 image/png 95.7044ms
2022-02-17 15:28:44.113 -08:00 [INF] Request finished HTTP/2 GET https://localhost:5001/lib/bootstrap/dist/css/bootstrap.css - - - 200 152767 text/css 99.9128ms
2022-02-17 15:28:44.114 -08:00 [INF] Request finished HTTP/2 GET https://localhost:5001/lib/jquery/dist/jquery.js - - - 200 268219 application/javascript 99.0260ms
2022-02-17 15:28:44.128 -08:00 [INF] Request starting HTTP/2 GET https://localhost:5001/favicon.ico - -
2022-02-17 15:28:44.129 -08:00 [INF] Request starting HTTP/2 GET https://localhost:5001/lib/bootstrap/dist/fonts/glyphicons-halflings-regular.woff2 - -
2022-02-17 15:28:44.136 -08:00 [INF] Sending file. Request path: '/favicon.ico'. Physical path: 'C:\src\git\Viking\Servers\IdentityServer\IdentityServer\wwwroot\favicon.ico'
2022-02-17 15:28:44.137 -08:00 [INF] HTTP GET /favicon.ico responded 200 in 7.4961 ms
2022-02-17 15:28:44.138 -08:00 [INF] Request finished HTTP/2 GET https://localhost:5001/favicon.ico - - - 200 32038 image/x-icon 9.5933ms
2022-02-17 15:28:44.139 -08:00 [INF] Sending file. Request path: '/lib/bootstrap/dist/fonts/glyphicons-halflings-regular.woff2'. Physical path: 'C:\src\git\Viking\Servers\IdentityServer\IdentityServer\wwwroot\lib\bootstrap\dist\fonts\glyphicons-halflings-regular.woff2'
2022-02-17 15:28:44.140 -08:00 [INF] HTTP GET /lib/bootstrap/dist/fonts/glyphicons-halflings-regular.woff2 responded 200 in 8.9586 ms
2022-02-17 15:28:44.141 -08:00 [INF] Request finished HTTP/2 GET https://localhost:5001/lib/bootstrap/dist/fonts/glyphicons-halflings-regular.woff2 - - - 200 18028 font/woff2 12.9792ms
2022-02-17 15:28:48.671 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 15:28:48.676 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 15:28:48.687 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:28:48.815 -08:00 [INF] Executed DbCommand (52ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:28:48.872 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 200.1342 ms
2022-02-17 15:28:48.874 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 203.0411ms
2022-02-17 15:28:48.920 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 15:28:48.924 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 15:28:48.949 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 28.2051 ms
2022-02-17 15:28:48.951 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 30.8404ms
2022-02-17 15:28:49.008 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 15:28:49.020 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 15:28:49.054 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:28:49.105 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:28:49.122 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIDKRPE99L:00000002","TimeStamp":"2022-02-17T23:28:49.0000000Z","ProcessId":22760,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 15:28:49.229 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:28:49.309 -08:00 [INF] Executed DbCommand (54ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 15:28:49.358 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:28:49.420 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 15:28:49.472 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 15:28:49.484 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIDKRPE99L:00000002","TimeStamp":"2022-02-17T23:28:49.0000000Z","ProcessId":22760,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 15:28:49.552 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 15:28:49.560 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 15:28:49.638 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 15:28:49.706 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 15:28:49.758 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 15:28:49.811 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 15:28:49.911 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****qm7g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIDKRPE99L:00000002","TimeStamp":"2022-02-17T23:28:49.0000000Z","ProcessId":22760,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 15:28:49.924 -08:00 [INF] HTTP POST /connect/token responded 200 in 914.3286 ms
2022-02-17 15:28:49.925 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 916.6268ms
2022-02-17 15:28:49.934 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 15:28:49.936 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 15:28:49.978 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:28:50.027 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:28:50.084 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 15:28:50.138 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 15:28:50.184 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 15:28:50.230 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 15:28:50.276 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 15:28:50.280 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 15:28:50.282 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 347.0759 ms
2022-02-17 15:28:50.283 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 348.6773ms
2022-02-17 15:28:52.732 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001//Api/GetApplicationUser - -
2022-02-17 15:28:52.735 -08:00 [INF] HTTP GET //Api/GetApplicationUser responded 404 in 1.6761 ms
2022-02-17 15:28:52.736 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001//Api/GetApplicationUser - - - 404 0 - 3.3203ms
2022-02-17 15:28:56.519 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 15:28:56.575 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 15:28:56.578 -08:00 [INF] Removing 0 grants
2022-02-17 15:28:56.629 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 15:28:56.633 -08:00 [INF] Removing 0 device flow codes
2022-02-17 15:29:26.643 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 15:29:26.691 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 15:29:26.693 -08:00 [INF] Removing 0 grants
2022-02-17 15:29:26.739 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 15:29:26.742 -08:00 [INF] Removing 0 device flow codes
2022-02-17 15:29:56.747 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 15:29:56.794 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 15:29:56.797 -08:00 [INF] Removing 0 grants
2022-02-17 15:29:56.842 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 15:29:56.845 -08:00 [INF] Removing 0 device flow codes
2022-02-17 15:30:35.862 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 15:30:36.821 -08:00 [INF] Executed DbCommand (57ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 15:30:36.888 -08:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 15:30:36.936 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 15:30:36.984 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 15:30:37.037 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 15:30:37.053 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 15:30:37.257 -08:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2022-02-17 15:30:37.306 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:30:37.587 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 15:30:37.635 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 15:30:37.680 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 15:30:37.730 -08:00 [INF] Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 15:30:37.778 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 15:30:37.780 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 15:30:37.961 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[Name] = N'Administrator'
2022-02-17 15:30:37.983 -08:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2022-02-17 15:30:37.992 -08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2022-02-17 15:30:38.084 -08:00 [INF] User profile is available. Using 'C:\Users\u0490822\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2022-02-17 15:30:38.406 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 15:30:38.432 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 15:30:38.444 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:30:38.577 -08:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:30:38.677 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 265.8976 ms
2022-02-17 15:30:38.682 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 278.3331ms
2022-02-17 15:30:38.736 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 15:30:38.740 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 15:30:38.774 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 36.1740 ms
2022-02-17 15:30:38.781 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 44.5937ms
2022-02-17 15:30:38.876 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 15:30:38.897 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 15:30:38.950 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:30:39.000 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:30:39.022 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIDM0JSKSM:00000002","TimeStamp":"2022-02-17T23:30:39.0000000Z","ProcessId":27860,"LocalIpAddress":"127.0.0.1:5001","RemoteIpAddress":"127.0.0.1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 15:30:39.131 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:30:39.226 -08:00 [INF] Executed DbCommand (63ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 15:30:39.293 -08:00 [INF] Executed DbCommand (62ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:30:39.360 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 15:30:39.428 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 15:30:39.439 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIDM0JSKSM:00000002","TimeStamp":"2022-02-17T23:30:39.0000000Z","ProcessId":27860,"LocalIpAddress":"127.0.0.1:5001","RemoteIpAddress":"127.0.0.1","$type":"UserLoginSuccessEvent"}
2022-02-17 15:30:39.502 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 15:30:39.508 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 15:30:39.583 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 15:30:39.643 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 15:30:39.696 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 15:30:39.748 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 15:30:39.845 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****WpyQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIDM0JSKSM:00000002","TimeStamp":"2022-02-17T23:30:39.0000000Z","ProcessId":27860,"LocalIpAddress":"127.0.0.1:5001","RemoteIpAddress":"127.0.0.1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 15:30:39.859 -08:00 [INF] HTTP POST /connect/token responded 200 in 982.0696 ms
2022-02-17 15:30:39.861 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 984.5319ms
2022-02-17 15:30:39.868 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 15:30:39.869 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 15:30:39.912 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:30:39.960 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:30:40.015 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 15:30:40.068 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 15:30:40.115 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 15:30:40.161 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 15:30:40.208 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 15:30:40.211 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 15:30:40.213 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 343.8505 ms
2022-02-17 15:30:40.214 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 345.3811ms
2022-02-17 15:30:41.539 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001//Api/GetApplicationUser - -
2022-02-17 15:30:41.566 -08:00 [INF] HTTP GET //Api/GetApplicationUser responded 404 in 25.6601 ms
2022-02-17 15:30:41.568 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001//Api/GetApplicationUser - - - 404 0 - 28.3316ms
2022-02-17 15:31:05.049 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 15:31:05.050 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 15:31:05.052 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:31:05.099 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:31:05.103 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 53.4029 ms
2022-02-17 15:31:05.104 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 55.2811ms
2022-02-17 15:31:05.147 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 15:31:05.149 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 15:31:05.150 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 1.5346 ms
2022-02-17 15:31:05.151 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 3.7121ms
2022-02-17 15:31:05.227 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 15:31:05.228 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 15:31:05.233 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:31:05.282 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:31:05.288 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIDM0JSKSP:00000002","TimeStamp":"2022-02-17T23:31:05.0000000Z","ProcessId":27860,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 15:31:05.344 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:31:05.391 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 15:31:05.439 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:31:05.487 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 15:31:05.491 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 15:31:05.492 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIDM0JSKSP:00000002","TimeStamp":"2022-02-17T23:31:05.0000000Z","ProcessId":27860,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 15:31:05.548 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 15:31:05.551 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 15:31:05.601 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 15:31:05.651 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 15:31:05.699 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 15:31:05.750 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 15:31:05.754 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****kalg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIDM0JSKSP:00000002","TimeStamp":"2022-02-17T23:31:05.0000000Z","ProcessId":27860,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 15:31:05.762 -08:00 [INF] HTTP POST /connect/token responded 200 in 533.7532 ms
2022-02-17 15:31:05.763 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 535.7269ms
2022-02-17 15:31:05.771 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 15:31:05.773 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 15:31:05.774 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:31:05.822 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:31:05.873 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 15:31:05.925 -08:00 [INF] Executed DbCommand (49ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 15:31:05.973 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 15:31:06.019 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 15:31:06.068 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 15:31:06.074 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 15:31:06.075 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 302.8993 ms
2022-02-17 15:31:06.078 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 306.3373ms
2022-02-17 15:31:06.963 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/Api/GetApplicationUser - -
2022-02-17 15:31:06.965 -08:00 [INF] HTTP GET /Api/GetApplicationUser responded 404 in 1.8781 ms
2022-02-17 15:31:06.966 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/Api/GetApplicationUser - - - 404 0 - 3.4814ms
2022-02-17 15:31:08.120 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 15:31:08.191 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 15:31:08.194 -08:00 [INF] Removing 0 grants
2022-02-17 15:31:08.245 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 15:31:08.247 -08:00 [INF] Removing 0 device flow codes
2022-02-17 15:31:24.528 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 15:31:24.538 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 15:31:24.540 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:31:24.586 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:31:24.589 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 56.2807 ms
2022-02-17 15:31:24.590 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 61.5352ms
2022-02-17 15:31:24.638 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 15:31:24.640 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 15:31:24.641 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 2.0214 ms
2022-02-17 15:31:24.642 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 3.7804ms
2022-02-17 15:31:24.699 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 15:31:24.705 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 15:31:24.708 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:31:24.754 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:31:24.757 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIDM0JSKSS:00000002","TimeStamp":"2022-02-17T23:31:24.0000000Z","ProcessId":27860,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 15:31:24.808 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:31:24.855 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 15:31:24.903 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:31:24.952 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 15:31:24.956 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 15:31:24.957 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIDM0JSKSS:00000002","TimeStamp":"2022-02-17T23:31:24.0000000Z","ProcessId":27860,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 15:31:25.011 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 15:31:25.014 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 15:31:25.068 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 15:31:25.115 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 15:31:25.160 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 15:31:25.209 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 15:31:25.216 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****GyzQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIDM0JSKSS:00000002","TimeStamp":"2022-02-17T23:31:25.0000000Z","ProcessId":27860,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 15:31:25.232 -08:00 [INF] HTTP POST /connect/token responded 200 in 533.0160 ms
2022-02-17 15:31:25.234 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 535.1920ms
2022-02-17 15:31:25.243 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 15:31:25.245 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 15:31:25.248 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:31:25.298 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:31:25.349 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 15:31:25.399 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 15:31:25.445 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 15:31:25.493 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 15:31:25.541 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 15:31:25.548 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 15:31:25.549 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 305.5782 ms
2022-02-17 15:31:25.550 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 307.2140ms
2022-02-17 15:31:32.850 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/Api/GetApplicationUser - -
2022-02-17 15:31:32.852 -08:00 [INF] HTTP GET /Api/GetApplicationUser responded 404 in 0.8336 ms
2022-02-17 15:31:32.853 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/Api/GetApplicationUser - - - 404 0 - 2.5380ms
2022-02-17 15:31:38.271 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 15:31:38.318 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 15:31:38.320 -08:00 [INF] Removing 0 grants
2022-02-17 15:31:38.366 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 15:31:38.370 -08:00 [INF] Removing 0 device flow codes
2022-02-17 15:32:05.911 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 15:32:05.912 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 15:32:05.913 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:32:05.960 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:32:05.962 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 50.5672 ms
2022-02-17 15:32:05.963 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 52.4059ms
2022-02-17 15:32:06.007 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 15:32:06.008 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 15:32:06.009 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 1.2832 ms
2022-02-17 15:32:06.010 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 2.7673ms
2022-02-17 15:32:06.076 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 15:32:06.077 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 15:32:06.079 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:32:06.126 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:32:06.128 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIDM0JSKSV:00000002","TimeStamp":"2022-02-17T23:32:06.0000000Z","ProcessId":27860,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 15:32:06.179 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:32:06.231 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 15:32:06.277 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:32:06.328 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 15:32:06.340 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 15:32:06.341 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIDM0JSKSV:00000002","TimeStamp":"2022-02-17T23:32:06.0000000Z","ProcessId":27860,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 15:32:06.401 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 15:32:06.408 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 15:32:06.467 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 15:32:06.517 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 15:32:06.563 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 15:32:06.611 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 15:32:06.615 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****0kOQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIDM0JSKSV:00000002","TimeStamp":"2022-02-17T23:32:06.0000000Z","ProcessId":27860,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 15:32:06.629 -08:00 [INF] HTTP POST /connect/token responded 200 in 552.5265 ms
2022-02-17 15:32:06.630 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 554.6023ms
2022-02-17 15:32:06.638 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 15:32:06.639 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 15:32:06.641 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 15:32:06.688 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 15:32:06.737 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 15:32:06.785 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 15:32:06.835 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 15:32:06.885 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 15:32:06.932 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 15:32:06.936 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 15:32:06.937 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 298.0735 ms
2022-02-17 15:32:06.938 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 299.9783ms
2022-02-17 15:32:08.376 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 15:32:08.422 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 15:32:08.424 -08:00 [INF] Removing 0 grants
2022-02-17 15:32:08.469 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 15:32:08.471 -08:00 [INF] Removing 0 device flow codes
2022-02-17 15:32:09.689 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/Api/GetApplicationUser - -
2022-02-17 15:32:09.690 -08:00 [INF] HTTP GET /Api/GetApplicationUser responded 404 in 0.2455 ms
2022-02-17 15:32:09.691 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/Api/GetApplicationUser - - - 404 0 - 2.0677ms
2022-02-17 15:32:38.484 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 15:32:38.535 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 15:32:38.538 -08:00 [INF] Removing 0 grants
2022-02-17 15:32:38.584 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 15:32:38.595 -08:00 [INF] Removing 0 device flow codes
2022-02-17 15:33:08.604 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 15:33:08.651 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 15:33:08.653 -08:00 [INF] Removing 0 grants
2022-02-17 15:33:08.698 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 15:33:08.712 -08:00 [INF] Removing 0 device flow codes
2022-02-17 15:33:38.704 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 15:33:38.763 -08:00 [INF] Executed DbCommand (50ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 15:33:38.765 -08:00 [INF] Removing 0 grants
2022-02-17 15:33:38.810 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 15:33:38.812 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:14:53.243 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:14:54.245 -08:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:14:54.307 -08:00 [INF] Executed DbCommand (52ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:14:54.354 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:14:54.401 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:14:54.452 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:14:54.467 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:14:54.679 -08:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2022-02-17 16:14:54.729 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:14:55.017 -08:00 [INF] Executed DbCommand (50ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:14:55.067 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:14:55.112 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:14:55.160 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:14:55.208 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:14:55.211 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:14:55.395 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[Name] = N'Administrator'
2022-02-17 16:14:55.420 -08:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2022-02-17 16:14:55.437 -08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2022-02-17 16:14:55.571 -08:00 [INF] User profile is available. Using 'C:\Users\u0490822\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2022-02-17 16:14:56.110 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:14:56.144 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:14:56.160 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:14:56.314 -08:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:14:56.405 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 287.5809 ms
2022-02-17 16:14:56.412 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 303.3818ms
2022-02-17 16:14:56.482 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:14:56.491 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:14:56.520 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 36.6974 ms
2022-02-17 16:14:56.528 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 45.6507ms
2022-02-17 16:14:56.612 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:14:56.635 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:14:56.684 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:14:56.736 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:14:56.758 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIEEOLHMUK:00000002","TimeStamp":"2022-02-18T00:14:56.0000000Z","ProcessId":33240,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:14:56.878 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:14:56.966 -08:00 [INF] Executed DbCommand (59ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:14:57.016 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:14:57.083 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:14:57.137 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:14:57.150 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIEEOLHMUK:00000002","TimeStamp":"2022-02-18T00:14:57.0000000Z","ProcessId":33240,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:14:57.218 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:14:57.225 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:14:57.304 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:14:57.369 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:14:57.420 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:14:57.472 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:14:57.575 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****9Gww","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIEEOLHMUK:00000002","TimeStamp":"2022-02-18T00:14:57.0000000Z","ProcessId":33240,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:14:57.588 -08:00 [INF] HTTP POST /connect/token responded 200 in 974.4858 ms
2022-02-17 16:14:57.589 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 976.5597ms
2022-02-17 16:14:57.598 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:14:57.599 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:14:57.642 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:14:57.691 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:14:57.747 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:14:57.802 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:14:57.850 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:14:57.896 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:14:57.943 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:14:57.946 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:14:57.947 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 348.9679 ms
2022-02-17 16:14:57.948 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 350.5440ms
2022-02-17 16:14:57.955 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/Api/GetApplicationUser - -
2022-02-17 16:14:57.980 -08:00 [INF] HTTP GET /Api/GetApplicationUser responded 404 in 24.8172 ms
2022-02-17 16:14:57.982 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/Api/GetApplicationUser - - - 404 0 - 26.4488ms
2022-02-17 16:15:25.616 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:15:25.677 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:15:25.685 -08:00 [INF] Removing 0 grants
2022-02-17 16:15:25.735 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:15:25.738 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:15:31.977 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:15:32.534 -08:00 [INF] Executed DbCommand (57ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:15:32.595 -08:00 [INF] Executed DbCommand (52ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:15:32.642 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:15:32.688 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:15:32.737 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:15:32.752 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:15:32.954 -08:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2022-02-17 16:15:33.001 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:15:33.273 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:15:33.317 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:15:33.363 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:15:33.407 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:15:33.453 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:15:33.455 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:15:33.641 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[Name] = N'Administrator'
2022-02-17 16:15:33.666 -08:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2022-02-17 16:15:33.673 -08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2022-02-17 16:15:33.769 -08:00 [INF] User profile is available. Using 'C:\Users\u0490822\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2022-02-17 16:15:37.001 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:15:37.026 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:15:37.039 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:15:37.166 -08:00 [INF] Executed DbCommand (52ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:15:37.238 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 231.5961 ms
2022-02-17 16:15:37.242 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 242.5997ms
2022-02-17 16:15:37.292 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:15:37.294 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:15:37.319 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 25.9175 ms
2022-02-17 16:15:37.330 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 37.7262ms
2022-02-17 16:15:37.401 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:15:37.417 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:15:37.460 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:15:37.512 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:15:37.529 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIEF4RQEOD:00000002","TimeStamp":"2022-02-18T00:15:37.0000000Z","ProcessId":15520,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:15:37.632 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:15:37.714 -08:00 [INF] Executed DbCommand (56ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:15:37.768 -08:00 [INF] Executed DbCommand (51ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:15:37.830 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:15:37.879 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:15:37.896 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIEF4RQEOD:00000002","TimeStamp":"2022-02-18T00:15:37.0000000Z","ProcessId":15520,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:15:37.962 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:15:37.970 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:15:38.050 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:15:38.112 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:15:38.164 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:15:38.214 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:15:38.311 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****bTfQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIEF4RQEOD:00000002","TimeStamp":"2022-02-18T00:15:38.0000000Z","ProcessId":15520,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:15:38.326 -08:00 [INF] HTTP POST /connect/token responded 200 in 924.2855 ms
2022-02-17 16:15:38.328 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 926.3154ms
2022-02-17 16:15:38.336 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:15:38.337 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:15:38.380 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:15:38.426 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:15:38.482 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:15:38.535 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:15:38.582 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:15:38.631 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:15:38.678 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:15:38.681 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:15:38.682 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 346.2593 ms
2022-02-17 16:15:38.683 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 347.6432ms
2022-02-17 16:15:38.690 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/GetApplicationUser - -
2022-02-17 16:15:38.714 -08:00 [INF] HTTP GET /api/permissions/GetApplicationUser responded 404 in 24.0253 ms
2022-02-17 16:15:38.716 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/GetApplicationUser - - - 404 0 - 25.8539ms
2022-02-17 16:15:43.734 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:15:43.736 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:15:43.739 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:15:43.786 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:15:43.788 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 53.0576 ms
2022-02-17 16:15:43.790 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 55.6461ms
2022-02-17 16:15:43.834 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:15:43.835 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:15:43.836 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 1.5466 ms
2022-02-17 16:15:43.837 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 3.5004ms
2022-02-17 16:15:43.896 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:15:43.897 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:15:43.900 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:15:43.950 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:15:43.953 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIEF4RQEOG:00000002","TimeStamp":"2022-02-18T00:15:43.0000000Z","ProcessId":15520,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:15:44.008 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:15:44.055 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:15:44.101 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:15:44.150 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:15:44.156 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:15:44.157 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIEF4RQEOG:00000002","TimeStamp":"2022-02-18T00:15:44.0000000Z","ProcessId":15520,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:15:44.213 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:15:44.218 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:15:44.273 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:15:44.320 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:15:44.369 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:15:44.415 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:15:44.418 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****_Ayw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIEF4RQEOG:00000002","TimeStamp":"2022-02-18T00:15:44.0000000Z","ProcessId":15520,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:15:44.430 -08:00 [INF] HTTP POST /connect/token responded 200 in 533.5734 ms
2022-02-17 16:15:44.431 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 535.3618ms
2022-02-17 16:15:44.439 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:15:44.442 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:15:44.443 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:15:44.489 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:15:44.537 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:15:44.585 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:15:44.633 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:15:44.679 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:15:44.728 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:15:44.733 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:15:44.734 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 292.9233 ms
2022-02-17 16:15:44.739 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 299.1013ms
2022-02-17 16:15:44.747 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/GetApplicationUser - -
2022-02-17 16:15:44.750 -08:00 [INF] HTTP GET /api/permissions/GetApplicationUser responded 404 in 2.2565 ms
2022-02-17 16:15:44.754 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/GetApplicationUser - - - 404 0 - 6.8294ms
2022-02-17 16:16:03.800 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:16:03.855 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:16:03.858 -08:00 [INF] Removing 0 grants
2022-02-17 16:16:03.909 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:16:03.912 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:16:33.939 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:16:33.986 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:16:33.989 -08:00 [INF] Removing 0 grants
2022-02-17 16:16:34.035 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:16:34.043 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:17:04.051 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:17:04.108 -08:00 [INF] Executed DbCommand (50ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:17:04.110 -08:00 [INF] Removing 0 grants
2022-02-17 16:17:04.156 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:17:04.166 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:17:34.173 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:17:34.227 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:17:34.229 -08:00 [INF] Removing 0 grants
2022-02-17 16:17:34.275 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:17:34.288 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:18:04.284 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:18:04.335 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:18:04.338 -08:00 [INF] Removing 0 grants
2022-02-17 16:18:04.383 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:18:04.396 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:18:34.395 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:18:34.442 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:18:34.449 -08:00 [INF] Removing 0 grants
2022-02-17 16:18:34.496 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:18:34.503 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:19:04.504 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:19:04.555 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:19:04.564 -08:00 [INF] Removing 0 grants
2022-02-17 16:19:04.609 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:19:04.611 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:19:34.607 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:19:34.659 -08:00 [INF] Executed DbCommand (49ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:19:34.666 -08:00 [INF] Removing 0 grants
2022-02-17 16:19:34.713 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:19:34.732 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:20:48.462 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:20:49.039 -08:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:20:49.102 -08:00 [INF] Executed DbCommand (53ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:20:49.149 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:20:49.197 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:20:49.251 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:20:49.266 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:20:49.474 -08:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2022-02-17 16:20:49.524 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:20:49.801 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:20:49.849 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:20:49.895 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:20:49.944 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:20:49.991 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:20:49.993 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:20:50.173 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[Name] = N'Administrator'
2022-02-17 16:20:50.195 -08:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2022-02-17 16:20:50.202 -08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2022-02-17 16:20:50.299 -08:00 [INF] User profile is available. Using 'C:\Users\u0490822\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2022-02-17 16:20:53.925 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:20:53.951 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:20:53.961 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:20:54.088 -08:00 [INF] Executed DbCommand (51ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:20:54.158 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 227.5137 ms
2022-02-17 16:20:54.167 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 243.0657ms
2022-02-17 16:20:54.213 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:20:54.216 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:20:54.245 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 30.8616 ms
2022-02-17 16:20:54.255 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 41.5082ms
2022-02-17 16:20:54.320 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:20:54.335 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:20:54.375 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:20:54.424 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:20:54.443 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIEI3A566G:00000002","TimeStamp":"2022-02-18T00:20:54.0000000Z","ProcessId":10732,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:20:54.548 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:20:54.627 -08:00 [INF] Executed DbCommand (54ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:20:54.676 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:20:54.738 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:20:54.784 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:20:54.795 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIEI3A566G:00000002","TimeStamp":"2022-02-18T00:20:54.0000000Z","ProcessId":10732,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:20:54.862 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:20:54.867 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:20:54.945 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:20:55.011 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:20:55.065 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:20:55.117 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:20:55.212 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****S7FQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIEI3A566G:00000002","TimeStamp":"2022-02-18T00:20:55.0000000Z","ProcessId":10732,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:20:55.224 -08:00 [INF] HTTP POST /connect/token responded 200 in 903.6322 ms
2022-02-17 16:20:55.225 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 905.3425ms
2022-02-17 16:20:55.233 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:20:55.234 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:20:55.277 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:20:55.324 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:20:55.380 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:20:55.436 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:20:55.484 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:20:55.532 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:20:55.579 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:20:55.582 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:20:55.583 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 349.4620 ms
2022-02-17 16:20:55.584 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 350.8757ms
2022-02-17 16:20:55.591 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/GetApplicationUser - -
2022-02-17 16:20:55.614 -08:00 [INF] HTTP GET /api/permissions/GetApplicationUser responded 404 in 22.6149 ms
2022-02-17 16:20:55.616 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/GetApplicationUser - - - 404 0 - 24.4563ms
2022-02-17 16:21:20.350 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:21:20.408 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:21:20.410 -08:00 [INF] Removing 0 grants
2022-02-17 16:21:20.460 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:21:20.463 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:21:50.511 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:21:50.558 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:21:50.562 -08:00 [INF] Removing 0 grants
2022-02-17 16:21:50.611 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:21:50.617 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:22:20.622 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:22:20.678 -08:00 [INF] Executed DbCommand (52ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:22:20.680 -08:00 [INF] Removing 0 grants
2022-02-17 16:22:20.726 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:22:20.733 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:22:49.617 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:22:50.189 -08:00 [INF] Executed DbCommand (57ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:22:50.254 -08:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:22:50.302 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:22:50.351 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:22:50.404 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:22:50.419 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:22:50.613 -08:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2022-02-17 16:22:50.661 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:22:50.950 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:22:50.996 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:22:51.044 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:22:51.089 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:22:51.137 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:22:51.141 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:22:51.323 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[Name] = N'Administrator'
2022-02-17 16:22:51.346 -08:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2022-02-17 16:22:51.353 -08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2022-02-17 16:22:51.443 -08:00 [INF] User profile is available. Using 'C:\Users\u0490822\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2022-02-17 16:22:52.171 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:22:52.207 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:22:52.218 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:22:52.367 -08:00 [INF] Executed DbCommand (54ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:22:52.453 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 274.9679 ms
2022-02-17 16:22:52.457 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 288.5659ms
2022-02-17 16:22:52.514 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:22:52.516 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:22:52.553 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 39.0453 ms
2022-02-17 16:22:52.566 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 52.7885ms
2022-02-17 16:22:52.676 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:22:52.693 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:22:52.745 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:22:52.797 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:22:52.825 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIEJ6HPU1L:00000002","TimeStamp":"2022-02-18T00:22:52.0000000Z","ProcessId":21828,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:22:52.947 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:22:53.050 -08:00 [INF] Executed DbCommand (60ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:22:53.113 -08:00 [INF] Executed DbCommand (58ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:22:53.183 -08:00 [INF] Executed DbCommand (49ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:22:53.243 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:22:53.260 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIEJ6HPU1L:00000002","TimeStamp":"2022-02-18T00:22:53.0000000Z","ProcessId":21828,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:22:53.336 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:22:53.344 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:22:53.448 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:22:53.508 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:22:53.561 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:22:53.612 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:22:53.718 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****k-bQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIEJ6HPU1L:00000002","TimeStamp":"2022-02-18T00:22:53.0000000Z","ProcessId":21828,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:22:53.733 -08:00 [INF] HTTP POST /connect/token responded 200 in 1056.2495 ms
2022-02-17 16:22:53.734 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 1058.2704ms
2022-02-17 16:22:53.743 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:22:53.744 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:22:53.787 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:22:53.835 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:22:53.890 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:22:53.943 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:22:53.995 -08:00 [INF] Executed DbCommand (49ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:22:54.044 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:22:54.091 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:22:54.094 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:22:54.095 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 351.7346 ms
2022-02-17 16:22:54.096 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 353.3535ms
2022-02-17 16:22:54.103 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/GetApplicationUser - -
2022-02-17 16:22:54.125 -08:00 [INF] HTTP GET /api/permissions/GetApplicationUser responded 404 in 21.4194 ms
2022-02-17 16:22:54.126 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/GetApplicationUser - - - 404 0 - 23.1414ms
2022-02-17 16:22:59.184 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:22:59.186 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:22:59.187 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:22:59.233 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:22:59.235 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 50.2082 ms
2022-02-17 16:22:59.236 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 52.1391ms
2022-02-17 16:22:59.279 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:22:59.280 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:22:59.282 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 1.5145 ms
2022-02-17 16:22:59.282 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 3.2198ms
2022-02-17 16:22:59.339 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:22:59.340 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:22:59.343 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:22:59.392 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:22:59.397 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIEJ6HPU1O:00000002","TimeStamp":"2022-02-18T00:22:59.0000000Z","ProcessId":21828,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:22:59.447 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:22:59.496 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:22:59.543 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:22:59.590 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:22:59.596 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:22:59.596 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIEJ6HPU1O:00000002","TimeStamp":"2022-02-18T00:22:59.0000000Z","ProcessId":21828,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:22:59.655 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:22:59.661 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:22:59.719 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:22:59.768 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:22:59.817 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:22:59.865 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:22:59.869 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****4JEQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIEJ6HPU1O:00000002","TimeStamp":"2022-02-18T00:22:59.0000000Z","ProcessId":21828,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:22:59.879 -08:00 [INF] HTTP POST /connect/token responded 200 in 539.0068 ms
2022-02-17 16:22:59.880 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 540.9251ms
2022-02-17 16:22:59.889 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:22:59.890 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:22:59.892 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:22:59.945 -08:00 [INF] Executed DbCommand (51ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:22:59.993 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:23:00.045 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:23:00.098 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:23:00.146 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:23:00.192 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:23:00.194 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:23:00.195 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 305.3780 ms
2022-02-17 16:23:00.196 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 307.0077ms
2022-02-17 16:23:00.204 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/GetApplicationUser - -
2022-02-17 16:23:00.208 -08:00 [INF] HTTP GET /api/permissions/GetApplicationUser responded 404 in 2.7568 ms
2022-02-17 16:23:00.209 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/GetApplicationUser - - - 404 0 - 5.2348ms
2022-02-17 16:23:21.477 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:23:21.538 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:23:21.541 -08:00 [INF] Removing 0 grants
2022-02-17 16:23:21.590 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:23:21.593 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:23:51.618 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:23:51.664 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:23:51.666 -08:00 [INF] Removing 0 grants
2022-02-17 16:23:51.713 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:23:51.720 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:24:21.732 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:24:21.797 -08:00 [INF] Executed DbCommand (63ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:24:21.799 -08:00 [INF] Removing 0 grants
2022-02-17 16:24:21.850 -08:00 [INF] Executed DbCommand (51ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:24:21.860 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:24:51.874 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:24:51.928 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:24:51.930 -08:00 [INF] Removing 0 grants
2022-02-17 16:24:51.975 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:24:51.979 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:25:03.897 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:25:04.492 -08:00 [INF] Executed DbCommand (54ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:25:04.555 -08:00 [INF] Executed DbCommand (52ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:25:04.603 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:25:04.649 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:25:04.705 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:25:04.720 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:25:04.935 -08:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2022-02-17 16:25:04.987 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:25:05.279 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:25:05.325 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:25:05.370 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:25:05.417 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:25:05.466 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:25:05.469 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:25:05.657 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[Name] = N'Administrator'
2022-02-17 16:25:05.680 -08:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2022-02-17 16:25:05.688 -08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2022-02-17 16:25:05.800 -08:00 [INF] User profile is available. Using 'C:\Users\u0490822\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2022-02-17 16:25:17.555 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:25:17.580 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:25:17.590 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:25:17.727 -08:00 [INF] Executed DbCommand (51ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:25:17.806 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 245.6468 ms
2022-02-17 16:25:17.810 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 256.7753ms
2022-02-17 16:25:17.855 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:25:17.858 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:25:17.884 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 28.1565 ms
2022-02-17 16:25:17.890 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 35.3366ms
2022-02-17 16:25:17.963 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:25:17.979 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:25:18.017 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:25:18.070 -08:00 [INF] Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:25:18.087 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIEKHSCLTF:00000002","TimeStamp":"2022-02-18T00:25:18.0000000Z","ProcessId":23056,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:25:18.193 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:25:18.271 -08:00 [INF] Executed DbCommand (54ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:25:18.321 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:25:18.386 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:25:18.433 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:25:18.445 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIEKHSCLTF:00000002","TimeStamp":"2022-02-18T00:25:18.0000000Z","ProcessId":23056,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:25:18.510 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:25:18.518 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:25:18.600 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:25:18.666 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:25:18.728 -08:00 [INF] Executed DbCommand (53ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:25:18.779 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:25:18.878 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****Rnkg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIEKHSCLTF:00000002","TimeStamp":"2022-02-18T00:25:18.0000000Z","ProcessId":23056,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:25:18.893 -08:00 [INF] HTTP POST /connect/token responded 200 in 929.6103 ms
2022-02-17 16:25:18.894 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 931.5137ms
2022-02-17 16:25:18.902 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:25:18.903 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:25:18.945 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:25:18.993 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:25:19.053 -08:00 [INF] Executed DbCommand (49ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:25:19.106 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:25:19.154 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:25:19.201 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:25:19.253 -08:00 [INF] Executed DbCommand (50ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:25:19.257 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:25:19.259 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 356.7324 ms
2022-02-17 16:25:19.260 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 358.3848ms
2022-02-17 16:25:19.266 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/GetApplicationUser - -
2022-02-17 16:25:19.290 -08:00 [INF] HTTP GET /api/permissions/GetApplicationUser responded 404 in 23.3296 ms
2022-02-17 16:25:19.292 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/GetApplicationUser - - - 404 0 - 25.7174ms
2022-02-17 16:25:35.835 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:25:35.895 -08:00 [INF] Executed DbCommand (49ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:25:35.903 -08:00 [INF] Removing 0 grants
2022-02-17 16:25:35.953 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:25:35.957 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:29:17.913 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:29:18.516 -08:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:29:18.581 -08:00 [INF] Executed DbCommand (56ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:29:18.633 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:29:18.678 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:29:18.734 -08:00 [INF] Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:29:18.749 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:29:18.957 -08:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2022-02-17 16:29:19.003 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:29:19.292 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:29:19.340 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:29:19.390 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:29:19.436 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:29:19.484 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:29:19.487 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:29:19.671 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[Name] = N'Administrator'
2022-02-17 16:29:19.694 -08:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2022-02-17 16:29:19.701 -08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2022-02-17 16:29:19.800 -08:00 [INF] User profile is available. Using 'C:\Users\u0490822\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2022-02-17 16:29:25.765 -08:00 [INF] Request starting HTTP/2 GET https://localhost:5001/ - -
2022-02-17 16:29:25.807 -08:00 [INF] Executing endpoint 'IdentityServer.Controllers.HomeController.Index (IdentityServer)'
2022-02-17 16:29:25.817 -08:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Index() on controller IdentityServer.Controllers.HomeController (IdentityServer).
2022-02-17 16:29:25.870 -08:00 [INF] Executing action method IdentityServer.Controllers.HomeController.Index (IdentityServer) - Validation state: "Valid"
2022-02-17 16:29:25.874 -08:00 [INF] Executed action method IdentityServer.Controllers.HomeController.Index (IdentityServer), returned result Microsoft.AspNetCore.Mvc.ViewResult in 0.5589ms.
2022-02-17 16:29:25.887 -08:00 [INF] Executing ViewResult, running view Index.
2022-02-17 16:29:25.978 -08:00 [INF] Executed ViewResult - view Index executed in 91.7392ms.
2022-02-17 16:29:25.980 -08:00 [INF] Executed action IdentityServer.Controllers.HomeController.Index (IdentityServer) in 160.8826ms
2022-02-17 16:29:25.982 -08:00 [INF] Executed endpoint 'IdentityServer.Controllers.HomeController.Index (IdentityServer)'
2022-02-17 16:29:25.984 -08:00 [INF] HTTP GET / responded 200 in 213.2862 ms
2022-02-17 16:29:25.988 -08:00 [INF] Request finished HTTP/2 GET https://localhost:5001/ - - - 200 - text/html;+charset=utf-8 224.1441ms
2022-02-17 16:29:25.997 -08:00 [INF] Request starting HTTP/2 GET https://localhost:5001/lib/jquery/dist/jquery.js - -
2022-02-17 16:29:25.997 -08:00 [INF] Request starting HTTP/2 GET https://localhost:5001/images/NetworkBanner.png - -
2022-02-17 16:29:25.998 -08:00 [INF] Request starting HTTP/2 GET https://localhost:5001/images/VikingBanner1.jpg - -
2022-02-17 16:29:25.997 -08:00 [INF] Request starting HTTP/2 GET https://localhost:5001/lib/bootstrap/dist/js/bootstrap.js - -
2022-02-17 16:29:25.997 -08:00 [INF] Request starting HTTP/2 GET https://localhost:5001/js/site.js?v=ji3-IxbEzYWjzzLCGkF1KDjrT2jLbbrSYXw-AhMPNIA - -
2022-02-17 16:29:26.001 -08:00 [INF] The file /lib/jquery/dist/jquery.js was not modified
2022-02-17 16:29:26.001 -08:00 [INF] The file /lib/bootstrap/dist/js/bootstrap.js was not modified
2022-02-17 16:29:26.001 -08:00 [INF] The file /images/NetworkBanner.png was not modified
2022-02-17 16:29:26.001 -08:00 [INF] The file /js/site.js was not modified
2022-02-17 16:29:26.001 -08:00 [INF] The file /images/VikingBanner1.jpg was not modified
2022-02-17 16:29:26.002 -08:00 [INF] HTTP GET /lib/jquery/dist/jquery.js responded 304 in 4.0695 ms
2022-02-17 16:29:26.003 -08:00 [INF] HTTP GET /lib/bootstrap/dist/js/bootstrap.js responded 304 in 2.7692 ms
2022-02-17 16:29:26.003 -08:00 [INF] HTTP GET /images/NetworkBanner.png responded 304 in 4.5162 ms
2022-02-17 16:29:26.004 -08:00 [INF] HTTP GET /js/site.js?v=ji3-IxbEzYWjzzLCGkF1KDjrT2jLbbrSYXw-AhMPNIA responded 304 in 3.2287 ms
2022-02-17 16:29:26.004 -08:00 [INF] HTTP GET /images/VikingBanner1.jpg responded 304 in 5.2299 ms
2022-02-17 16:29:26.006 -08:00 [INF] Request finished HTTP/2 GET https://localhost:5001/lib/jquery/dist/jquery.js - - - 304 - application/javascript 8.1894ms
2022-02-17 16:29:26.008 -08:00 [INF] Request finished HTTP/2 GET https://localhost:5001/lib/bootstrap/dist/js/bootstrap.js - - - 304 - application/javascript 10.3328ms
2022-02-17 16:29:26.009 -08:00 [INF] Request finished HTTP/2 GET https://localhost:5001/images/NetworkBanner.png - - - 304 - image/png 11.6398ms
2022-02-17 16:29:26.010 -08:00 [INF] Request finished HTTP/2 GET https://localhost:5001/js/site.js?v=ji3-IxbEzYWjzzLCGkF1KDjrT2jLbbrSYXw-AhMPNIA - - - 304 - application/javascript 13.0998ms
2022-02-17 16:29:26.013 -08:00 [INF] Request finished HTTP/2 GET https://localhost:5001/images/VikingBanner1.jpg - - - 304 - image/jpeg 15.0773ms
2022-02-17 16:29:49.838 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:29:49.923 -08:00 [INF] Executed DbCommand (59ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:29:49.931 -08:00 [INF] Removing 0 grants
2022-02-17 16:29:49.986 -08:00 [INF] Executed DbCommand (50ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:29:49.990 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:29:51.542 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:29:51.548 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:29:51.558 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:29:51.677 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:29:51.736 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 193.3037 ms
2022-02-17 16:29:51.739 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 197.8553ms
2022-02-17 16:29:51.783 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:29:51.787 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:29:51.811 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 27.0154 ms
2022-02-17 16:29:51.813 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 30.2037ms
2022-02-17 16:29:51.877 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:29:51.888 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:29:51.923 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:29:51.972 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:29:51.989 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIEMRRGUBJ:00000002","TimeStamp":"2022-02-18T00:29:51.0000000Z","ProcessId":23848,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:29:52.095 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:29:52.166 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:29:52.215 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:29:52.280 -08:00 [INF] Executed DbCommand (50ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:29:52.332 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:29:52.344 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIEMRRGUBJ:00000002","TimeStamp":"2022-02-18T00:29:52.0000000Z","ProcessId":23848,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:29:52.411 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:29:52.417 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:29:52.493 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:29:52.554 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:29:52.606 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:29:52.662 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:29:52.775 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****5x4g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIEMRRGUBJ:00000002","TimeStamp":"2022-02-18T00:29:52.0000000Z","ProcessId":23848,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:29:52.786 -08:00 [INF] HTTP POST /connect/token responded 200 in 909.0796 ms
2022-02-17 16:29:52.787 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 910.8436ms
2022-02-17 16:29:52.795 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:29:52.797 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:29:52.841 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:29:52.887 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:29:52.943 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:29:52.997 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:29:53.049 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:29:53.097 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:29:53.144 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:29:53.146 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:29:53.148 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 352.3369 ms
2022-02-17 16:29:53.149 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 353.9311ms
2022-02-17 16:29:53.157 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/GetApplicationUser - -
2022-02-17 16:29:53.159 -08:00 [INF] HTTP GET /api/permissions/GetApplicationUser responded 404 in 1.5272 ms
2022-02-17 16:29:53.160 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/GetApplicationUser - - - 404 0 - 2.9058ms
2022-02-17 16:30:06.539 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:30:06.540 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:30:06.541 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:30:06.588 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:30:06.596 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 56.6088 ms
2022-02-17 16:30:06.597 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 58.4984ms
2022-02-17 16:30:06.642 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:30:06.644 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:30:06.645 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 2.1264 ms
2022-02-17 16:30:06.646 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 4.2046ms
2022-02-17 16:30:06.703 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:30:06.704 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:30:06.706 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:30:06.753 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:30:06.756 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIEMRRGUBM:00000002","TimeStamp":"2022-02-18T00:30:06.0000000Z","ProcessId":23848,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:30:06.806 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:30:06.853 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:30:06.900 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:30:06.949 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:30:06.953 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:30:06.954 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIEMRRGUBM:00000002","TimeStamp":"2022-02-18T00:30:06.0000000Z","ProcessId":23848,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:30:07.008 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:30:07.014 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:30:07.074 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:30:07.121 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:30:07.169 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:30:07.216 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:30:07.221 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****6stQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIEMRRGUBM:00000002","TimeStamp":"2022-02-18T00:30:07.0000000Z","ProcessId":23848,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:30:07.229 -08:00 [INF] HTTP POST /connect/token responded 200 in 525.9161 ms
2022-02-17 16:30:07.231 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 527.6746ms
2022-02-17 16:30:07.240 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:30:07.241 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:30:07.242 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:30:07.291 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:30:07.339 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:30:07.386 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:30:07.434 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:30:07.483 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:30:07.532 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:30:07.536 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:30:07.538 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 297.4630 ms
2022-02-17 16:30:07.540 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 300.5845ms
2022-02-17 16:30:07.548 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/ - -
2022-02-17 16:30:07.726 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:30:07.732 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:30:07.734 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:30:07.779 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:30:07.782 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 55.5733 ms
2022-02-17 16:30:07.784 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 57.3677ms
2022-02-17 16:30:07.862 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:30:07.864 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:30:07.865 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 2.5349 ms
2022-02-17 16:30:07.876 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 13.8889ms
2022-02-17 16:30:07.891 -08:00 [INF] Successfully validated the token.
2022-02-17 16:30:07.908 -08:00 [INF] Start processing HTTP request GET "https://localhost:5001/.well-known/openid-configuration"
2022-02-17 16:30:07.910 -08:00 [INF] Sending HTTP request GET "https://localhost:5001/.well-known/openid-configuration"
2022-02-17 16:30:07.928 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:30:07.929 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:30:07.930 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:30:07.979 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:30:07.983 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 53.7296 ms
2022-02-17 16:30:07.994 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 66.0352ms
2022-02-17 16:30:07.997 -08:00 [INF] Received HTTP response headers after 84.8129ms - 200
2022-02-17 16:30:07.998 -08:00 [INF] End processing HTTP request after 92.104ms - 200
2022-02-17 16:30:08.005 -08:00 [INF] Start processing HTTP request GET "https://localhost:5001/.well-known/openid-configuration/jwks"
2022-02-17 16:30:08.006 -08:00 [INF] Sending HTTP request GET "https://localhost:5001/.well-known/openid-configuration/jwks"
2022-02-17 16:30:08.029 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:30:08.030 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:30:08.031 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 1.4420 ms
2022-02-17 16:30:08.040 -08:00 [INF] Received HTTP response headers after 34.2146ms - 200
2022-02-17 16:30:08.040 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 11.6331ms
2022-02-17 16:30:08.041 -08:00 [INF] End processing HTTP request after 36.175ms - 200
2022-02-17 16:30:08.052 -08:00 [INF] Start processing HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:30:08.052 -08:00 [INF] Sending HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:30:08.077 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161
2022-02-17 16:30:08.078 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2022-02-17 16:30:08.084 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:30:08.140 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:30:08.143 -08:00 [INF] {"ApiName":"mvc","Category":"Authentication","Name":"API Authentication Failure","EventType":"Failure","Id":1021,"Message":"Unknown API resource","ActivityId":"0HMFIEMRRGUBP:00000004","TimeStamp":"2022-02-18T00:30:08.0000000Z","ProcessId":23848,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ApiAuthenticationFailureEvent"}
2022-02-17 16:30:08.147 -08:00 [ERR] No API resource with that name found. aborting
2022-02-17 16:30:08.148 -08:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2022-02-17 16:30:08.149 -08:00 [INF] HTTP POST /connect/introspect responded 401 in 71.3855 ms
2022-02-17 16:30:08.150 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161 - 401 0 - 73.1197ms
2022-02-17 16:30:08.160 -08:00 [INF] Received HTTP response headers after 107.1235ms - 401
2022-02-17 16:30:08.160 -08:00 [INF] End processing HTTP request after 108.8301ms - 401
2022-02-17 16:30:08.164 -08:00 [ERR] Error returned from introspection endpoint: Unauthorized
2022-02-17 16:30:08.166 -08:00 [INF] Introspection was not authenticated. Failure message: Error returned from introspection endpoint: Unauthorized
2022-02-17 16:30:08.171 -08:00 [INF] Authorization was successful.
2022-02-17 16:30:08.172 -08:00 [INF] Executing endpoint 'IdentityServer.Controllers.PermissionsController.UserAccessibleVolumes (IdentityServer)'
2022-02-17 16:30:08.175 -08:00 [INF] Route matched with {action = "UserAccessibleVolumes", controller = "Permissions"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.Dictionary`2[System.Int64,System.Object]] UserAccessibleVolumes() on controller IdentityServer.Controllers.PermissionsController (IdentityServer).
2022-02-17 16:30:08.207 -08:00 [INF] Executing action method IdentityServer.Controllers.PermissionsController.UserAccessibleVolumes (IdentityServer) - Validation state: "Valid"
2022-02-17 16:30:08.211 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:30:08.265 -08:00 [INF] Executed DbCommand (50ms) [Parameters=[@__username_0='jamesan' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[UserName] = @__username_0
2022-02-17 16:30:08.335 -08:00 [INF] Executed DbCommand (53ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[GroupId], [u].[UserId], [t].[Id], [t].[Description], [t].[Name], [t].[ParentID], [t].[ResourceTypeId], [g].[ContainerGroupId], [g].[MemberGroupId]
FROM [UserToGroupAssignments] AS [u]
INNER JOIN (
    SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId]
    FROM [Resource] AS [r]
    WHERE [r].[ResourceTypeId] = N'Group'
) AS [t] ON [u].[GroupId] = [t].[Id]
LEFT JOIN [GroupToGroupAssignments] AS [g] ON [t].[Id] = [g].[MemberGroupId]
WHERE [u].[UserId] = @__userId_0
ORDER BY [u].[GroupId], [u].[UserId], [t].[Id], [g].[ContainerGroupId], [g].[MemberGroupId]
2022-02-17 16:30:08.407 -08:00 [INF] Executed DbCommand (51ms) [Parameters=[@__groupId_0='1'], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ContainerGroupId], [g].[MemberGroupId], [t].[Id], [t].[Description], [t].[Name], [t].[ParentID], [t].[ResourceTypeId], [g0].[ContainerGroupId], [g0].[MemberGroupId]
FROM [GroupToGroupAssignments] AS [g]
INNER JOIN (
    SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId]
    FROM [Resource] AS [r]
    WHERE [r].[ResourceTypeId] = N'Group'
) AS [t] ON [g].[ContainerGroupId] = [t].[Id]
LEFT JOIN [GroupToGroupAssignments] AS [g0] ON [t].[Id] = [g0].[MemberGroupId]
WHERE [g].[MemberGroupId] = @__groupId_0
ORDER BY [g].[ContainerGroupId], [g].[MemberGroupId], [t].[Id], [g0].[ContainerGroupId], [g0].[MemberGroupId]
2022-02-17 16:30:08.470 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ResourceId], [g].[PermissionId], [g].[GroupId], [g].[GranteeType], [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [GrantedGroupPermissions] AS [g]
INNER JOIN [Resource] AS [r] ON [g].[ResourceId] = [r].[Id]
2022-02-17 16:30:08.540 -08:00 [INF] Executed DbCommand (60ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ResourceId], [r].[Name], [g].[PermissionId], [r].[ResourceTypeId]
FROM [GrantedUserPermissions] AS [g]
INNER JOIN [Resource] AS [r] ON [g].[ResourceId] = [r].[Id]
WHERE [g].[UserId] = @__userId_0
2022-02-17 16:30:08.599 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[ResourceTypeId] = N'Volume'
2022-02-17 16:30:08.603 -08:00 [INF] Executed action method IdentityServer.Controllers.PermissionsController.UserAccessibleVolumes (IdentityServer), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 394.3807ms.
2022-02-17 16:30:08.607 -08:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.Dictionary`2[[System.Int64, System.Private.CoreLib, Version=5.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=5.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-02-17 16:30:08.616 -08:00 [INF] Executed action IdentityServer.Controllers.PermissionsController.UserAccessibleVolumes (IdentityServer) in 439.3703ms
2022-02-17 16:30:08.618 -08:00 [INF] Executed endpoint 'IdentityServer.Controllers.PermissionsController.UserAccessibleVolumes (IdentityServer)'
2022-02-17 16:30:08.619 -08:00 [INF] HTTP GET /api/permissions/ responded 200 in 1069.7361 ms
2022-02-17 16:30:08.619 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/ - - - 200 - application/json;+charset=utf-8 1071.1527ms
2022-02-17 16:30:20.014 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:30:20.064 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:30:20.068 -08:00 [INF] Removing 0 grants
2022-02-17 16:30:20.112 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:30:20.114 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:30:50.116 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:30:50.164 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:30:50.166 -08:00 [INF] Removing 0 grants
2022-02-17 16:30:50.211 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:30:50.214 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:31:20.228 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:31:20.274 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:31:20.276 -08:00 [INF] Removing 0 grants
2022-02-17 16:31:20.320 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:31:20.323 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:31:27.503 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/UserPermissions?id=RC1&resourceTypeId=RC1 - -
2022-02-17 16:31:27.505 -08:00 [INF] HTTP GET /api/permissions/UserPermissions?id=RC1&resourceTypeId=RC1 responded 404 in 0.5108 ms
2022-02-17 16:31:27.506 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/UserPermissions?id=RC1&resourceTypeId=RC1 - - - 404 0 - 3.3849ms
2022-02-17 16:31:29.700 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:31:29.701 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:31:29.702 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:31:29.748 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:31:29.751 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 50.6006 ms
2022-02-17 16:31:29.752 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 52.6340ms
2022-02-17 16:31:29.810 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:31:29.813 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:31:29.814 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 1.2169 ms
2022-02-17 16:31:29.816 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 5.5123ms
2022-02-17 16:31:29.875 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:31:29.884 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:31:29.886 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:31:29.936 -08:00 [INF] Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:31:29.939 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIEMRRGUBR:00000002","TimeStamp":"2022-02-18T00:31:29.0000000Z","ProcessId":23848,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:31:29.991 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:31:30.039 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:31:30.087 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:31:30.133 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:31:30.140 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:31:30.141 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIEMRRGUBR:00000002","TimeStamp":"2022-02-18T00:31:30.0000000Z","ProcessId":23848,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:31:30.199 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:31:30.201 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:31:30.259 -08:00 [INF] Executed DbCommand (50ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:31:30.307 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:31:30.353 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:31:30.398 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:31:30.401 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****UfAw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIEMRRGUBR:00000002","TimeStamp":"2022-02-18T00:31:30.0000000Z","ProcessId":23848,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:31:30.412 -08:00 [INF] HTTP POST /connect/token responded 200 in 535.5855 ms
2022-02-17 16:31:30.414 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 538.5921ms
2022-02-17 16:31:30.422 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:31:30.425 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:31:30.427 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:31:30.475 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:31:30.531 -08:00 [INF] Executed DbCommand (52ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:31:30.584 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:31:30.637 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:31:30.686 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:31:30.732 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:31:30.734 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:31:30.735 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 312.0945 ms
2022-02-17 16:31:30.736 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 313.7318ms
2022-02-17 16:31:30.743 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/ - -
2022-02-17 16:31:30.745 -08:00 [INF] Successfully validated the token.
2022-02-17 16:31:30.745 -08:00 [INF] Start processing HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:31:30.746 -08:00 [INF] Sending HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:31:30.783 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161
2022-02-17 16:31:30.785 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2022-02-17 16:31:30.786 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:31:30.834 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:31:30.837 -08:00 [INF] {"ApiName":"mvc","Category":"Authentication","Name":"API Authentication Failure","EventType":"Failure","Id":1021,"Message":"Unknown API resource","ActivityId":"0HMFIEMRRGUBP:00000005","TimeStamp":"2022-02-18T00:31:30.0000000Z","ProcessId":23848,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ApiAuthenticationFailureEvent"}
2022-02-17 16:31:30.843 -08:00 [ERR] No API resource with that name found. aborting
2022-02-17 16:31:30.844 -08:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2022-02-17 16:31:30.846 -08:00 [INF] HTTP POST /connect/introspect responded 401 in 60.9027 ms
2022-02-17 16:31:30.847 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161 - 401 0 - 64.2447ms
2022-02-17 16:31:30.857 -08:00 [INF] Received HTTP response headers after 110.9207ms - 401
2022-02-17 16:31:30.859 -08:00 [INF] End processing HTTP request after 114.1439ms - 401
2022-02-17 16:31:30.860 -08:00 [ERR] Error returned from introspection endpoint: Unauthorized
2022-02-17 16:31:30.861 -08:00 [INF] Introspection was not authenticated. Failure message: Error returned from introspection endpoint: Unauthorized
2022-02-17 16:31:30.862 -08:00 [INF] Authorization was successful.
2022-02-17 16:31:30.862 -08:00 [INF] Executing endpoint 'IdentityServer.Controllers.PermissionsController.UserAccessibleVolumes (IdentityServer)'
2022-02-17 16:31:30.863 -08:00 [INF] Route matched with {action = "UserAccessibleVolumes", controller = "Permissions"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.Dictionary`2[System.Int64,System.Object]] UserAccessibleVolumes() on controller IdentityServer.Controllers.PermissionsController (IdentityServer).
2022-02-17 16:31:30.883 -08:00 [INF] Executing action method IdentityServer.Controllers.PermissionsController.UserAccessibleVolumes (IdentityServer) - Validation state: "Valid"
2022-02-17 16:31:40.407 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:31:40.453 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__username_0='jamesan' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[UserName] = @__username_0
2022-02-17 16:31:43.034 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[GroupId], [u].[UserId], [t].[Id], [t].[Description], [t].[Name], [t].[ParentID], [t].[ResourceTypeId], [g].[ContainerGroupId], [g].[MemberGroupId]
FROM [UserToGroupAssignments] AS [u]
INNER JOIN (
    SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId]
    FROM [Resource] AS [r]
    WHERE [r].[ResourceTypeId] = N'Group'
) AS [t] ON [u].[GroupId] = [t].[Id]
LEFT JOIN [GroupToGroupAssignments] AS [g] ON [t].[Id] = [g].[MemberGroupId]
WHERE [u].[UserId] = @__userId_0
ORDER BY [u].[GroupId], [u].[UserId], [t].[Id], [g].[ContainerGroupId], [g].[MemberGroupId]
2022-02-17 16:31:43.081 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__groupId_0='1'], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ContainerGroupId], [g].[MemberGroupId], [t].[Id], [t].[Description], [t].[Name], [t].[ParentID], [t].[ResourceTypeId], [g0].[ContainerGroupId], [g0].[MemberGroupId]
FROM [GroupToGroupAssignments] AS [g]
INNER JOIN (
    SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId]
    FROM [Resource] AS [r]
    WHERE [r].[ResourceTypeId] = N'Group'
) AS [t] ON [g].[ContainerGroupId] = [t].[Id]
LEFT JOIN [GroupToGroupAssignments] AS [g0] ON [t].[Id] = [g0].[MemberGroupId]
WHERE [g].[MemberGroupId] = @__groupId_0
ORDER BY [g].[ContainerGroupId], [g].[MemberGroupId], [t].[Id], [g0].[ContainerGroupId], [g0].[MemberGroupId]
2022-02-17 16:31:43.128 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ResourceId], [g].[PermissionId], [g].[GroupId], [g].[GranteeType], [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [GrantedGroupPermissions] AS [g]
INNER JOIN [Resource] AS [r] ON [g].[ResourceId] = [r].[Id]
2022-02-17 16:31:43.451 -08:00 [INF] Executed DbCommand (321ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ResourceId], [r].[Name], [g].[PermissionId], [r].[ResourceTypeId]
FROM [GrantedUserPermissions] AS [g]
INNER JOIN [Resource] AS [r] ON [g].[ResourceId] = [r].[Id]
WHERE [g].[UserId] = @__userId_0
2022-02-17 16:31:43.652 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[ResourceTypeId] = N'Volume'
2022-02-17 16:31:44.744 -08:00 [INF] Executed action method IdentityServer.Controllers.PermissionsController.UserAccessibleVolumes (IdentityServer), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 13859.8384ms.
2022-02-17 16:31:44.745 -08:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.Dictionary`2[[System.Int64, System.Private.CoreLib, Version=5.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=5.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-02-17 16:31:44.844 -08:00 [INF] Executed action IdentityServer.Controllers.PermissionsController.UserAccessibleVolumes (IdentityServer) in 13979.3176ms
2022-02-17 16:31:44.845 -08:00 [INF] Executed endpoint 'IdentityServer.Controllers.PermissionsController.UserAccessibleVolumes (IdentityServer)'
2022-02-17 16:31:44.846 -08:00 [INF] HTTP GET /api/permissions/ responded 200 in 14101.9742 ms
2022-02-17 16:31:44.847 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/ - - - 200 - application/json;+charset=utf-8 14103.8025ms
2022-02-17 16:31:47.584 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/UserPermissions?id=RC1&resourceTypeId=RC1 - -
2022-02-17 16:31:47.586 -08:00 [INF] HTTP GET /api/permissions/UserPermissions?id=RC1&resourceTypeId=RC1 responded 404 in 0.4644 ms
2022-02-17 16:31:47.587 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/UserPermissions?id=RC1&resourceTypeId=RC1 - - - 404 0 - 2.6154ms
2022-02-17 16:31:50.330 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:31:50.379 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:31:50.382 -08:00 [INF] Removing 0 grants
2022-02-17 16:31:50.427 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:31:50.429 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:32:20.440 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:32:20.489 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:32:20.493 -08:00 [INF] Removing 0 grants
2022-02-17 16:32:20.538 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:32:20.540 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:33:59.147 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:33:59.932 -08:00 [INF] Executed DbCommand (53ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:33:59.996 -08:00 [INF] Executed DbCommand (53ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:34:00.045 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:34:00.091 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:34:00.145 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:34:00.160 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:34:00.347 -08:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2022-02-17 16:34:00.393 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:34:00.677 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:34:00.726 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:34:00.772 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:34:00.820 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:34:00.870 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:34:00.873 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:34:01.052 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[Name] = N'Administrator'
2022-02-17 16:34:01.074 -08:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2022-02-17 16:34:01.081 -08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2022-02-17 16:34:01.172 -08:00 [INF] User profile is available. Using 'C:\Users\u0490822\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2022-02-17 16:34:31.214 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:34:31.313 -08:00 [INF] Executed DbCommand (61ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:34:31.322 -08:00 [INF] Removing 0 grants
2022-02-17 16:34:31.373 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:34:31.379 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:34:39.665 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:34:39.690 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:34:39.700 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:34:39.809 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:34:39.876 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 206.2071 ms
2022-02-17 16:34:39.881 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 217.9634ms
2022-02-17 16:34:39.928 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:34:39.930 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:34:39.953 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 24.4742 ms
2022-02-17 16:34:39.964 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 35.3271ms
2022-02-17 16:34:40.021 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:34:40.038 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:34:40.074 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:34:40.125 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:34:40.144 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIEPPCVRMO:00000002","TimeStamp":"2022-02-18T00:34:40.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:34:40.246 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:34:40.315 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:34:40.363 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:34:40.426 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:34:40.471 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:34:40.483 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIEPPCVRMO:00000002","TimeStamp":"2022-02-18T00:34:40.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:34:40.551 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:34:40.559 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:34:40.635 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:34:40.703 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:34:40.757 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:34:40.808 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:34:40.910 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****kmMQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIEPPCVRMO:00000002","TimeStamp":"2022-02-18T00:34:40.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:34:40.924 -08:00 [INF] HTTP POST /connect/token responded 200 in 901.4730 ms
2022-02-17 16:34:40.925 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 903.9617ms
2022-02-17 16:34:40.933 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:34:40.935 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:34:40.978 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:34:41.026 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:34:41.080 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:34:41.134 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:34:41.182 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:34:41.230 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:34:41.277 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:34:41.279 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:34:41.281 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 347.1948 ms
2022-02-17 16:34:41.282 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 348.7043ms
2022-02-17 16:34:41.289 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/CurrentUser - -
2022-02-17 16:34:41.311 -08:00 [INF] HTTP GET /api/permissions/CurrentUser responded 404 in 21.9085 ms
2022-02-17 16:34:41.312 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/CurrentUser - - - 404 0 - 23.4275ms
2022-02-17 16:34:44.592 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:34:44.594 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:34:44.595 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:34:44.647 -08:00 [INF] Executed DbCommand (50ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:34:44.650 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 57.2370 ms
2022-02-17 16:34:44.651 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 59.1284ms
2022-02-17 16:34:44.693 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:34:44.695 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:34:44.697 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 2.0154 ms
2022-02-17 16:34:44.698 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 4.8435ms
2022-02-17 16:34:44.754 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:34:44.755 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:34:44.758 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:34:44.805 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:34:44.811 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIEPPCVRMR:00000002","TimeStamp":"2022-02-18T00:34:44.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:34:44.870 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:34:44.918 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:34:44.965 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:34:45.014 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:34:45.018 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:34:45.019 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIEPPCVRMR:00000002","TimeStamp":"2022-02-18T00:34:45.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:34:45.072 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:34:45.076 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:34:45.130 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:34:45.180 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:34:45.230 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:34:45.276 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:34:45.280 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****NOAw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIEPPCVRMR:00000002","TimeStamp":"2022-02-18T00:34:45.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:34:45.287 -08:00 [INF] HTTP POST /connect/token responded 200 in 532.4044 ms
2022-02-17 16:34:45.289 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 534.3566ms
2022-02-17 16:34:45.297 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:34:45.299 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:34:45.301 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:34:45.346 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:34:45.394 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:34:45.441 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:34:45.490 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:34:45.541 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:34:45.594 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:34:45.598 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:34:45.598 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 300.2167 ms
2022-02-17 16:34:45.600 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 302.0137ms
2022-02-17 16:34:45.607 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/CurrentUser - -
2022-02-17 16:34:45.610 -08:00 [INF] HTTP GET /api/permissions/CurrentUser responded 404 in 2.5814 ms
2022-02-17 16:34:45.612 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/CurrentUser - - - 404 0 - 4.8003ms
2022-02-17 16:35:01.390 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:35:01.436 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:35:01.439 -08:00 [INF] Removing 0 grants
2022-02-17 16:35:01.485 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:35:01.487 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:35:02.745 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:35:02.751 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:35:02.752 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:35:02.799 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:35:02.804 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 58.6208 ms
2022-02-17 16:35:02.806 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 61.5308ms
2022-02-17 16:35:02.849 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:35:02.851 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:35:02.852 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 2.1402 ms
2022-02-17 16:35:02.853 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 3.6678ms
2022-02-17 16:35:02.910 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:35:02.917 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:35:02.925 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:35:02.973 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:35:02.976 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIEPPCVRMU:00000002","TimeStamp":"2022-02-18T00:35:02.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:35:03.026 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:35:03.074 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:35:03.120 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:35:03.167 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:35:03.170 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:35:03.171 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIEPPCVRMU:00000002","TimeStamp":"2022-02-18T00:35:03.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:35:03.225 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:35:03.227 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:35:03.280 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:35:03.328 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:35:03.380 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:35:03.427 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:35:03.431 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****3Etw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIEPPCVRMU:00000002","TimeStamp":"2022-02-18T00:35:03.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:35:03.441 -08:00 [INF] HTTP POST /connect/token responded 200 in 529.5715 ms
2022-02-17 16:35:03.442 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 531.6361ms
2022-02-17 16:35:03.450 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:35:03.452 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:35:03.453 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:35:03.500 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:35:03.550 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:35:03.600 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:35:03.646 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:35:03.694 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:35:03.743 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:35:03.749 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:35:03.751 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 300.5213 ms
2022-02-17 16:35:03.754 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 303.6618ms
2022-02-17 16:35:03.761 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/currentuser - -
2022-02-17 16:35:03.762 -08:00 [INF] HTTP GET /api/permissions/currentuser responded 404 in 0.2866 ms
2022-02-17 16:35:03.764 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/currentuser - - - 404 0 - 3.5439ms
2022-02-17 16:35:31.487 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:35:31.539 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:35:31.542 -08:00 [INF] Removing 0 grants
2022-02-17 16:35:31.598 -08:00 [INF] Executed DbCommand (54ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:35:31.607 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:36:01.616 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:36:01.664 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:36:01.666 -08:00 [INF] Removing 0 grants
2022-02-17 16:36:01.710 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:36:01.712 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:36:16.039 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:36:16.044 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:36:16.045 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:36:16.092 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:36:16.094 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 50.5401 ms
2022-02-17 16:36:16.096 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 56.4390ms
2022-02-17 16:36:16.140 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:36:16.141 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:36:16.142 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 1.2753 ms
2022-02-17 16:36:16.143 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 2.7926ms
2022-02-17 16:36:16.206 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:36:16.207 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:36:16.210 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:36:16.256 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:36:16.258 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIEPPCVRN1:00000002","TimeStamp":"2022-02-18T00:36:16.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:36:16.309 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:36:16.354 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:36:16.401 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:36:16.449 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:36:16.454 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:36:16.454 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIEPPCVRN1:00000002","TimeStamp":"2022-02-18T00:36:16.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:36:16.512 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:36:16.514 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:36:16.578 -08:00 [INF] Executed DbCommand (50ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:36:16.625 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:36:16.673 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:36:16.721 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:36:16.725 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****BEWg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIEPPCVRN1:00000002","TimeStamp":"2022-02-18T00:36:16.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:36:16.732 -08:00 [INF] HTTP POST /connect/token responded 200 in 525.2606 ms
2022-02-17 16:36:16.733 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 526.8833ms
2022-02-17 16:36:16.742 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:36:16.743 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:36:16.744 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:36:16.794 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:36:16.842 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:36:16.889 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:36:16.941 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:36:16.989 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:36:17.036 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:36:17.038 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:36:17.039 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 296.5647 ms
2022-02-17 16:36:17.040 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 298.2526ms
2022-02-17 16:36:31.723 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:36:31.771 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:36:31.775 -08:00 [INF] Removing 0 grants
2022-02-17 16:36:31.821 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:36:31.823 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:36:37.086 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/currentuser - -
2022-02-17 16:36:37.087 -08:00 [INF] HTTP GET /api/permissions/currentuser responded 404 in 0.2508 ms
2022-02-17 16:36:37.088 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/currentuser - - - 404 0 - 1.9644ms
2022-02-17 16:36:42.463 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:36:42.464 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:36:42.465 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:36:42.513 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:36:42.517 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 53.1734 ms
2022-02-17 16:36:42.518 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 54.8351ms
2022-02-17 16:36:42.562 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:36:42.563 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:36:42.564 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 1.3161 ms
2022-02-17 16:36:42.565 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 3.1474ms
2022-02-17 16:36:42.620 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:36:42.621 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:36:42.624 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:36:42.671 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:36:42.678 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIEPPCVRN4:00000002","TimeStamp":"2022-02-18T00:36:42.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:36:42.733 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:36:42.781 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:36:42.827 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:36:42.876 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:36:42.882 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:36:42.883 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIEPPCVRN4:00000002","TimeStamp":"2022-02-18T00:36:42.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:36:42.941 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:36:42.943 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:36:42.997 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:36:43.045 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:36:43.094 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:36:43.145 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:36:43.147 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****V2ew","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIEPPCVRN4:00000002","TimeStamp":"2022-02-18T00:36:43.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:36:43.156 -08:00 [INF] HTTP POST /connect/token responded 200 in 534.5013 ms
2022-02-17 16:36:43.157 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 536.1820ms
2022-02-17 16:36:43.164 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:36:43.165 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:36:43.172 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:36:43.219 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:36:43.268 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:36:43.320 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:36:43.369 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:36:43.700 -08:00 [INF] Executed DbCommand (326ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:36:43.747 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:36:43.749 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:36:43.749 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 584.4519 ms
2022-02-17 16:36:43.750 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 586.0260ms
2022-02-17 16:36:44.834 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/CurrentUser - -
2022-02-17 16:36:44.835 -08:00 [INF] HTTP GET /api/permissions/CurrentUser responded 404 in 0.2088 ms
2022-02-17 16:36:44.835 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/CurrentUser - - - 404 0 - 1.7495ms
2022-02-17 16:36:47.417 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:36:47.418 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:36:47.419 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:36:47.467 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:36:47.471 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 52.9045 ms
2022-02-17 16:36:47.472 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 54.8589ms
2022-02-17 16:36:47.515 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:36:47.516 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:36:47.517 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 1.2390 ms
2022-02-17 16:36:47.518 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 2.9128ms
2022-02-17 16:36:47.575 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:36:47.576 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:36:47.578 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:36:47.630 -08:00 [INF] Executed DbCommand (50ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:36:47.635 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIEPPCVRN7:00000002","TimeStamp":"2022-02-18T00:36:47.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:36:47.688 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:36:47.739 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:36:47.786 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:36:47.834 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:36:47.838 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:36:47.839 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIEPPCVRN7:00000002","TimeStamp":"2022-02-18T00:36:47.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:36:47.895 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:36:47.896 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:36:47.948 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:36:47.995 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:36:48.047 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:36:48.097 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:36:48.099 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****sBxg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIEPPCVRN7:00000002","TimeStamp":"2022-02-18T00:36:48.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:36:48.109 -08:00 [INF] HTTP POST /connect/token responded 200 in 533.8288 ms
2022-02-17 16:36:48.110 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 535.4551ms
2022-02-17 16:36:48.118 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:36:48.120 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:36:48.121 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:36:48.178 -08:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:36:48.231 -08:00 [INF] Executed DbCommand (50ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:36:48.281 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:36:48.329 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:36:48.381 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:36:48.428 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:36:48.430 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:36:48.431 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 311.2431 ms
2022-02-17 16:36:48.431 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 313.0195ms
2022-02-17 16:36:51.633 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/CurrentUser - -
2022-02-17 16:36:51.634 -08:00 [INF] HTTP GET /api/permissions/CurrentUser responded 404 in 0.2146 ms
2022-02-17 16:36:51.635 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/CurrentUser - - - 404 0 - 1.9319ms
2022-02-17 16:36:53.559 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:36:53.560 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:36:53.562 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:36:53.610 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:36:53.614 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 54.3057 ms
2022-02-17 16:36:53.615 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 56.1942ms
2022-02-17 16:36:53.658 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:36:53.659 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:36:53.661 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 2.0506 ms
2022-02-17 16:36:53.662 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 4.1403ms
2022-02-17 16:36:53.719 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:36:53.720 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:36:53.722 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:36:53.770 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:36:53.772 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIEPPCVRNA:00000002","TimeStamp":"2022-02-18T00:36:53.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:36:53.826 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:36:53.875 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:36:53.925 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:36:53.974 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:36:53.980 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:36:53.981 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIEPPCVRNA:00000002","TimeStamp":"2022-02-18T00:36:53.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:36:54.037 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:36:54.041 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:36:54.097 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:36:54.143 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:36:54.189 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:36:54.237 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:36:54.242 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****5RlQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIEPPCVRNA:00000002","TimeStamp":"2022-02-18T00:36:54.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:36:54.250 -08:00 [INF] HTTP POST /connect/token responded 200 in 530.4692 ms
2022-02-17 16:36:54.251 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 532.5392ms
2022-02-17 16:36:54.260 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:36:54.261 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:36:54.262 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:36:54.310 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:36:54.359 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:36:54.410 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:36:54.457 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:36:54.508 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:36:54.555 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:36:54.558 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:36:54.559 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 298.4912 ms
2022-02-17 16:36:54.560 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 300.2422ms
2022-02-17 16:36:57.678 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions - -
2022-02-17 16:36:57.679 -08:00 [INF] HTTP GET /api/permissions responded 404 in 0.2335 ms
2022-02-17 16:36:57.680 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions - - - 404 0 - 2.0360ms
2022-02-17 16:37:00.621 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:37:00.622 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:37:00.623 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:37:00.670 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:37:00.673 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 51.2739 ms
2022-02-17 16:37:00.674 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 53.2213ms
2022-02-17 16:37:00.722 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:37:00.722 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:37:00.724 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 1.4503 ms
2022-02-17 16:37:00.725 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 3.0182ms
2022-02-17 16:37:00.782 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:37:00.783 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:37:00.787 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:37:00.834 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:37:00.839 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIEPPCVRND:00000002","TimeStamp":"2022-02-18T00:37:00.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:37:00.893 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:37:00.943 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:37:00.992 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:37:01.043 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:37:01.047 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:37:01.048 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIEPPCVRND:00000002","TimeStamp":"2022-02-18T00:37:01.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:37:01.102 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:37:01.106 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:37:01.439 -08:00 [INF] Executed DbCommand (325ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:37:01.487 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:37:01.533 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:37:01.581 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:37:01.585 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****VIcA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIEPPCVRND:00000002","TimeStamp":"2022-02-18T00:37:01.0000000Z","ProcessId":6504,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:37:01.603 -08:00 [INF] HTTP POST /connect/token responded 200 in 820.4254 ms
2022-02-17 16:37:01.606 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 823.7178ms
2022-02-17 16:37:01.615 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:37:01.616 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:37:01.617 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:37:01.664 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:37:01.714 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:37:01.761 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:37:01.807 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:37:01.817 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:37:01.853 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:37:01.863 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:37:01.865 -08:00 [INF] Removing 0 grants
2022-02-17 16:37:01.899 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:37:01.902 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:37:01.903 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 287.0230 ms
2022-02-17 16:37:01.903 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 288.4159ms
2022-02-17 16:37:01.910 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:37:01.912 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:37:31.912 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:37:31.961 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:37:31.963 -08:00 [INF] Removing 0 grants
2022-02-17 16:37:32.010 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:37:32.014 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:38:02.028 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:38:02.076 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:38:02.084 -08:00 [INF] Removing 0 grants
2022-02-17 16:38:02.129 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:38:02.142 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:38:11.045 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:38:11.776 -08:00 [INF] Executed DbCommand (56ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:38:11.839 -08:00 [INF] Executed DbCommand (54ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:38:11.887 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:38:11.934 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:38:11.990 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:38:12.005 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:38:12.200 -08:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2022-02-17 16:38:12.248 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:38:12.530 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:38:12.576 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:38:12.621 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:38:12.667 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:38:12.717 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:38:12.719 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:38:12.894 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[Name] = N'Administrator'
2022-02-17 16:38:12.920 -08:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2022-02-17 16:38:12.927 -08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2022-02-17 16:38:13.026 -08:00 [INF] User profile is available. Using 'C:\Users\u0490822\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2022-02-17 16:38:21.077 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:38:21.104 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:38:21.114 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:38:21.242 -08:00 [INF] Executed DbCommand (54ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:38:21.314 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 231.7376 ms
2022-02-17 16:38:21.318 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 243.2747ms
2022-02-17 16:38:21.377 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:38:21.379 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:38:21.399 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 21.2822 ms
2022-02-17 16:38:21.401 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 23.5149ms
2022-02-17 16:38:21.463 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:38:21.477 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:38:21.514 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:38:21.562 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:38:21.582 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIERRCHV8J:00000002","TimeStamp":"2022-02-18T00:38:21.0000000Z","ProcessId":1516,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:38:21.683 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:38:21.762 -08:00 [INF] Executed DbCommand (54ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:38:21.810 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:38:21.873 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:38:21.925 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:38:21.938 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIERRCHV8J:00000002","TimeStamp":"2022-02-18T00:38:21.0000000Z","ProcessId":1516,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:38:22.005 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:38:22.014 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:38:22.091 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:38:22.153 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:38:22.208 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:38:22.258 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:38:22.356 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****Wmsw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIERRCHV8J:00000002","TimeStamp":"2022-02-18T00:38:22.0000000Z","ProcessId":1516,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:38:22.368 -08:00 [INF] HTTP POST /connect/token responded 200 in 904.8356 ms
2022-02-17 16:38:22.369 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 906.5208ms
2022-02-17 16:38:22.377 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:38:22.378 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:38:22.418 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:38:22.466 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:38:22.522 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:38:22.576 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:38:22.625 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:38:22.672 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:38:22.722 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:38:22.726 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:38:22.728 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 350.3592 ms
2022-02-17 16:38:22.729 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 351.8023ms
2022-02-17 16:38:24.271 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions - -
2022-02-17 16:38:24.424 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:38:24.425 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:38:24.427 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:38:24.475 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:38:24.479 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 53.7306 ms
2022-02-17 16:38:24.480 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 55.9523ms
2022-02-17 16:38:24.552 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:38:24.553 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:38:24.554 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 1.3334 ms
2022-02-17 16:38:24.564 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 11.9606ms
2022-02-17 16:38:24.578 -08:00 [INF] Successfully validated the token.
2022-02-17 16:38:24.594 -08:00 [INF] Start processing HTTP request GET "https://localhost:5001/.well-known/openid-configuration"
2022-02-17 16:38:24.596 -08:00 [INF] Sending HTTP request GET "https://localhost:5001/.well-known/openid-configuration"
2022-02-17 16:38:24.613 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:38:24.619 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:38:24.620 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:38:24.667 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:38:24.670 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 56.6684 ms
2022-02-17 16:38:24.684 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 71.2559ms
2022-02-17 16:38:24.687 -08:00 [INF] Received HTTP response headers after 88.6482ms - 200
2022-02-17 16:38:24.688 -08:00 [INF] End processing HTTP request after 95.8555ms - 200
2022-02-17 16:38:24.695 -08:00 [INF] Start processing HTTP request GET "https://localhost:5001/.well-known/openid-configuration/jwks"
2022-02-17 16:38:24.696 -08:00 [INF] Sending HTTP request GET "https://localhost:5001/.well-known/openid-configuration/jwks"
2022-02-17 16:38:24.717 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:38:24.718 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:38:24.720 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 2.0302 ms
2022-02-17 16:38:24.729 -08:00 [INF] Received HTTP response headers after 32.7851ms - 200
2022-02-17 16:38:24.729 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 12.4269ms
2022-02-17 16:38:24.730 -08:00 [INF] End processing HTTP request after 35.2974ms - 200
2022-02-17 16:38:24.740 -08:00 [INF] Start processing HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:38:24.742 -08:00 [INF] Sending HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:38:24.767 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161
2022-02-17 16:38:24.768 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2022-02-17 16:38:24.774 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:38:24.830 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:38:24.833 -08:00 [INF] {"ApiName":"mvc","Category":"Authentication","Name":"API Authentication Failure","EventType":"Failure","Id":1021,"Message":"Unknown API resource","ActivityId":"0HMFIERRCHV8M:00000004","TimeStamp":"2022-02-18T00:38:24.0000000Z","ProcessId":1516,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ApiAuthenticationFailureEvent"}
2022-02-17 16:38:24.838 -08:00 [ERR] No API resource with that name found. aborting
2022-02-17 16:38:24.839 -08:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2022-02-17 16:38:24.840 -08:00 [INF] HTTP POST /connect/introspect responded 401 in 72.2849 ms
2022-02-17 16:38:24.841 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161 - 401 0 - 74.0030ms
2022-02-17 16:38:24.851 -08:00 [INF] Received HTTP response headers after 109.4199ms - 401
2022-02-17 16:38:24.853 -08:00 [INF] End processing HTTP request after 112.6567ms - 401
2022-02-17 16:38:24.856 -08:00 [ERR] Error returned from introspection endpoint: Unauthorized
2022-02-17 16:38:24.858 -08:00 [INF] Introspection was not authenticated. Failure message: Error returned from introspection endpoint: Unauthorized
2022-02-17 16:38:24.863 -08:00 [INF] Authorization was successful.
2022-02-17 16:38:24.864 -08:00 [INF] Executing endpoint 'IdentityServer.Controllers.PermissionsController.UserAccessibleVolumes (IdentityServer)'
2022-02-17 16:38:24.874 -08:00 [INF] Route matched with {action = "UserAccessibleVolumes", controller = "Permissions"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.Dictionary`2[System.Int64,System.Object]] UserAccessibleVolumes() on controller IdentityServer.Controllers.PermissionsController (IdentityServer).
2022-02-17 16:38:24.926 -08:00 [INF] Executing action method IdentityServer.Controllers.PermissionsController.UserAccessibleVolumes (IdentityServer) - Validation state: "Valid"
2022-02-17 16:38:28.977 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:38:29.028 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__username_0='jamesan' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[UserName] = @__username_0
2022-02-17 16:38:29.091 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[GroupId], [u].[UserId], [t].[Id], [t].[Description], [t].[Name], [t].[ParentID], [t].[ResourceTypeId], [g].[ContainerGroupId], [g].[MemberGroupId]
FROM [UserToGroupAssignments] AS [u]
INNER JOIN (
    SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId]
    FROM [Resource] AS [r]
    WHERE [r].[ResourceTypeId] = N'Group'
) AS [t] ON [u].[GroupId] = [t].[Id]
LEFT JOIN [GroupToGroupAssignments] AS [g] ON [t].[Id] = [g].[MemberGroupId]
WHERE [u].[UserId] = @__userId_0
ORDER BY [u].[GroupId], [u].[UserId], [t].[Id], [g].[ContainerGroupId], [g].[MemberGroupId]
2022-02-17 16:38:29.161 -08:00 [INF] Executed DbCommand (51ms) [Parameters=[@__groupId_0='1'], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ContainerGroupId], [g].[MemberGroupId], [t].[Id], [t].[Description], [t].[Name], [t].[ParentID], [t].[ResourceTypeId], [g0].[ContainerGroupId], [g0].[MemberGroupId]
FROM [GroupToGroupAssignments] AS [g]
INNER JOIN (
    SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId]
    FROM [Resource] AS [r]
    WHERE [r].[ResourceTypeId] = N'Group'
) AS [t] ON [g].[ContainerGroupId] = [t].[Id]
LEFT JOIN [GroupToGroupAssignments] AS [g0] ON [t].[Id] = [g0].[MemberGroupId]
WHERE [g].[MemberGroupId] = @__groupId_0
ORDER BY [g].[ContainerGroupId], [g].[MemberGroupId], [t].[Id], [g0].[ContainerGroupId], [g0].[MemberGroupId]
2022-02-17 16:38:29.229 -08:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ResourceId], [g].[PermissionId], [g].[GroupId], [g].[GranteeType], [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [GrantedGroupPermissions] AS [g]
INNER JOIN [Resource] AS [r] ON [g].[ResourceId] = [r].[Id]
2022-02-17 16:38:29.285 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ResourceId], [r].[Name], [g].[PermissionId], [r].[ResourceTypeId]
FROM [GrantedUserPermissions] AS [g]
INNER JOIN [Resource] AS [r] ON [g].[ResourceId] = [r].[Id]
WHERE [g].[UserId] = @__userId_0
2022-02-17 16:38:29.342 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[ResourceTypeId] = N'Volume'
2022-02-17 16:38:29.348 -08:00 [INF] Executed action method IdentityServer.Controllers.PermissionsController.UserAccessibleVolumes (IdentityServer), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 4418.6895ms.
2022-02-17 16:38:29.353 -08:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.Dictionary`2[[System.Int64, System.Private.CoreLib, Version=5.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=5.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-02-17 16:38:29.365 -08:00 [INF] Executed action IdentityServer.Controllers.PermissionsController.UserAccessibleVolumes (IdentityServer) in 4486.8232ms
2022-02-17 16:38:29.367 -08:00 [INF] Executed endpoint 'IdentityServer.Controllers.PermissionsController.UserAccessibleVolumes (IdentityServer)'
2022-02-17 16:38:29.368 -08:00 [INF] HTTP GET /api/permissions responded 200 in 5095.9209 ms
2022-02-17 16:38:29.369 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions - - - 200 - application/json;+charset=utf-8 5097.6144ms
2022-02-17 16:38:31.366 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/Permissions/RC1 - -
2022-02-17 16:38:31.369 -08:00 [INF] HTTP GET /api/Permissions/RC1 responded 404 in 2.2819 ms
2022-02-17 16:38:31.370 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/Permissions/RC1 - - - 404 0 - 4.1897ms
2022-02-17 16:38:35.983 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:38:35.985 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:38:35.986 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:38:36.033 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:38:36.036 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 52.2616 ms
2022-02-17 16:38:36.037 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 54.0536ms
2022-02-17 16:38:36.083 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:38:36.085 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:38:36.086 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 1.7504 ms
2022-02-17 16:38:36.087 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 3.7261ms
2022-02-17 16:38:36.145 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:38:36.146 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:38:36.149 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:38:36.197 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:38:36.201 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIERRCHV8O:00000002","TimeStamp":"2022-02-18T00:38:36.0000000Z","ProcessId":1516,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:38:36.260 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:38:36.307 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:38:36.356 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:38:36.404 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:38:36.408 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:38:36.409 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIERRCHV8O:00000002","TimeStamp":"2022-02-18T00:38:36.0000000Z","ProcessId":1516,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:38:36.463 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:38:36.467 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:38:36.521 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:38:36.570 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:38:36.622 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:38:36.669 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:38:36.673 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****SPsA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIERRCHV8O:00000002","TimeStamp":"2022-02-18T00:38:36.0000000Z","ProcessId":1516,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:38:36.684 -08:00 [INF] HTTP POST /connect/token responded 200 in 538.7925 ms
2022-02-17 16:38:36.686 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 540.7379ms
2022-02-17 16:38:36.695 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:38:36.696 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:38:36.697 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:38:36.754 -08:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:38:36.802 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:38:36.851 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:38:36.904 -08:00 [INF] Executed DbCommand (49ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:38:36.953 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:38:37.004 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:38:37.008 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:38:37.009 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 313.5664 ms
2022-02-17 16:38:37.010 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 315.6577ms
2022-02-17 16:38:38.771 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions - -
2022-02-17 16:38:38.773 -08:00 [INF] Successfully validated the token.
2022-02-17 16:38:38.774 -08:00 [INF] Start processing HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:38:38.775 -08:00 [INF] Sending HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:38:38.803 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161
2022-02-17 16:38:38.805 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2022-02-17 16:38:38.807 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:38:38.853 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:38:38.856 -08:00 [INF] {"ApiName":"mvc","Category":"Authentication","Name":"API Authentication Failure","EventType":"Failure","Id":1021,"Message":"Unknown API resource","ActivityId":"0HMFIERRCHV8M:00000005","TimeStamp":"2022-02-18T00:38:38.0000000Z","ProcessId":1516,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ApiAuthenticationFailureEvent"}
2022-02-17 16:38:38.860 -08:00 [ERR] No API resource with that name found. aborting
2022-02-17 16:38:38.860 -08:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2022-02-17 16:38:38.861 -08:00 [INF] HTTP POST /connect/introspect responded 401 in 55.9818 ms
2022-02-17 16:38:38.862 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161 - 401 0 - 58.2203ms
2022-02-17 16:38:38.871 -08:00 [INF] Received HTTP response headers after 96.2057ms - 401
2022-02-17 16:38:38.872 -08:00 [INF] End processing HTTP request after 97.9846ms - 401
2022-02-17 16:38:38.873 -08:00 [ERR] Error returned from introspection endpoint: Unauthorized
2022-02-17 16:38:38.873 -08:00 [INF] Introspection was not authenticated. Failure message: Error returned from introspection endpoint: Unauthorized
2022-02-17 16:38:38.874 -08:00 [INF] Authorization was successful.
2022-02-17 16:38:38.875 -08:00 [INF] Executing endpoint 'IdentityServer.Controllers.PermissionsController.UserAccessibleVolumes (IdentityServer)'
2022-02-17 16:38:38.875 -08:00 [INF] Route matched with {action = "UserAccessibleVolumes", controller = "Permissions"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.Dictionary`2[System.Int64,System.Object]] UserAccessibleVolumes() on controller IdentityServer.Controllers.PermissionsController (IdentityServer).
2022-02-17 16:38:38.897 -08:00 [INF] Executing action method IdentityServer.Controllers.PermissionsController.UserAccessibleVolumes (IdentityServer) - Validation state: "Valid"
2022-02-17 16:43:37.435 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:43:38.038 -08:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:43:38.102 -08:00 [INF] Executed DbCommand (53ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:43:38.148 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:43:38.195 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:43:38.247 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:43:38.263 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:43:38.488 -08:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2022-02-17 16:43:38.540 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:43:38.821 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:43:38.870 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:43:38.916 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:43:38.962 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:43:39.009 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:43:39.010 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:43:39.194 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[Name] = N'Administrator'
2022-02-17 16:43:39.222 -08:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2022-02-17 16:43:39.229 -08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2022-02-17 16:43:39.324 -08:00 [INF] User profile is available. Using 'C:\Users\u0490822\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2022-02-17 16:43:39.533 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:43:39.556 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:43:39.565 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:43:39.692 -08:00 [INF] Executed DbCommand (54ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:43:39.767 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 229.3695 ms
2022-02-17 16:43:39.771 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 239.5776ms
2022-02-17 16:43:39.824 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:43:39.827 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:43:39.859 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 33.9433 ms
2022-02-17 16:43:39.870 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 46.1583ms
2022-02-17 16:43:39.942 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:43:39.961 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:43:40.012 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:43:40.063 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:43:40.084 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIEUQ9M78N:00000002","TimeStamp":"2022-02-18T00:43:40.0000000Z","ProcessId":27076,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:43:40.204 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:43:40.290 -08:00 [INF] Executed DbCommand (56ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:43:40.340 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:43:40.409 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:43:40.461 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:43:40.475 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIEUQ9M78N:00000002","TimeStamp":"2022-02-18T00:43:40.0000000Z","ProcessId":27076,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:43:40.546 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:43:40.554 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:43:40.642 -08:00 [INF] Executed DbCommand (49ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:43:40.733 -08:00 [INF] Executed DbCommand (63ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:43:40.808 -08:00 [INF] Executed DbCommand (62ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:43:40.861 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:43:40.966 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****eg3w","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIEUQ9M78N:00000002","TimeStamp":"2022-02-18T00:43:40.0000000Z","ProcessId":27076,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:43:40.981 -08:00 [INF] HTTP POST /connect/token responded 200 in 1037.9668 ms
2022-02-17 16:43:40.982 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 1039.7612ms
2022-02-17 16:43:40.989 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:43:40.991 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:43:41.034 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:43:41.083 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:43:41.143 -08:00 [INF] Executed DbCommand (49ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:43:41.195 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:43:41.248 -08:00 [INF] Executed DbCommand (49ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:43:41.296 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:43:41.344 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:43:41.350 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:43:41.352 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 361.8232 ms
2022-02-17 16:43:41.353 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 363.3065ms
2022-02-17 16:43:44.966 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions - -
2022-02-17 16:43:45.121 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:43:45.122 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:43:45.123 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:43:45.169 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:43:45.173 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 51.2017 ms
2022-02-17 16:43:45.174 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 52.8912ms
2022-02-17 16:43:45.248 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:43:45.249 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:43:45.251 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 1.5801 ms
2022-02-17 16:43:45.261 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 12.5214ms
2022-02-17 16:43:45.277 -08:00 [INF] Successfully validated the token.
2022-02-17 16:43:45.294 -08:00 [INF] Start processing HTTP request GET "https://localhost:5001/.well-known/openid-configuration"
2022-02-17 16:43:45.295 -08:00 [INF] Sending HTTP request GET "https://localhost:5001/.well-known/openid-configuration"
2022-02-17 16:43:45.314 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:43:45.320 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:43:45.321 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:43:45.368 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:43:45.370 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 55.7903 ms
2022-02-17 16:43:45.383 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 69.0661ms
2022-02-17 16:43:45.385 -08:00 [INF] Received HTTP response headers after 87.5869ms - 200
2022-02-17 16:43:45.387 -08:00 [INF] End processing HTTP request after 95.19ms - 200
2022-02-17 16:43:45.394 -08:00 [INF] Start processing HTTP request GET "https://localhost:5001/.well-known/openid-configuration/jwks"
2022-02-17 16:43:45.395 -08:00 [INF] Sending HTTP request GET "https://localhost:5001/.well-known/openid-configuration/jwks"
2022-02-17 16:43:45.417 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:43:45.419 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:43:45.421 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 2.3356 ms
2022-02-17 16:43:45.432 -08:00 [INF] Received HTTP response headers after 36.6533ms - 200
2022-02-17 16:43:45.432 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 14.8673ms
2022-02-17 16:43:45.433 -08:00 [INF] End processing HTTP request after 38.482ms - 200
2022-02-17 16:43:45.444 -08:00 [INF] Start processing HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:43:45.445 -08:00 [INF] Sending HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:43:45.476 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161
2022-02-17 16:43:45.477 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2022-02-17 16:43:45.483 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:43:45.541 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:43:45.544 -08:00 [INF] {"ApiName":"mvc","Category":"Authentication","Name":"API Authentication Failure","EventType":"Failure","Id":1021,"Message":"Unknown API resource","ActivityId":"0HMFIEUQ9M78Q:00000004","TimeStamp":"2022-02-18T00:43:45.0000000Z","ProcessId":27076,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ApiAuthenticationFailureEvent"}
2022-02-17 16:43:45.549 -08:00 [ERR] No API resource with that name found. aborting
2022-02-17 16:43:45.549 -08:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2022-02-17 16:43:45.550 -08:00 [INF] HTTP POST /connect/introspect responded 401 in 73.6764 ms
2022-02-17 16:43:45.552 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161 - 401 0 - 75.5828ms
2022-02-17 16:43:45.563 -08:00 [INF] Received HTTP response headers after 117.619ms - 401
2022-02-17 16:43:45.563 -08:00 [INF] End processing HTTP request after 118.9391ms - 401
2022-02-17 16:43:45.567 -08:00 [ERR] Error returned from introspection endpoint: Unauthorized
2022-02-17 16:43:45.568 -08:00 [INF] Introspection was not authenticated. Failure message: Error returned from introspection endpoint: Unauthorized
2022-02-17 16:43:45.573 -08:00 [INF] Authorization was successful.
2022-02-17 16:43:45.574 -08:00 [INF] Executing endpoint 'IdentityServer.Controllers.PermissionsController.UserAccessibleVolumes (IdentityServer)'
2022-02-17 16:43:45.585 -08:00 [INF] Route matched with {action = "UserAccessibleVolumes", controller = "Permissions"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.Dictionary`2[System.Int64,System.Object]] UserAccessibleVolumes() on controller IdentityServer.Controllers.PermissionsController (IdentityServer).
2022-02-17 16:43:45.640 -08:00 [INF] Executing action method IdentityServer.Controllers.PermissionsController.UserAccessibleVolumes (IdentityServer) - Validation state: "Valid"
2022-02-17 16:43:51.378 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:43:51.429 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__username_0='jamesan' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[UserName] = @__username_0
2022-02-17 16:43:54.799 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[GroupId], [u].[UserId], [t].[Id], [t].[Description], [t].[Name], [t].[ParentID], [t].[ResourceTypeId], [g].[ContainerGroupId], [g].[MemberGroupId]
FROM [UserToGroupAssignments] AS [u]
INNER JOIN (
    SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId]
    FROM [Resource] AS [r]
    WHERE [r].[ResourceTypeId] = N'Group'
) AS [t] ON [u].[GroupId] = [t].[Id]
LEFT JOIN [GroupToGroupAssignments] AS [g] ON [t].[Id] = [g].[MemberGroupId]
WHERE [u].[UserId] = @__userId_0
ORDER BY [u].[GroupId], [u].[UserId], [t].[Id], [g].[ContainerGroupId], [g].[MemberGroupId]
2022-02-17 16:43:54.865 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__groupId_0='1'], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ContainerGroupId], [g].[MemberGroupId], [t].[Id], [t].[Description], [t].[Name], [t].[ParentID], [t].[ResourceTypeId], [g0].[ContainerGroupId], [g0].[MemberGroupId]
FROM [GroupToGroupAssignments] AS [g]
INNER JOIN (
    SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId]
    FROM [Resource] AS [r]
    WHERE [r].[ResourceTypeId] = N'Group'
) AS [t] ON [g].[ContainerGroupId] = [t].[Id]
LEFT JOIN [GroupToGroupAssignments] AS [g0] ON [t].[Id] = [g0].[MemberGroupId]
WHERE [g].[MemberGroupId] = @__groupId_0
ORDER BY [g].[ContainerGroupId], [g].[MemberGroupId], [t].[Id], [g0].[ContainerGroupId], [g0].[MemberGroupId]
2022-02-17 16:43:54.923 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ResourceId], [g].[PermissionId], [g].[GroupId], [g].[GranteeType], [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [GrantedGroupPermissions] AS [g]
INNER JOIN [Resource] AS [r] ON [g].[ResourceId] = [r].[Id]
2022-02-17 16:43:54.979 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ResourceId], [r].[Name], [g].[PermissionId], [r].[ResourceTypeId]
FROM [GrantedUserPermissions] AS [g]
INNER JOIN [Resource] AS [r] ON [g].[ResourceId] = [r].[Id]
WHERE [g].[UserId] = @__userId_0
2022-02-17 16:43:55.037 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[ResourceTypeId] = N'Volume'
2022-02-17 16:43:55.044 -08:00 [INF] Executed action method IdentityServer.Controllers.PermissionsController.UserAccessibleVolumes (IdentityServer), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 9399.7589ms.
2022-02-17 16:43:55.049 -08:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.Dictionary`2[[System.Int64, System.Private.CoreLib, Version=5.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=5.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-02-17 16:43:55.062 -08:00 [INF] Executed action IdentityServer.Controllers.PermissionsController.UserAccessibleVolumes (IdentityServer) in 9472.9446ms
2022-02-17 16:43:55.064 -08:00 [INF] Executed endpoint 'IdentityServer.Controllers.PermissionsController.UserAccessibleVolumes (IdentityServer)'
2022-02-17 16:43:55.064 -08:00 [INF] HTTP GET /api/permissions responded 200 in 10097.6020 ms
2022-02-17 16:43:55.066 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions - - - 200 - application/json;+charset=utf-8 10100.1762ms
2022-02-17 16:43:59.857 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/Permissions/RC1 - -
2022-02-17 16:43:59.860 -08:00 [INF] HTTP GET /api/Permissions/RC1 responded 404 in 2.1876 ms
2022-02-17 16:43:59.861 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/Permissions/RC1 - - - 404 0 - 4.0216ms
2022-02-17 16:44:09.359 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:44:09.424 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:44:09.427 -08:00 [INF] Removing 0 grants
2022-02-17 16:44:09.484 -08:00 [INF] Executed DbCommand (52ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:44:09.488 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:44:23.184 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:44:23.772 -08:00 [INF] Executed DbCommand (58ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:44:23.836 -08:00 [INF] Executed DbCommand (52ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:44:23.887 -08:00 [INF] Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:44:23.934 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:44:23.986 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:44:24.001 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:44:24.197 -08:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2022-02-17 16:44:24.243 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:44:24.534 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:44:24.580 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:44:24.628 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:44:24.674 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:44:24.721 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:44:24.724 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:44:24.897 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[Name] = N'Administrator'
2022-02-17 16:44:24.919 -08:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2022-02-17 16:44:24.927 -08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2022-02-17 16:44:25.018 -08:00 [INF] User profile is available. Using 'C:\Users\u0490822\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2022-02-17 16:44:27.632 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:44:27.660 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:44:27.671 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:44:27.798 -08:00 [INF] Executed DbCommand (51ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:44:27.870 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 232.0272 ms
2022-02-17 16:44:27.875 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 246.1772ms
2022-02-17 16:44:27.920 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:44:27.923 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:44:27.955 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 33.5141 ms
2022-02-17 16:44:27.961 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 40.8537ms
2022-02-17 16:44:28.033 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:44:28.048 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:44:28.082 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:44:28.130 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:44:28.149 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIEV8K324O:00000002","TimeStamp":"2022-02-18T00:44:28.0000000Z","ProcessId":29644,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:44:28.262 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:44:28.343 -08:00 [INF] Executed DbCommand (53ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:44:28.390 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:44:28.452 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:44:28.499 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:44:28.510 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIEV8K324O:00000002","TimeStamp":"2022-02-18T00:44:28.0000000Z","ProcessId":29644,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:44:28.580 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:44:28.587 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:44:28.664 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:44:28.727 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:44:28.781 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:44:28.832 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:44:28.929 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****cdPw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIEV8K324O:00000002","TimeStamp":"2022-02-18T00:44:28.0000000Z","ProcessId":29644,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:44:28.944 -08:00 [INF] HTTP POST /connect/token responded 200 in 909.9293 ms
2022-02-17 16:44:28.945 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 911.7656ms
2022-02-17 16:44:28.954 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:44:28.955 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:44:29.000 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:44:29.053 -08:00 [INF] Executed DbCommand (51ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:44:29.110 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:44:29.164 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:44:29.212 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:44:29.260 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:44:29.309 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:44:29.312 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:44:29.314 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 359.9065 ms
2022-02-17 16:44:29.315 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 361.7191ms
2022-02-17 16:44:30.656 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions - -
2022-02-17 16:44:30.678 -08:00 [INF] HTTP GET /api/permissions responded 404 in 21.2370 ms
2022-02-17 16:44:30.680 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions - - - 404 0 - 23.4370ms
2022-02-17 16:44:53.404 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:44:53.990 -08:00 [INF] Executed DbCommand (54ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:44:54.051 -08:00 [INF] Executed DbCommand (51ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:44:54.098 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:44:54.144 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:44:54.196 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:44:54.213 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:44:54.412 -08:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2022-02-17 16:44:54.457 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:44:54.735 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:44:54.781 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:44:54.827 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:44:54.872 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:44:54.919 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:44:54.923 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:44:55.100 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[Name] = N'Administrator'
2022-02-17 16:44:55.124 -08:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2022-02-17 16:44:55.132 -08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2022-02-17 16:44:55.226 -08:00 [INF] User profile is available. Using 'C:\Users\u0490822\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2022-02-17 16:44:59.163 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:44:59.188 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:44:59.199 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:44:59.328 -08:00 [INF] Executed DbCommand (53ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:44:59.409 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 241.5137 ms
2022-02-17 16:44:59.414 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 252.8895ms
2022-02-17 16:44:59.470 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:44:59.473 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:44:59.504 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 33.0067 ms
2022-02-17 16:44:59.515 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 45.6284ms
2022-02-17 16:44:59.588 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:44:59.603 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:44:59.641 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:44:59.691 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:44:59.710 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIEVI11D55:00000002","TimeStamp":"2022-02-18T00:44:59.0000000Z","ProcessId":7092,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:44:59.809 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:44:59.888 -08:00 [INF] Executed DbCommand (54ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:44:59.936 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:45:00.001 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:45:00.049 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:45:00.063 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIEVI11D55:00000002","TimeStamp":"2022-02-18T00:45:00.0000000Z","ProcessId":7092,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:45:00.132 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:45:00.138 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:45:00.212 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:45:00.272 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:45:00.325 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:45:00.375 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:45:00.476 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****Z1tg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIEVI11D55:00000002","TimeStamp":"2022-02-18T00:45:00.0000000Z","ProcessId":7092,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:45:00.491 -08:00 [INF] HTTP POST /connect/token responded 200 in 902.4259 ms
2022-02-17 16:45:00.492 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 904.5136ms
2022-02-17 16:45:00.500 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:45:00.501 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:45:00.546 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:45:00.593 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:45:00.650 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:45:00.709 -08:00 [INF] Executed DbCommand (49ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:45:00.756 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:45:00.803 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:45:00.851 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:45:00.854 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:45:00.856 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 355.3451 ms
2022-02-17 16:45:00.857 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 356.8199ms
2022-02-17 16:45:01.998 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions - -
2022-02-17 16:45:02.143 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:45:02.144 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:45:02.145 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:45:02.192 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:45:02.195 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 51.5298 ms
2022-02-17 16:45:02.196 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 53.2282ms
2022-02-17 16:45:02.270 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:45:02.271 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:45:02.272 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 1.3531 ms
2022-02-17 16:45:02.283 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 13.1960ms
2022-02-17 16:45:02.298 -08:00 [INF] Successfully validated the token.
2022-02-17 16:45:02.314 -08:00 [INF] Start processing HTTP request GET "https://localhost:5001/.well-known/openid-configuration"
2022-02-17 16:45:02.315 -08:00 [INF] Sending HTTP request GET "https://localhost:5001/.well-known/openid-configuration"
2022-02-17 16:45:02.333 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:45:02.338 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:45:02.339 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:45:02.385 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:45:02.388 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 54.8474 ms
2022-02-17 16:45:02.400 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 67.8279ms
2022-02-17 16:45:02.403 -08:00 [INF] Received HTTP response headers after 85.5619ms - 200
2022-02-17 16:45:02.405 -08:00 [INF] End processing HTTP request after 93.3196ms - 200
2022-02-17 16:45:02.412 -08:00 [INF] Start processing HTTP request GET "https://localhost:5001/.well-known/openid-configuration/jwks"
2022-02-17 16:45:02.413 -08:00 [INF] Sending HTTP request GET "https://localhost:5001/.well-known/openid-configuration/jwks"
2022-02-17 16:45:02.434 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:45:02.436 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:45:02.438 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 3.0773 ms
2022-02-17 16:45:02.449 -08:00 [INF] Received HTTP response headers after 36.082ms - 200
2022-02-17 16:45:02.450 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 15.3452ms
2022-02-17 16:45:02.450 -08:00 [INF] End processing HTTP request after 38.0678ms - 200
2022-02-17 16:45:02.461 -08:00 [INF] Start processing HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:45:02.462 -08:00 [INF] Sending HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:45:02.486 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161
2022-02-17 16:45:02.488 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2022-02-17 16:45:02.493 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:45:02.548 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:45:02.551 -08:00 [INF] {"ApiName":"mvc","Category":"Authentication","Name":"API Authentication Failure","EventType":"Failure","Id":1021,"Message":"Unknown API resource","ActivityId":"0HMFIEVI11D58:00000004","TimeStamp":"2022-02-18T00:45:02.0000000Z","ProcessId":7092,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ApiAuthenticationFailureEvent"}
2022-02-17 16:45:02.556 -08:00 [ERR] No API resource with that name found. aborting
2022-02-17 16:45:02.557 -08:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2022-02-17 16:45:02.558 -08:00 [INF] HTTP POST /connect/introspect responded 401 in 70.2790 ms
2022-02-17 16:45:02.559 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161 - 401 0 - 72.3316ms
2022-02-17 16:45:02.568 -08:00 [INF] Received HTTP response headers after 106.8457ms - 401
2022-02-17 16:45:02.569 -08:00 [INF] End processing HTTP request after 108.1351ms - 401
2022-02-17 16:45:02.573 -08:00 [ERR] Error returned from introspection endpoint: Unauthorized
2022-02-17 16:45:02.574 -08:00 [INF] Introspection was not authenticated. Failure message: Error returned from introspection endpoint: Unauthorized
2022-02-17 16:45:02.579 -08:00 [INF] Authorization was successful.
2022-02-17 16:45:02.581 -08:00 [INF] Executing endpoint 'IdentityServer.Controllers.PermissionsController.GetApplicationUser (IdentityServer)'
2022-02-17 16:45:02.592 -08:00 [INF] Route matched with {action = "GetApplicationUser", controller = "Permissions"}. Executing controller action with signature System.Threading.Tasks.Task`1[IdentityServer.Models.ApplicationUser] GetApplicationUser() on controller IdentityServer.Controllers.PermissionsController (IdentityServer).
2022-02-17 16:45:02.644 -08:00 [INF] Executing action method IdentityServer.Controllers.PermissionsController.GetApplicationUser (IdentityServer) - Validation state: "Valid"
2022-02-17 16:45:04.179 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:45:04.230 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__username_0='jamesan' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[UserName] = @__username_0
2022-02-17 16:45:04.239 -08:00 [INF] Executed action method IdentityServer.Controllers.PermissionsController.GetApplicationUser (IdentityServer), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 1588.5004ms.
2022-02-17 16:45:04.249 -08:00 [INF] Executing ObjectResult, writing value of type 'IdentityServer.Models.ApplicationUser'.
2022-02-17 16:45:04.264 -08:00 [INF] Executed action IdentityServer.Controllers.PermissionsController.GetApplicationUser (IdentityServer) in 1667.3027ms
2022-02-17 16:45:04.271 -08:00 [INF] Executed endpoint 'IdentityServer.Controllers.PermissionsController.GetApplicationUser (IdentityServer)'
2022-02-17 16:45:04.272 -08:00 [INF] HTTP GET /api/permissions responded 200 in 2274.0061 ms
2022-02-17 16:45:04.273 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions - - - 200 - application/json;+charset=utf-8 2275.8825ms
2022-02-17 16:45:09.234 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/Permissions/RC1 - -
2022-02-17 16:45:09.237 -08:00 [INF] HTTP GET /api/Permissions/RC1 responded 404 in 2.2967 ms
2022-02-17 16:45:09.238 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/Permissions/RC1 - - - 404 0 - 4.0818ms
2022-02-17 16:45:25.272 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:45:25.328 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:45:25.331 -08:00 [INF] Removing 0 grants
2022-02-17 16:45:25.380 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:45:25.382 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:45:55.425 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:45:55.471 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:45:55.473 -08:00 [INF] Removing 0 grants
2022-02-17 16:45:55.517 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:45:55.519 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:46:25.514 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:46:25.572 -08:00 [INF] Executed DbCommand (55ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:46:25.595 -08:00 [INF] Removing 0 grants
2022-02-17 16:46:25.642 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:46:25.643 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:46:39.555 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:46:40.126 -08:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:46:40.189 -08:00 [INF] Executed DbCommand (53ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:46:40.238 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:46:40.286 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:46:40.340 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:46:40.355 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:46:40.551 -08:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2022-02-17 16:46:40.596 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:46:40.876 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:46:40.922 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:46:40.970 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:46:41.016 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:46:41.066 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:46:41.068 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:46:41.250 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[Name] = N'Administrator'
2022-02-17 16:46:41.274 -08:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2022-02-17 16:46:41.281 -08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2022-02-17 16:46:41.379 -08:00 [INF] User profile is available. Using 'C:\Users\u0490822\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2022-02-17 16:46:45.982 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:46:46.007 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:46:46.019 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:46:46.154 -08:00 [INF] Executed DbCommand (59ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:46:46.226 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 238.6187 ms
2022-02-17 16:46:46.231 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 249.7069ms
2022-02-17 16:46:46.276 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:46:46.278 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:46:46.309 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 32.5377 ms
2022-02-17 16:46:46.319 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 43.8705ms
2022-02-17 16:46:46.384 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:46:46.400 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:46:46.437 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:46:46.487 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:46:46.504 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIF0HRO25H:00000002","TimeStamp":"2022-02-18T00:46:46.0000000Z","ProcessId":32016,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:46:46.625 -08:00 [INF] Executed DbCommand (59ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:46:46.708 -08:00 [INF] Executed DbCommand (53ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:46:46.757 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:46:46.820 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:46:46.865 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:46:46.877 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIF0HRO25H:00000002","TimeStamp":"2022-02-18T00:46:46.0000000Z","ProcessId":32016,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:46:46.948 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:46:46.960 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:46:47.039 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:46:47.101 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:46:47.160 -08:00 [INF] Executed DbCommand (52ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:46:47.211 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:46:47.309 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****Xswg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIF0HRO25H:00000002","TimeStamp":"2022-02-18T00:46:47.0000000Z","ProcessId":32016,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:46:47.323 -08:00 [INF] HTTP POST /connect/token responded 200 in 937.5843 ms
2022-02-17 16:46:47.324 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 939.8787ms
2022-02-17 16:46:47.332 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:46:47.334 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:46:47.375 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:46:47.424 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:46:47.916 -08:00 [INF] Executed DbCommand (481ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:46:47.972 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:46:48.020 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:46:48.067 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:46:48.119 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:46:48.122 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:46:48.123 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 790.7000 ms
2022-02-17 16:46:48.124 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 792.3871ms
2022-02-17 16:46:50.098 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions - -
2022-02-17 16:46:50.240 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:46:50.241 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:46:50.242 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:46:50.331 -08:00 [INF] Executed DbCommand (87ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:46:50.335 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 93.9938 ms
2022-02-17 16:46:50.336 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 95.6861ms
2022-02-17 16:46:50.406 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:46:50.407 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:46:50.409 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 1.4453 ms
2022-02-17 16:46:50.419 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 12.5726ms
2022-02-17 16:46:50.433 -08:00 [INF] Successfully validated the token.
2022-02-17 16:46:50.452 -08:00 [INF] Start processing HTTP request GET "https://localhost:5001/.well-known/openid-configuration"
2022-02-17 16:46:50.453 -08:00 [INF] Sending HTTP request GET "https://localhost:5001/.well-known/openid-configuration"
2022-02-17 16:46:50.479 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:46:50.485 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:46:50.486 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:46:50.532 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:46:50.535 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 55.4291 ms
2022-02-17 16:46:50.549 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 69.8758ms
2022-02-17 16:46:50.551 -08:00 [INF] Received HTTP response headers after 95.7861ms - 200
2022-02-17 16:46:50.554 -08:00 [INF] End processing HTTP request after 105.1692ms - 200
2022-02-17 16:46:50.561 -08:00 [INF] Start processing HTTP request GET "https://localhost:5001/.well-known/openid-configuration/jwks"
2022-02-17 16:46:50.563 -08:00 [INF] Sending HTTP request GET "https://localhost:5001/.well-known/openid-configuration/jwks"
2022-02-17 16:46:50.593 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:46:50.595 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:46:50.596 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 2.2007 ms
2022-02-17 16:46:50.615 -08:00 [INF] Received HTTP response headers after 52.7403ms - 200
2022-02-17 16:46:50.617 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 23.7443ms
2022-02-17 16:46:50.617 -08:00 [INF] End processing HTTP request after 55.9027ms - 200
2022-02-17 16:46:50.630 -08:00 [INF] Start processing HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:46:50.631 -08:00 [INF] Sending HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:46:50.665 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161
2022-02-17 16:46:50.667 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2022-02-17 16:46:50.672 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:46:50.735 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:46:50.739 -08:00 [INF] {"ApiName":"mvc","Category":"Authentication","Name":"API Authentication Failure","EventType":"Failure","Id":1021,"Message":"Unknown API resource","ActivityId":"0HMFIF0HRO25K:00000004","TimeStamp":"2022-02-18T00:46:50.0000000Z","ProcessId":32016,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ApiAuthenticationFailureEvent"}
2022-02-17 16:46:50.745 -08:00 [ERR] No API resource with that name found. aborting
2022-02-17 16:46:50.746 -08:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2022-02-17 16:46:50.747 -08:00 [INF] HTTP POST /connect/introspect responded 401 in 81.3091 ms
2022-02-17 16:46:50.749 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161 - 401 0 - 83.5508ms
2022-02-17 16:46:50.766 -08:00 [INF] Received HTTP response headers after 134.4922ms - 401
2022-02-17 16:46:50.767 -08:00 [INF] End processing HTTP request after 137.4642ms - 401
2022-02-17 16:46:50.772 -08:00 [ERR] Error returned from introspection endpoint: Unauthorized
2022-02-17 16:46:50.774 -08:00 [INF] Introspection was not authenticated. Failure message: Error returned from introspection endpoint: Unauthorized
2022-02-17 16:46:50.781 -08:00 [INF] Authorization was successful.
2022-02-17 16:46:50.782 -08:00 [INF] Executing endpoint 'IdentityServer.Controllers.PermissionsController.GetApplicationUser (IdentityServer)'
2022-02-17 16:46:50.797 -08:00 [INF] Route matched with {action = "GetApplicationUser", controller = "Permissions"}. Executing controller action with signature System.Threading.Tasks.Task`1[IdentityServer.Models.ApplicationUser] GetApplicationUser() on controller IdentityServer.Controllers.PermissionsController (IdentityServer).
2022-02-17 16:46:50.861 -08:00 [INF] Executing action method IdentityServer.Controllers.PermissionsController.GetApplicationUser (IdentityServer) - Validation state: "Valid"
2022-02-17 16:46:53.269 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:46:53.321 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__username_0='jamesan' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[UserName] = @__username_0
2022-02-17 16:46:53.327 -08:00 [INF] Executed action method IdentityServer.Controllers.PermissionsController.GetApplicationUser (IdentityServer), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 2462.2366ms.
2022-02-17 16:46:53.332 -08:00 [INF] Executing ObjectResult, writing value of type 'IdentityServer.Models.ApplicationUser'.
2022-02-17 16:46:53.346 -08:00 [INF] Executed action IdentityServer.Controllers.PermissionsController.GetApplicationUser (IdentityServer) in 2544.0205ms
2022-02-17 16:46:53.348 -08:00 [INF] Executed endpoint 'IdentityServer.Controllers.PermissionsController.GetApplicationUser (IdentityServer)'
2022-02-17 16:46:53.349 -08:00 [INF] HTTP GET /api/permissions responded 200 in 3250.5707 ms
2022-02-17 16:46:53.350 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions - - - 200 - application/json;+charset=utf-8 3252.1128ms
2022-02-17 16:46:58.676 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/RC1 - -
2022-02-17 16:46:58.680 -08:00 [INF] HTTP GET /api/permissions/RC1 responded 404 in 2.2977 ms
2022-02-17 16:46:58.681 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/RC1 - - - 404 0 - 4.5282ms
2022-02-17 16:47:11.435 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:47:11.491 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:47:11.493 -08:00 [INF] Removing 0 grants
2022-02-17 16:47:11.544 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:47:11.547 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:47:19.803 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:47:19.804 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:47:19.805 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:47:19.853 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:47:19.856 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 52.5356 ms
2022-02-17 16:47:19.857 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 54.2922ms
2022-02-17 16:47:19.903 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:47:19.904 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:47:19.905 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 1.3103 ms
2022-02-17 16:47:19.906 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 2.8771ms
2022-02-17 16:47:19.979 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:47:19.980 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:47:19.984 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:47:20.038 -08:00 [INF] Executed DbCommand (53ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:47:20.041 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIF0HRO25M:00000002","TimeStamp":"2022-02-18T00:47:20.0000000Z","ProcessId":32016,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:47:20.091 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:47:20.139 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:47:20.186 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:47:20.234 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:47:20.238 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:47:20.238 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIF0HRO25M:00000002","TimeStamp":"2022-02-18T00:47:20.0000000Z","ProcessId":32016,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:47:20.290 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:47:20.293 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:47:20.345 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:47:20.390 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:47:20.440 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:47:20.487 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:47:20.492 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****Y3mA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIF0HRO25M:00000002","TimeStamp":"2022-02-18T00:47:20.0000000Z","ProcessId":32016,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:47:20.504 -08:00 [INF] HTTP POST /connect/token responded 200 in 524.3086 ms
2022-02-17 16:47:20.505 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 526.0087ms
2022-02-17 16:47:20.514 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:47:20.515 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:47:20.516 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:47:20.570 -08:00 [INF] Executed DbCommand (51ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:47:20.620 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:47:20.667 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:47:20.715 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:47:20.763 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:47:20.811 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:47:20.813 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:47:20.814 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 300.0102 ms
2022-02-17 16:47:20.816 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 301.9732ms
2022-02-17 16:47:20.823 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions - -
2022-02-17 16:47:20.824 -08:00 [INF] Successfully validated the token.
2022-02-17 16:47:20.825 -08:00 [INF] Start processing HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:47:20.826 -08:00 [INF] Sending HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:47:20.856 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161
2022-02-17 16:47:20.858 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2022-02-17 16:47:20.859 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:47:20.905 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:47:20.908 -08:00 [INF] {"ApiName":"mvc","Category":"Authentication","Name":"API Authentication Failure","EventType":"Failure","Id":1021,"Message":"Unknown API resource","ActivityId":"0HMFIF0HRO25K:00000005","TimeStamp":"2022-02-18T00:47:20.0000000Z","ProcessId":32016,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ApiAuthenticationFailureEvent"}
2022-02-17 16:47:20.914 -08:00 [ERR] No API resource with that name found. aborting
2022-02-17 16:47:20.915 -08:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2022-02-17 16:47:20.918 -08:00 [INF] HTTP POST /connect/introspect responded 401 in 60.0698 ms
2022-02-17 16:47:20.919 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161 - 401 0 - 62.9661ms
2022-02-17 16:47:20.929 -08:00 [INF] Received HTTP response headers after 103.1484ms - 401
2022-02-17 16:47:20.929 -08:00 [INF] End processing HTTP request after 104.5757ms - 401
2022-02-17 16:47:20.930 -08:00 [ERR] Error returned from introspection endpoint: Unauthorized
2022-02-17 16:47:20.931 -08:00 [INF] Introspection was not authenticated. Failure message: Error returned from introspection endpoint: Unauthorized
2022-02-17 16:47:20.933 -08:00 [INF] Authorization was successful.
2022-02-17 16:47:20.934 -08:00 [INF] Executing endpoint 'IdentityServer.Controllers.PermissionsController.GetApplicationUser (IdentityServer)'
2022-02-17 16:47:20.935 -08:00 [INF] Route matched with {action = "GetApplicationUser", controller = "Permissions"}. Executing controller action with signature System.Threading.Tasks.Task`1[IdentityServer.Models.ApplicationUser] GetApplicationUser() on controller IdentityServer.Controllers.PermissionsController (IdentityServer).
2022-02-17 16:47:20.956 -08:00 [INF] Executing action method IdentityServer.Controllers.PermissionsController.GetApplicationUser (IdentityServer) - Validation state: "Valid"
2022-02-17 16:47:20.957 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:47:21.004 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__username_0='jamesan' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[UserName] = @__username_0
2022-02-17 16:47:21.007 -08:00 [INF] Executed action method IdentityServer.Controllers.PermissionsController.GetApplicationUser (IdentityServer), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 49.7348ms.
2022-02-17 16:47:21.008 -08:00 [INF] Executing ObjectResult, writing value of type 'IdentityServer.Models.ApplicationUser'.
2022-02-17 16:47:21.009 -08:00 [INF] Executed action IdentityServer.Controllers.PermissionsController.GetApplicationUser (IdentityServer) in 72.3096ms
2022-02-17 16:47:21.010 -08:00 [INF] Executed endpoint 'IdentityServer.Controllers.PermissionsController.GetApplicationUser (IdentityServer)'
2022-02-17 16:47:21.011 -08:00 [INF] HTTP GET /api/permissions responded 200 in 188.2437 ms
2022-02-17 16:47:21.012 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions - - - 200 - application/json;+charset=utf-8 189.8439ms
2022-02-17 16:47:22.607 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/RC1 - -
2022-02-17 16:47:22.608 -08:00 [INF] HTTP GET /api/permissions/RC1 responded 404 in 0.2566 ms
2022-02-17 16:47:22.609 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/RC1 - - - 404 0 - 1.9965ms
2022-02-17 16:47:41.578 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:47:41.626 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:47:41.628 -08:00 [INF] Removing 0 grants
2022-02-17 16:47:41.677 -08:00 [INF] Executed DbCommand (49ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:47:41.679 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:47:48.550 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:47:49.130 -08:00 [INF] Executed DbCommand (57ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:47:49.193 -08:00 [INF] Executed DbCommand (53ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:47:49.242 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:47:49.291 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:47:49.342 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:47:49.358 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:47:49.558 -08:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2022-02-17 16:47:49.603 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:47:49.897 -08:00 [INF] Executed DbCommand (56ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:47:49.951 -08:00 [INF] Executed DbCommand (52ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:47:49.997 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:47:50.042 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:47:50.089 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:47:50.092 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:47:50.276 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[Name] = N'Administrator'
2022-02-17 16:47:50.298 -08:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2022-02-17 16:47:50.306 -08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2022-02-17 16:47:50.401 -08:00 [INF] User profile is available. Using 'C:\Users\u0490822\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2022-02-17 16:48:13.874 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:48:13.898 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:48:13.908 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:48:14.049 -08:00 [INF] Executed DbCommand (51ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:48:14.124 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 244.6223 ms
2022-02-17 16:48:14.128 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 255.5267ms
2022-02-17 16:48:14.193 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:48:14.196 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:48:14.221 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 27.2783 ms
2022-02-17 16:48:14.232 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 38.7477ms
2022-02-17 16:48:14.301 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:48:14.317 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:48:14.362 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:48:14.412 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:48:14.429 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIF1C207PO:00000002","TimeStamp":"2022-02-18T00:48:14.0000000Z","ProcessId":31560,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:48:14.530 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:48:14.615 -08:00 [INF] Executed DbCommand (54ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:48:14.663 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:48:14.723 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:48:14.769 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:48:14.782 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIF1C207PO:00000002","TimeStamp":"2022-02-18T00:48:14.0000000Z","ProcessId":31560,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:48:14.857 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:48:14.863 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:48:14.937 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:48:14.999 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:48:15.052 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:48:15.106 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:48:15.207 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****xcCA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIF1C207PO:00000002","TimeStamp":"2022-02-18T00:48:15.0000000Z","ProcessId":31560,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:48:15.222 -08:00 [INF] HTTP POST /connect/token responded 200 in 919.7679 ms
2022-02-17 16:48:15.223 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 921.8582ms
2022-02-17 16:48:15.231 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:48:15.233 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:48:15.272 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:48:15.319 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:48:15.375 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:48:15.429 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:48:15.480 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:48:15.530 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:48:15.581 -08:00 [INF] Executed DbCommand (49ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:48:15.585 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:48:15.587 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 354.8655 ms
2022-02-17 16:48:15.588 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 356.8587ms
2022-02-17 16:48:15.594 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions - -
2022-02-17 16:48:15.742 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:48:15.743 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:48:15.744 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:48:15.838 -08:00 [INF] Executed DbCommand (93ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:48:15.841 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 98.7306 ms
2022-02-17 16:48:15.842 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 100.3476ms
2022-02-17 16:48:15.915 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:48:15.916 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:48:15.917 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 1.3801 ms
2022-02-17 16:48:15.928 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 13.0390ms
2022-02-17 16:48:15.942 -08:00 [INF] Successfully validated the token.
2022-02-17 16:48:15.958 -08:00 [INF] Start processing HTTP request GET "https://localhost:5001/.well-known/openid-configuration"
2022-02-17 16:48:15.959 -08:00 [INF] Sending HTTP request GET "https://localhost:5001/.well-known/openid-configuration"
2022-02-17 16:48:15.977 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:48:15.983 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:48:15.984 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:48:16.037 -08:00 [INF] Executed DbCommand (51ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:48:16.040 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 62.2118 ms
2022-02-17 16:48:16.052 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 75.3740ms
2022-02-17 16:48:16.055 -08:00 [INF] Received HTTP response headers after 93.2962ms - 200
2022-02-17 16:48:16.056 -08:00 [INF] End processing HTTP request after 100.262ms - 200
2022-02-17 16:48:16.062 -08:00 [INF] Start processing HTTP request GET "https://localhost:5001/.well-known/openid-configuration/jwks"
2022-02-17 16:48:16.063 -08:00 [INF] Sending HTTP request GET "https://localhost:5001/.well-known/openid-configuration/jwks"
2022-02-17 16:48:16.086 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:48:16.087 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:48:16.088 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 2.1480 ms
2022-02-17 16:48:16.098 -08:00 [INF] Received HTTP response headers after 35.1967ms - 200
2022-02-17 16:48:16.099 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 13.0661ms
2022-02-17 16:48:16.099 -08:00 [INF] End processing HTTP request after 36.9467ms - 200
2022-02-17 16:48:16.109 -08:00 [INF] Start processing HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:48:16.110 -08:00 [INF] Sending HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:48:16.138 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161
2022-02-17 16:48:16.139 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2022-02-17 16:48:16.144 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:48:16.202 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:48:16.205 -08:00 [INF] {"ApiName":"mvc","Category":"Authentication","Name":"API Authentication Failure","EventType":"Failure","Id":1021,"Message":"Unknown API resource","ActivityId":"0HMFIF1C207PR:00000004","TimeStamp":"2022-02-18T00:48:16.0000000Z","ProcessId":31560,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ApiAuthenticationFailureEvent"}
2022-02-17 16:48:16.210 -08:00 [ERR] No API resource with that name found. aborting
2022-02-17 16:48:16.211 -08:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2022-02-17 16:48:16.212 -08:00 [INF] HTTP POST /connect/introspect responded 401 in 73.4083 ms
2022-02-17 16:48:16.213 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161 - 401 0 - 75.0736ms
2022-02-17 16:48:16.224 -08:00 [INF] Received HTTP response headers after 113.8459ms - 401
2022-02-17 16:48:16.225 -08:00 [INF] End processing HTTP request after 115.1981ms - 401
2022-02-17 16:48:16.228 -08:00 [ERR] Error returned from introspection endpoint: Unauthorized
2022-02-17 16:48:16.230 -08:00 [INF] Introspection was not authenticated. Failure message: Error returned from introspection endpoint: Unauthorized
2022-02-17 16:48:16.234 -08:00 [INF] Authorization was successful.
2022-02-17 16:48:16.235 -08:00 [INF] Executing endpoint 'IdentityServer.Controllers.PermissionsController.GetApplicationUser (IdentityServer)'
2022-02-17 16:48:16.248 -08:00 [INF] Route matched with {action = "GetApplicationUser", controller = "Permissions"}. Executing controller action with signature System.Threading.Tasks.Task`1[IdentityServer.Models.ApplicationUser] GetApplicationUser() on controller IdentityServer.Controllers.PermissionsController (IdentityServer).
2022-02-17 16:48:16.302 -08:00 [INF] Executing action method IdentityServer.Controllers.PermissionsController.GetApplicationUser (IdentityServer) - Validation state: "Valid"
2022-02-17 16:48:16.305 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:48:16.363 -08:00 [INF] Executed DbCommand (53ms) [Parameters=[@__username_0='jamesan' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[UserName] = @__username_0
2022-02-17 16:48:16.372 -08:00 [INF] Executed action method IdentityServer.Controllers.PermissionsController.GetApplicationUser (IdentityServer), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 65.603ms.
2022-02-17 16:48:16.377 -08:00 [INF] Executing ObjectResult, writing value of type 'IdentityServer.Models.ApplicationUser'.
2022-02-17 16:48:16.399 -08:00 [INF] Executed action IdentityServer.Controllers.PermissionsController.GetApplicationUser (IdentityServer) in 146.616ms
2022-02-17 16:48:16.402 -08:00 [INF] Executed endpoint 'IdentityServer.Controllers.PermissionsController.GetApplicationUser (IdentityServer)'
2022-02-17 16:48:16.403 -08:00 [INF] HTTP GET /api/permissions responded 200 in 807.8684 ms
2022-02-17 16:48:16.404 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions - - - 200 - application/json;+charset=utf-8 809.5078ms
2022-02-17 16:48:20.446 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:48:20.505 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:48:20.509 -08:00 [INF] Removing 0 grants
2022-02-17 16:48:20.557 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:48:20.560 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:48:25.932 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/RC1 - -
2022-02-17 16:48:25.935 -08:00 [INF] HTTP GET /api/permissions/RC1 responded 404 in 2.0156 ms
2022-02-17 16:48:25.936 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/RC1 - - - 404 0 - 3.6501ms
2022-02-17 16:48:50.587 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:48:50.634 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:48:50.639 -08:00 [INF] Removing 0 grants
2022-02-17 16:48:50.684 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:48:50.687 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:49:20.681 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:49:20.729 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:49:20.745 -08:00 [INF] Removing 0 grants
2022-02-17 16:49:20.797 -08:00 [INF] Executed DbCommand (51ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:49:20.798 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:49:50.807 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:49:50.856 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:49:50.858 -08:00 [INF] Removing 0 grants
2022-02-17 16:49:50.903 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:49:50.904 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:50:20.904 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:50:20.951 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:50:20.953 -08:00 [INF] Removing 0 grants
2022-02-17 16:50:21.005 -08:00 [INF] Executed DbCommand (50ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:50:21.013 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:50:51.027 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:50:51.072 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:50:51.076 -08:00 [INF] Removing 0 grants
2022-02-17 16:50:51.120 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:50:51.122 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:50:57.273 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:50:57.960 -08:00 [INF] Executed DbCommand (58ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:50:58.023 -08:00 [INF] Executed DbCommand (53ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:50:58.071 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:50:58.117 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:50:58.169 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:50:58.184 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:50:58.380 -08:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2022-02-17 16:50:58.423 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:50:58.703 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:50:58.749 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:50:58.798 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:50:58.844 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:50:58.892 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:50:58.895 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:50:59.073 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[Name] = N'Administrator'
2022-02-17 16:50:59.098 -08:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2022-02-17 16:50:59.106 -08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2022-02-17 16:50:59.203 -08:00 [INF] User profile is available. Using 'C:\Users\u0490822\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2022-02-17 16:51:02.114 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:51:02.139 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:51:02.149 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:51:02.277 -08:00 [INF] Executed DbCommand (51ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:51:02.349 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 229.7519 ms
2022-02-17 16:51:02.354 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 241.4113ms
2022-02-17 16:51:02.398 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:51:02.401 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:51:02.438 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 38.1176 ms
2022-02-17 16:51:02.439 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 40.6829ms
2022-02-17 16:51:02.507 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:51:02.522 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:51:02.560 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:51:02.610 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:51:02.628 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIF2U68S6M:00000002","TimeStamp":"2022-02-18T00:51:02.0000000Z","ProcessId":5344,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:51:02.735 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:51:02.825 -08:00 [INF] Executed DbCommand (62ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:51:02.875 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:51:02.939 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:51:02.991 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:51:03.003 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIF2U68S6M:00000002","TimeStamp":"2022-02-18T00:51:03.0000000Z","ProcessId":5344,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:51:03.072 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:51:03.080 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:51:03.157 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:51:03.218 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:51:03.269 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:51:03.321 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:51:03.418 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****PuMQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIF2U68S6M:00000002","TimeStamp":"2022-02-18T00:51:03.0000000Z","ProcessId":5344,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:51:03.432 -08:00 [INF] HTTP POST /connect/token responded 200 in 924.3995 ms
2022-02-17 16:51:03.433 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 926.3615ms
2022-02-17 16:51:03.441 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:51:03.443 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:51:03.483 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:51:03.533 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:51:03.589 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:51:03.643 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:51:03.693 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:51:03.739 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:51:03.788 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:51:03.791 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:51:03.792 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 350.5028 ms
2022-02-17 16:51:03.794 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 352.6164ms
2022-02-17 16:51:03.800 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/CurrentUser - -
2022-02-17 16:51:03.944 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:51:03.946 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:51:03.947 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:51:03.994 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:51:03.997 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 51.6399 ms
2022-02-17 16:51:03.998 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 53.5449ms
2022-02-17 16:51:04.078 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:51:04.079 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:51:04.080 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 1.4499 ms
2022-02-17 16:51:04.091 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 12.7470ms
2022-02-17 16:51:04.106 -08:00 [INF] Successfully validated the token.
2022-02-17 16:51:04.123 -08:00 [INF] Start processing HTTP request GET "https://localhost:5001/.well-known/openid-configuration"
2022-02-17 16:51:04.124 -08:00 [INF] Sending HTTP request GET "https://localhost:5001/.well-known/openid-configuration"
2022-02-17 16:51:04.142 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:51:04.148 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:51:04.149 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:51:04.195 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:51:04.198 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 55.3822 ms
2022-02-17 16:51:04.211 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 68.9041ms
2022-02-17 16:51:04.213 -08:00 [INF] Received HTTP response headers after 86.7403ms - 200
2022-02-17 16:51:04.214 -08:00 [INF] End processing HTTP request after 93.7978ms - 200
2022-02-17 16:51:04.221 -08:00 [INF] Start processing HTTP request GET "https://localhost:5001/.well-known/openid-configuration/jwks"
2022-02-17 16:51:04.221 -08:00 [INF] Sending HTTP request GET "https://localhost:5001/.well-known/openid-configuration/jwks"
2022-02-17 16:51:04.243 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:51:04.245 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:51:04.246 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 2.2527 ms
2022-02-17 16:51:04.256 -08:00 [INF] Received HTTP response headers after 34.3502ms - 200
2022-02-17 16:51:04.256 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 13.4575ms
2022-02-17 16:51:04.257 -08:00 [INF] End processing HTTP request after 36.8901ms - 200
2022-02-17 16:51:04.268 -08:00 [INF] Start processing HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:51:04.268 -08:00 [INF] Sending HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:51:04.295 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161
2022-02-17 16:51:04.296 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2022-02-17 16:51:04.301 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:51:04.356 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:51:04.359 -08:00 [INF] {"ApiName":"mvc","Category":"Authentication","Name":"API Authentication Failure","EventType":"Failure","Id":1021,"Message":"Unknown API resource","ActivityId":"0HMFIF2U68S6P:00000004","TimeStamp":"2022-02-18T00:51:04.0000000Z","ProcessId":5344,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ApiAuthenticationFailureEvent"}
2022-02-17 16:51:04.363 -08:00 [ERR] No API resource with that name found. aborting
2022-02-17 16:51:04.364 -08:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2022-02-17 16:51:04.366 -08:00 [INF] HTTP POST /connect/introspect responded 401 in 69.9001 ms
2022-02-17 16:51:04.368 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161 - 401 0 - 72.9516ms
2022-02-17 16:51:04.378 -08:00 [INF] Received HTTP response headers after 109.5253ms - 401
2022-02-17 16:51:04.379 -08:00 [INF] End processing HTTP request after 111.0388ms - 401
2022-02-17 16:51:04.382 -08:00 [ERR] Error returned from introspection endpoint: Unauthorized
2022-02-17 16:51:04.384 -08:00 [INF] Introspection was not authenticated. Failure message: Error returned from introspection endpoint: Unauthorized
2022-02-17 16:51:04.389 -08:00 [INF] Authorization was successful.
2022-02-17 16:51:04.390 -08:00 [INF] Executing endpoint 'IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer)'
2022-02-17 16:51:04.401 -08:00 [INF] Route matched with {action = "GetUsername", controller = "Permissions"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] GetUsername() on controller IdentityServer.Controllers.PermissionsController (IdentityServer).
2022-02-17 16:51:04.452 -08:00 [INF] Executing action method IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer) - Validation state: "Valid"
2022-02-17 16:51:04.457 -08:00 [INF] Executed action method IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 1.1236ms.
2022-02-17 16:51:04.461 -08:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2022-02-17 16:51:04.468 -08:00 [INF] Executed action IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer) in 63.5229ms
2022-02-17 16:51:04.469 -08:00 [INF] Executed endpoint 'IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer)'
2022-02-17 16:51:04.470 -08:00 [INF] HTTP GET /api/permissions/CurrentUser responded 200 in 668.7353 ms
2022-02-17 16:51:04.471 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/CurrentUser - - - 200 - application/json;+charset=utf-8 670.2253ms
2022-02-17 16:51:14.243 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/RC1 - -
2022-02-17 16:51:14.246 -08:00 [INF] HTTP GET /api/permissions/RC1 responded 404 in 1.9521 ms
2022-02-17 16:51:14.247 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/RC1 - - - 404 0 - 3.6324ms
2022-02-17 16:51:29.230 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:51:29.288 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:51:29.294 -08:00 [INF] Removing 0 grants
2022-02-17 16:51:29.346 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:51:29.349 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:51:42.730 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:51:43.324 -08:00 [INF] Executed DbCommand (57ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:51:43.389 -08:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:51:43.436 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:51:43.483 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:51:43.534 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:51:43.549 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:51:43.761 -08:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2022-02-17 16:51:43.806 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:51:44.085 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:51:44.135 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:51:44.181 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2022-02-17 16:51:44.229 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2022-02-17 16:51:44.276 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2022-02-17 16:51:44.279 -08:00 [INF] No migrations were applied. The database is already up to date.
2022-02-17 16:51:44.462 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[Name] = N'Administrator'
2022-02-17 16:51:44.487 -08:00 [INF] Starting IdentityServer4 version 4.1.2+997a6cdd643e46cd5762b710c4ddc43574cbec2e
2022-02-17 16:51:44.494 -08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2022-02-17 16:51:44.591 -08:00 [INF] User profile is available. Using 'C:\Users\u0490822\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2022-02-17 16:51:44.844 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:51:44.868 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:51:44.878 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:51:45.003 -08:00 [INF] Executed DbCommand (51ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:51:45.070 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 220.5617 ms
2022-02-17 16:51:45.073 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 230.7654ms
2022-02-17 16:51:45.119 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:51:45.122 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:51:45.149 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 29.1619 ms
2022-02-17 16:51:45.160 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 41.0291ms
2022-02-17 16:51:45.227 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:51:45.244 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:51:45.284 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:51:45.338 -08:00 [INF] Executed DbCommand (50ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:51:45.366 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIF3ATTK5A:00000002","TimeStamp":"2022-02-18T00:51:45.0000000Z","ProcessId":31080,"LocalIpAddress":"127.0.0.1:5001","RemoteIpAddress":"127.0.0.1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:51:45.496 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:51:45.608 -08:00 [INF] Executed DbCommand (69ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:51:45.659 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:51:45.732 -08:00 [INF] Executed DbCommand (50ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:51:45.805 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:51:45.833 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIF3ATTK5A:00000002","TimeStamp":"2022-02-18T00:51:45.0000000Z","ProcessId":31080,"LocalIpAddress":"127.0.0.1:5001","RemoteIpAddress":"127.0.0.1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:51:45.912 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:51:45.920 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:51:46.031 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:51:46.128 -08:00 [INF] Executed DbCommand (59ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:51:46.210 -08:00 [INF] Executed DbCommand (62ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:51:46.265 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:51:46.467 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****rj9w","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIF3ATTK5A:00000002","TimeStamp":"2022-02-18T00:51:46.0000000Z","ProcessId":31080,"LocalIpAddress":"127.0.0.1:5001","RemoteIpAddress":"127.0.0.1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:51:46.535 -08:00 [INF] HTTP POST /connect/token responded 200 in 1307.4643 ms
2022-02-17 16:51:46.550 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 1323.7902ms
2022-02-17 16:51:46.560 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:51:46.561 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:51:46.626 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:51:46.674 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:51:46.738 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:51:46.794 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:51:46.843 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:51:46.890 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:51:46.938 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:51:46.941 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:51:46.943 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 383.0074 ms
2022-02-17 16:51:46.945 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 385.1687ms
2022-02-17 16:51:46.953 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/CurrentUser - -
2022-02-17 16:51:47.113 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:51:47.114 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:51:47.115 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:51:47.161 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:51:47.164 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 50.3327 ms
2022-02-17 16:51:47.165 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 52.0252ms
2022-02-17 16:51:47.240 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:51:47.241 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:51:47.242 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 1.4716 ms
2022-02-17 16:51:47.253 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 13.0940ms
2022-02-17 16:51:47.268 -08:00 [INF] Successfully validated the token.
2022-02-17 16:51:47.283 -08:00 [INF] Start processing HTTP request GET "https://localhost:5001/.well-known/openid-configuration"
2022-02-17 16:51:47.285 -08:00 [INF] Sending HTTP request GET "https://localhost:5001/.well-known/openid-configuration"
2022-02-17 16:51:47.303 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:51:47.310 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:51:47.311 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:51:47.361 -08:00 [INF] Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:51:47.364 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 60.6498 ms
2022-02-17 16:51:47.377 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 73.5149ms
2022-02-17 16:51:47.379 -08:00 [INF] Received HTTP response headers after 91.9358ms - 200
2022-02-17 16:51:47.380 -08:00 [INF] End processing HTTP request after 99.0199ms - 200
2022-02-17 16:51:47.387 -08:00 [INF] Start processing HTTP request GET "https://localhost:5001/.well-known/openid-configuration/jwks"
2022-02-17 16:51:47.387 -08:00 [INF] Sending HTTP request GET "https://localhost:5001/.well-known/openid-configuration/jwks"
2022-02-17 16:51:47.410 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:51:47.412 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:51:47.413 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 2.1377 ms
2022-02-17 16:51:47.422 -08:00 [INF] Received HTTP response headers after 34.7339ms - 200
2022-02-17 16:51:47.423 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 12.9831ms
2022-02-17 16:51:47.423 -08:00 [INF] End processing HTTP request after 36.7733ms - 200
2022-02-17 16:51:47.434 -08:00 [INF] Start processing HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:51:47.435 -08:00 [INF] Sending HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:51:47.463 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161
2022-02-17 16:51:47.464 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2022-02-17 16:51:47.469 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:51:47.524 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:51:47.527 -08:00 [INF] {"ApiName":"mvc","Category":"Authentication","Name":"API Authentication Failure","EventType":"Failure","Id":1021,"Message":"Unknown API resource","ActivityId":"0HMFIF3ATTK5D:00000004","TimeStamp":"2022-02-18T00:51:47.0000000Z","ProcessId":31080,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ApiAuthenticationFailureEvent"}
2022-02-17 16:51:47.531 -08:00 [ERR] No API resource with that name found. aborting
2022-02-17 16:51:47.533 -08:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2022-02-17 16:51:47.533 -08:00 [INF] HTTP POST /connect/introspect responded 401 in 70.0508 ms
2022-02-17 16:51:47.534 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161 - 401 0 - 71.6696ms
2022-02-17 16:51:47.545 -08:00 [INF] Received HTTP response headers after 110.3726ms - 401
2022-02-17 16:51:47.546 -08:00 [INF] End processing HTTP request after 111.6524ms - 401
2022-02-17 16:51:47.549 -08:00 [ERR] Error returned from introspection endpoint: Unauthorized
2022-02-17 16:51:47.551 -08:00 [INF] Introspection was not authenticated. Failure message: Error returned from introspection endpoint: Unauthorized
2022-02-17 16:51:47.555 -08:00 [INF] Authorization was successful.
2022-02-17 16:51:47.556 -08:00 [INF] Executing endpoint 'IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer)'
2022-02-17 16:51:47.568 -08:00 [INF] Route matched with {action = "GetUsername", controller = "Permissions"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] GetUsername() on controller IdentityServer.Controllers.PermissionsController (IdentityServer).
2022-02-17 16:51:47.623 -08:00 [INF] Executing action method IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer) - Validation state: "Valid"
2022-02-17 16:51:47.628 -08:00 [INF] Executed action method IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 1.1112ms.
2022-02-17 16:51:47.632 -08:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2022-02-17 16:51:47.639 -08:00 [INF] Executed action IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer) in 66.9509ms
2022-02-17 16:51:47.639 -08:00 [INF] Executed endpoint 'IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer)'
2022-02-17 16:51:47.640 -08:00 [INF] HTTP GET /api/permissions/CurrentUser responded 200 in 686.7656 ms
2022-02-17 16:51:47.643 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/CurrentUser - - - 200 - application/json;+charset=utf-8 689.9992ms
2022-02-17 16:51:47.644 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/RC1 - -
2022-02-17 16:51:47.647 -08:00 [INF] Successfully validated the token.
2022-02-17 16:51:47.647 -08:00 [INF] Start processing HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:51:47.648 -08:00 [INF] Sending HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:51:47.694 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161
2022-02-17 16:51:47.696 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2022-02-17 16:51:47.697 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:51:47.745 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:51:47.747 -08:00 [INF] {"ApiName":"mvc","Category":"Authentication","Name":"API Authentication Failure","EventType":"Failure","Id":1021,"Message":"Unknown API resource","ActivityId":"0HMFIF3ATTK5D:00000005","TimeStamp":"2022-02-18T00:51:47.0000000Z","ProcessId":31080,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ApiAuthenticationFailureEvent"}
2022-02-17 16:51:47.752 -08:00 [ERR] No API resource with that name found. aborting
2022-02-17 16:51:47.753 -08:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2022-02-17 16:51:47.754 -08:00 [INF] HTTP POST /connect/introspect responded 401 in 58.4332 ms
2022-02-17 16:51:47.755 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161 - 401 0 - 61.2192ms
2022-02-17 16:51:47.765 -08:00 [INF] Received HTTP response headers after 116.808ms - 401
2022-02-17 16:51:47.766 -08:00 [INF] End processing HTTP request after 118.77ms - 401
2022-02-17 16:51:47.767 -08:00 [ERR] Error returned from introspection endpoint: Unauthorized
2022-02-17 16:51:47.769 -08:00 [INF] Introspection was not authenticated. Failure message: Error returned from introspection endpoint: Unauthorized
2022-02-17 16:51:47.770 -08:00 [INF] Authorization was successful.
2022-02-17 16:51:47.771 -08:00 [INF] Executing endpoint 'IdentityServer.Controllers.PermissionsController.UserPermissions (IdentityServer)'
2022-02-17 16:51:47.780 -08:00 [INF] Route matched with {action = "UserPermissions", controller = "Permissions"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.Dictionary`2[System.Int64,System.Object]] UserPermissions(System.String) on controller IdentityServer.Controllers.PermissionsController (IdentityServer).
2022-02-17 16:51:47.809 -08:00 [INF] Executing action method IdentityServer.Controllers.PermissionsController.UserPermissions (IdentityServer) - Validation state: "Valid"
2022-02-17 16:51:55.591 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:51:55.642 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__username_0='jamesan' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[UserName] = @__username_0
2022-02-17 16:51:55.706 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[GroupId], [u].[UserId], [t].[Id], [t].[Description], [t].[Name], [t].[ParentID], [t].[ResourceTypeId], [g].[ContainerGroupId], [g].[MemberGroupId]
FROM [UserToGroupAssignments] AS [u]
INNER JOIN (
    SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId]
    FROM [Resource] AS [r]
    WHERE [r].[ResourceTypeId] = N'Group'
) AS [t] ON [u].[GroupId] = [t].[Id]
LEFT JOIN [GroupToGroupAssignments] AS [g] ON [t].[Id] = [g].[MemberGroupId]
WHERE [u].[UserId] = @__userId_0
ORDER BY [u].[GroupId], [u].[UserId], [t].[Id], [g].[ContainerGroupId], [g].[MemberGroupId]
2022-02-17 16:51:55.773 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__groupId_0='1'], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ContainerGroupId], [g].[MemberGroupId], [t].[Id], [t].[Description], [t].[Name], [t].[ParentID], [t].[ResourceTypeId], [g0].[ContainerGroupId], [g0].[MemberGroupId]
FROM [GroupToGroupAssignments] AS [g]
INNER JOIN (
    SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId]
    FROM [Resource] AS [r]
    WHERE [r].[ResourceTypeId] = N'Group'
) AS [t] ON [g].[ContainerGroupId] = [t].[Id]
LEFT JOIN [GroupToGroupAssignments] AS [g0] ON [t].[Id] = [g0].[MemberGroupId]
WHERE [g].[MemberGroupId] = @__groupId_0
ORDER BY [g].[ContainerGroupId], [g].[MemberGroupId], [t].[Id], [g0].[ContainerGroupId], [g0].[MemberGroupId]
2022-02-17 16:51:55.831 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ResourceId], [g].[PermissionId], [g].[GroupId], [g].[GranteeType], [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [GrantedGroupPermissions] AS [g]
INNER JOIN [Resource] AS [r] ON [g].[ResourceId] = [r].[Id]
2022-02-17 16:51:55.887 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ResourceId], [r].[Name], [g].[PermissionId], [r].[ResourceTypeId]
FROM [GrantedUserPermissions] AS [g]
INNER JOIN [Resource] AS [r] ON [g].[ResourceId] = [r].[Id]
WHERE [g].[UserId] = @__userId_0
2022-02-17 16:51:55.956 -08:00 [INF] Executed action IdentityServer.Controllers.PermissionsController.UserPermissions (IdentityServer) in 8174.8905ms
2022-02-17 16:51:55.958 -08:00 [INF] Executed endpoint 'IdentityServer.Controllers.PermissionsController.UserPermissions (IdentityServer)'
2022-02-17 16:51:55.959 -08:00 [ERR] HTTP GET /api/permissions/RC1 responded 500 in 8315.4105 ms
System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Query.InvalidIncludePathError': Unable to find navigation 'Volume' specified in string based include path 'Volume'. This exception can be suppressed or logged by passing event ID 'CoreEventId.InvalidIncludePathError' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`2.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam1 arg1, TParam2 arg2)
   at Microsoft.EntityFrameworkCore.Diagnostics.CoreLoggerExtensions.InvalidIncludePathError(IDiagnosticsLogger`1 diagnostics, String navigationChain, String navigationName)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ProcessInclude(NavigationExpansionExpression source, Expression expression, Boolean thenInclude, Boolean setLoaded)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at System.Linq.Expressions.MethodCallExpression.Accept(ExpressionVisitor visitor)
   at System.Linq.Expressions.ExpressionVisitor.Visit(Expression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at IdentityServer.Controllers.PermissionsController.UserPermissions(String resourceTypeId) in C:\src\git\Viking\Servers\IdentityServer\IdentityServer\Controllers\PermissionsController.cs:line 110
   at lambda_method467(Closure , Object )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events, IBackChannelLogoutService backChannelLogoutService)
   at IdentityServer4.Hosting.MutualTlsEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-02-17 16:51:56.007 -08:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Query.InvalidIncludePathError': Unable to find navigation 'Volume' specified in string based include path 'Volume'. This exception can be suppressed or logged by passing event ID 'CoreEventId.InvalidIncludePathError' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`2.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam1 arg1, TParam2 arg2)
   at Microsoft.EntityFrameworkCore.Diagnostics.CoreLoggerExtensions.InvalidIncludePathError(IDiagnosticsLogger`1 diagnostics, String navigationChain, String navigationName)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ProcessInclude(NavigationExpansionExpression source, Expression expression, Boolean thenInclude, Boolean setLoaded)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at System.Linq.Expressions.MethodCallExpression.Accept(ExpressionVisitor visitor)
   at System.Linq.Expressions.ExpressionVisitor.Visit(Expression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at IdentityServer.Controllers.PermissionsController.UserPermissions(String resourceTypeId) in C:\src\git\Viking\Servers\IdentityServer\IdentityServer\Controllers\PermissionsController.cs:line 110
   at lambda_method467(Closure , Object )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events, IBackChannelLogoutService backChannelLogoutService)
   at IdentityServer4.Hosting.MutualTlsEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2022-02-17 16:51:56.032 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/RC1 - - - 500 - text/plain 8388.3067ms
2022-02-17 16:52:00.093 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:52:00.094 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:52:00.095 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:00.141 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:00.146 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 52.0746 ms
2022-02-17 16:52:00.147 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 54.0506ms
2022-02-17 16:52:00.190 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:52:00.191 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:52:00.193 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 2.2693 ms
2022-02-17 16:52:00.195 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 4.3834ms
2022-02-17 16:52:00.251 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:52:00.252 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:52:00.255 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:00.305 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:00.309 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIF3ATTK5F:00000002","TimeStamp":"2022-02-18T00:52:00.0000000Z","ProcessId":31080,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:52:00.361 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:00.408 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:52:00.455 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:00.502 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:52:00.506 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:52:00.506 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIF3ATTK5F:00000002","TimeStamp":"2022-02-18T00:52:00.0000000Z","ProcessId":31080,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:52:00.560 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:52:00.563 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:52:00.616 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:52:00.665 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:52:00.716 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:52:00.765 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:52:00.769 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****9O8A","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIF3ATTK5F:00000002","TimeStamp":"2022-02-18T00:52:00.0000000Z","ProcessId":31080,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:52:00.778 -08:00 [INF] HTTP POST /connect/token responded 200 in 526.1777 ms
2022-02-17 16:52:00.779 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 527.7956ms
2022-02-17 16:52:00.788 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:52:00.789 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:52:00.790 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:00.837 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:00.886 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:52:00.934 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:52:00.982 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:52:01.028 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:52:01.079 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:52:01.082 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:52:01.083 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 294.2931 ms
2022-02-17 16:52:01.085 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 296.6859ms
2022-02-17 16:52:01.093 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/CurrentUser - -
2022-02-17 16:52:01.096 -08:00 [INF] Successfully validated the token.
2022-02-17 16:52:01.097 -08:00 [INF] Start processing HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:52:01.099 -08:00 [INF] Sending HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:52:01.130 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161
2022-02-17 16:52:01.134 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2022-02-17 16:52:01.135 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:01.182 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:01.187 -08:00 [INF] {"ApiName":"mvc","Category":"Authentication","Name":"API Authentication Failure","EventType":"Failure","Id":1021,"Message":"Unknown API resource","ActivityId":"0HMFIF3ATTK5D:00000006","TimeStamp":"2022-02-18T00:52:01.0000000Z","ProcessId":31080,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ApiAuthenticationFailureEvent"}
2022-02-17 16:52:01.194 -08:00 [ERR] No API resource with that name found. aborting
2022-02-17 16:52:01.194 -08:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2022-02-17 16:52:01.195 -08:00 [INF] HTTP POST /connect/introspect responded 401 in 63.8100 ms
2022-02-17 16:52:01.196 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161 - 401 0 - 66.5727ms
2022-02-17 16:52:01.208 -08:00 [INF] Received HTTP response headers after 108.4533ms - 401
2022-02-17 16:52:01.209 -08:00 [INF] End processing HTTP request after 111.415ms - 401
2022-02-17 16:52:01.210 -08:00 [ERR] Error returned from introspection endpoint: Unauthorized
2022-02-17 16:52:01.210 -08:00 [INF] Introspection was not authenticated. Failure message: Error returned from introspection endpoint: Unauthorized
2022-02-17 16:52:01.211 -08:00 [INF] Authorization was successful.
2022-02-17 16:52:01.212 -08:00 [INF] Executing endpoint 'IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer)'
2022-02-17 16:52:01.212 -08:00 [INF] Route matched with {action = "GetUsername", controller = "Permissions"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] GetUsername() on controller IdentityServer.Controllers.PermissionsController (IdentityServer).
2022-02-17 16:52:01.235 -08:00 [INF] Executing action method IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer) - Validation state: "Valid"
2022-02-17 16:52:01.236 -08:00 [INF] Executed action method IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 0.0854ms.
2022-02-17 16:52:01.237 -08:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2022-02-17 16:52:01.238 -08:00 [INF] Executed action IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer) in 23.8369ms
2022-02-17 16:52:01.238 -08:00 [INF] Executed endpoint 'IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer)'
2022-02-17 16:52:01.239 -08:00 [INF] HTTP GET /api/permissions/CurrentUser responded 200 in 145.5543 ms
2022-02-17 16:52:01.240 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/CurrentUser - - - 200 - application/json;+charset=utf-8 147.5533ms
2022-02-17 16:52:01.241 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/RC1 - -
2022-02-17 16:52:01.243 -08:00 [INF] Successfully validated the token.
2022-02-17 16:52:01.243 -08:00 [INF] Start processing HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:52:01.244 -08:00 [INF] Sending HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:52:01.276 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161
2022-02-17 16:52:01.277 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2022-02-17 16:52:01.278 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:01.324 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:01.327 -08:00 [INF] {"ApiName":"mvc","Category":"Authentication","Name":"API Authentication Failure","EventType":"Failure","Id":1021,"Message":"Unknown API resource","ActivityId":"0HMFIF3ATTK5D:00000007","TimeStamp":"2022-02-18T00:52:01.0000000Z","ProcessId":31080,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ApiAuthenticationFailureEvent"}
2022-02-17 16:52:01.332 -08:00 [ERR] No API resource with that name found. aborting
2022-02-17 16:52:01.333 -08:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2022-02-17 16:52:01.333 -08:00 [INF] HTTP POST /connect/introspect responded 401 in 56.1444 ms
2022-02-17 16:52:01.334 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161 - 401 0 - 58.1716ms
2022-02-17 16:52:01.344 -08:00 [INF] Received HTTP response headers after 99.9504ms - 401
2022-02-17 16:52:01.345 -08:00 [INF] End processing HTTP request after 101.8326ms - 401
2022-02-17 16:52:01.346 -08:00 [ERR] Error returned from introspection endpoint: Unauthorized
2022-02-17 16:52:01.346 -08:00 [INF] Introspection was not authenticated. Failure message: Error returned from introspection endpoint: Unauthorized
2022-02-17 16:52:01.347 -08:00 [INF] Authorization was successful.
2022-02-17 16:52:01.348 -08:00 [INF] Executing endpoint 'IdentityServer.Controllers.PermissionsController.UserPermissions (IdentityServer)'
2022-02-17 16:52:01.348 -08:00 [INF] Route matched with {action = "UserPermissions", controller = "Permissions"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.Dictionary`2[System.Int64,System.Object]] UserPermissions(System.String) on controller IdentityServer.Controllers.PermissionsController (IdentityServer).
2022-02-17 16:52:01.370 -08:00 [INF] Executing action method IdentityServer.Controllers.PermissionsController.UserPermissions (IdentityServer) - Validation state: "Valid"
2022-02-17 16:52:02.728 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:02.775 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__username_0='jamesan' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[UserName] = @__username_0
2022-02-17 16:52:09.871 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[GroupId], [u].[UserId], [t].[Id], [t].[Description], [t].[Name], [t].[ParentID], [t].[ResourceTypeId], [g].[ContainerGroupId], [g].[MemberGroupId]
FROM [UserToGroupAssignments] AS [u]
INNER JOIN (
    SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId]
    FROM [Resource] AS [r]
    WHERE [r].[ResourceTypeId] = N'Group'
) AS [t] ON [u].[GroupId] = [t].[Id]
LEFT JOIN [GroupToGroupAssignments] AS [g] ON [t].[Id] = [g].[MemberGroupId]
WHERE [u].[UserId] = @__userId_0
ORDER BY [u].[GroupId], [u].[UserId], [t].[Id], [g].[ContainerGroupId], [g].[MemberGroupId]
2022-02-17 16:52:09.921 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__groupId_0='1'], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ContainerGroupId], [g].[MemberGroupId], [t].[Id], [t].[Description], [t].[Name], [t].[ParentID], [t].[ResourceTypeId], [g0].[ContainerGroupId], [g0].[MemberGroupId]
FROM [GroupToGroupAssignments] AS [g]
INNER JOIN (
    SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId]
    FROM [Resource] AS [r]
    WHERE [r].[ResourceTypeId] = N'Group'
) AS [t] ON [g].[ContainerGroupId] = [t].[Id]
LEFT JOIN [GroupToGroupAssignments] AS [g0] ON [t].[Id] = [g0].[MemberGroupId]
WHERE [g].[MemberGroupId] = @__groupId_0
ORDER BY [g].[ContainerGroupId], [g].[MemberGroupId], [t].[Id], [g0].[ContainerGroupId], [g0].[MemberGroupId]
2022-02-17 16:52:09.969 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ResourceId], [g].[PermissionId], [g].[GroupId], [g].[GranteeType], [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [GrantedGroupPermissions] AS [g]
INNER JOIN [Resource] AS [r] ON [g].[ResourceId] = [r].[Id]
2022-02-17 16:52:10.017 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ResourceId], [r].[Name], [g].[PermissionId], [r].[ResourceTypeId]
FROM [GrantedUserPermissions] AS [g]
INNER JOIN [Resource] AS [r] ON [g].[ResourceId] = [r].[Id]
WHERE [g].[UserId] = @__userId_0
2022-02-17 16:52:22.952 -08:00 [INF] Executed action IdentityServer.Controllers.PermissionsController.UserPermissions (IdentityServer) in 21602.2482ms
2022-02-17 16:52:22.953 -08:00 [INF] Executed endpoint 'IdentityServer.Controllers.PermissionsController.UserPermissions (IdentityServer)'
2022-02-17 16:52:22.955 -08:00 [ERR] HTTP GET /api/permissions/RC1 responded 500 in 21713.3161 ms
System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Query.InvalidIncludePathError': Unable to find navigation 'Volume' specified in string based include path 'Volume'. This exception can be suppressed or logged by passing event ID 'CoreEventId.InvalidIncludePathError' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`2.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam1 arg1, TParam2 arg2)
   at Microsoft.EntityFrameworkCore.Diagnostics.CoreLoggerExtensions.InvalidIncludePathError(IDiagnosticsLogger`1 diagnostics, String navigationChain, String navigationName)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ProcessInclude(NavigationExpansionExpression source, Expression expression, Boolean thenInclude, Boolean setLoaded)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at IdentityServer.Controllers.PermissionsController.UserPermissions(String resourceTypeId) in C:\src\git\Viking\Servers\IdentityServer\IdentityServer\Controllers\PermissionsController.cs:line 110
   at lambda_method467(Closure , Object )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events, IBackChannelLogoutService backChannelLogoutService)
   at IdentityServer4.Hosting.MutualTlsEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-02-17 16:52:22.957 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:52:23.022 -08:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Query.InvalidIncludePathError': Unable to find navigation 'Volume' specified in string based include path 'Volume'. This exception can be suppressed or logged by passing event ID 'CoreEventId.InvalidIncludePathError' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`2.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam1 arg1, TParam2 arg2)
   at Microsoft.EntityFrameworkCore.Diagnostics.CoreLoggerExtensions.InvalidIncludePathError(IDiagnosticsLogger`1 diagnostics, String navigationChain, String navigationName)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ProcessInclude(NavigationExpansionExpression source, Expression expression, Boolean thenInclude, Boolean setLoaded)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at IdentityServer.Controllers.PermissionsController.UserPermissions(String resourceTypeId) in C:\src\git\Viking\Servers\IdentityServer\IdentityServer\Controllers\PermissionsController.cs:line 110
   at lambda_method467(Closure , Object )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events, IBackChannelLogoutService backChannelLogoutService)
   at IdentityServer4.Hosting.MutualTlsEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2022-02-17 16:52:23.037 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/RC1 - - - 500 - text/plain 21796.1052ms
2022-02-17 16:52:23.077 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:52:23.080 -08:00 [INF] Removing 0 grants
2022-02-17 16:52:23.130 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:52:23.133 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:52:36.789 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:52:36.790 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:52:36.791 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:36.839 -08:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:36.842 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 52.3890 ms
2022-02-17 16:52:36.843 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 54.3181ms
2022-02-17 16:52:36.887 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:52:36.888 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:52:36.889 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 1.4435 ms
2022-02-17 16:52:36.890 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 3.0373ms
2022-02-17 16:52:36.949 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:52:36.955 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:52:36.958 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:37.009 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:37.013 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIF3ATTK5I:00000002","TimeStamp":"2022-02-18T00:52:37.0000000Z","ProcessId":31080,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:52:37.066 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:37.128 -08:00 [INF] Executed DbCommand (59ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:52:37.178 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:37.225 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:52:37.237 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:52:37.238 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIF3ATTK5I:00000002","TimeStamp":"2022-02-18T00:52:37.0000000Z","ProcessId":31080,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:52:37.293 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:52:37.296 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:52:37.348 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:52:37.398 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:52:37.447 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:52:37.494 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:52:37.501 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****XtGA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIF3ATTK5I:00000002","TimeStamp":"2022-02-18T00:52:37.0000000Z","ProcessId":31080,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:52:37.511 -08:00 [INF] HTTP POST /connect/token responded 200 in 561.0315 ms
2022-02-17 16:52:37.512 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 562.8666ms
2022-02-17 16:52:37.520 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:52:37.522 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:52:37.523 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:37.571 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:37.619 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:52:37.666 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:52:37.713 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:52:37.762 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:52:37.808 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:52:37.810 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:52:37.810 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 290.4010 ms
2022-02-17 16:52:37.812 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 292.2281ms
2022-02-17 16:52:37.819 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/CurrentUser - -
2022-02-17 16:52:37.820 -08:00 [INF] Successfully validated the token.
2022-02-17 16:52:37.820 -08:00 [INF] Start processing HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:52:37.821 -08:00 [INF] Sending HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:52:37.843 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161
2022-02-17 16:52:37.845 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2022-02-17 16:52:37.846 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:37.890 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:37.893 -08:00 [INF] {"ApiName":"mvc","Category":"Authentication","Name":"API Authentication Failure","EventType":"Failure","Id":1021,"Message":"Unknown API resource","ActivityId":"0HMFIF3ATTK5D:00000008","TimeStamp":"2022-02-18T00:52:37.0000000Z","ProcessId":31080,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ApiAuthenticationFailureEvent"}
2022-02-17 16:52:37.897 -08:00 [ERR] No API resource with that name found. aborting
2022-02-17 16:52:37.898 -08:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2022-02-17 16:52:37.899 -08:00 [INF] HTTP POST /connect/introspect responded 401 in 54.1504 ms
2022-02-17 16:52:37.900 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161 - 401 0 - 56.8546ms
2022-02-17 16:52:37.910 -08:00 [INF] Received HTTP response headers after 88.7084ms - 401
2022-02-17 16:52:37.911 -08:00 [INF] End processing HTTP request after 90.7425ms - 401
2022-02-17 16:52:37.912 -08:00 [ERR] Error returned from introspection endpoint: Unauthorized
2022-02-17 16:52:37.913 -08:00 [INF] Introspection was not authenticated. Failure message: Error returned from introspection endpoint: Unauthorized
2022-02-17 16:52:37.913 -08:00 [INF] Authorization was successful.
2022-02-17 16:52:37.914 -08:00 [INF] Executing endpoint 'IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer)'
2022-02-17 16:52:37.915 -08:00 [INF] Route matched with {action = "GetUsername", controller = "Permissions"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] GetUsername() on controller IdentityServer.Controllers.PermissionsController (IdentityServer).
2022-02-17 16:52:37.936 -08:00 [INF] Executing action method IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer) - Validation state: "Valid"
2022-02-17 16:52:37.938 -08:00 [INF] Executed action method IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 0.0589ms.
2022-02-17 16:52:37.940 -08:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2022-02-17 16:52:37.940 -08:00 [INF] Executed action IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer) in 24.5559ms
2022-02-17 16:52:37.941 -08:00 [INF] Executed endpoint 'IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer)'
2022-02-17 16:52:37.942 -08:00 [INF] HTTP GET /api/permissions/CurrentUser responded 200 in 122.6163 ms
2022-02-17 16:52:37.943 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/CurrentUser - - - 200 - application/json;+charset=utf-8 124.2472ms
2022-02-17 16:52:37.944 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/Volumes - -
2022-02-17 16:52:37.945 -08:00 [INF] Successfully validated the token.
2022-02-17 16:52:37.946 -08:00 [INF] Start processing HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:52:37.946 -08:00 [INF] Sending HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:52:37.981 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161
2022-02-17 16:52:37.982 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2022-02-17 16:52:37.983 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:38.028 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:38.030 -08:00 [INF] {"ApiName":"mvc","Category":"Authentication","Name":"API Authentication Failure","EventType":"Failure","Id":1021,"Message":"Unknown API resource","ActivityId":"0HMFIF3ATTK5D:00000009","TimeStamp":"2022-02-18T00:52:38.0000000Z","ProcessId":31080,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ApiAuthenticationFailureEvent"}
2022-02-17 16:52:38.035 -08:00 [ERR] No API resource with that name found. aborting
2022-02-17 16:52:38.035 -08:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2022-02-17 16:52:38.036 -08:00 [INF] HTTP POST /connect/introspect responded 401 in 53.4776 ms
2022-02-17 16:52:38.037 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161 - 401 0 - 55.6798ms
2022-02-17 16:52:38.046 -08:00 [INF] Received HTTP response headers after 99.4772ms - 401
2022-02-17 16:52:38.047 -08:00 [INF] End processing HTTP request after 101.5182ms - 401
2022-02-17 16:52:38.048 -08:00 [ERR] Error returned from introspection endpoint: Unauthorized
2022-02-17 16:52:38.048 -08:00 [INF] Introspection was not authenticated. Failure message: Error returned from introspection endpoint: Unauthorized
2022-02-17 16:52:38.049 -08:00 [INF] Authorization was successful.
2022-02-17 16:52:38.049 -08:00 [INF] Executing endpoint 'IdentityServer.Controllers.PermissionsController.UserPermissions (IdentityServer)'
2022-02-17 16:52:38.050 -08:00 [INF] Route matched with {action = "UserPermissions", controller = "Permissions"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.Dictionary`2[System.Int64,System.Object]] UserPermissions(System.String) on controller IdentityServer.Controllers.PermissionsController (IdentityServer).
2022-02-17 16:52:38.070 -08:00 [INF] Executing action method IdentityServer.Controllers.PermissionsController.UserPermissions (IdentityServer) - Validation state: "Valid"
2022-02-17 16:52:39.165 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:39.214 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__username_0='jamesan' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[UserName] = @__username_0
2022-02-17 16:52:39.263 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[GroupId], [u].[UserId], [t].[Id], [t].[Description], [t].[Name], [t].[ParentID], [t].[ResourceTypeId], [g].[ContainerGroupId], [g].[MemberGroupId]
FROM [UserToGroupAssignments] AS [u]
INNER JOIN (
    SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId]
    FROM [Resource] AS [r]
    WHERE [r].[ResourceTypeId] = N'Group'
) AS [t] ON [u].[GroupId] = [t].[Id]
LEFT JOIN [GroupToGroupAssignments] AS [g] ON [t].[Id] = [g].[MemberGroupId]
WHERE [u].[UserId] = @__userId_0
ORDER BY [u].[GroupId], [u].[UserId], [t].[Id], [g].[ContainerGroupId], [g].[MemberGroupId]
2022-02-17 16:52:39.313 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__groupId_0='1'], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ContainerGroupId], [g].[MemberGroupId], [t].[Id], [t].[Description], [t].[Name], [t].[ParentID], [t].[ResourceTypeId], [g0].[ContainerGroupId], [g0].[MemberGroupId]
FROM [GroupToGroupAssignments] AS [g]
INNER JOIN (
    SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId]
    FROM [Resource] AS [r]
    WHERE [r].[ResourceTypeId] = N'Group'
) AS [t] ON [g].[ContainerGroupId] = [t].[Id]
LEFT JOIN [GroupToGroupAssignments] AS [g0] ON [t].[Id] = [g0].[MemberGroupId]
WHERE [g].[MemberGroupId] = @__groupId_0
ORDER BY [g].[ContainerGroupId], [g].[MemberGroupId], [t].[Id], [g0].[ContainerGroupId], [g0].[MemberGroupId]
2022-02-17 16:52:39.361 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ResourceId], [g].[PermissionId], [g].[GroupId], [g].[GranteeType], [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [GrantedGroupPermissions] AS [g]
INNER JOIN [Resource] AS [r] ON [g].[ResourceId] = [r].[Id]
2022-02-17 16:52:39.409 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ResourceId], [r].[Name], [g].[PermissionId], [r].[ResourceTypeId]
FROM [GrantedUserPermissions] AS [g]
INNER JOIN [Resource] AS [r] ON [g].[ResourceId] = [r].[Id]
WHERE [g].[UserId] = @__userId_0
2022-02-17 16:52:39.437 -08:00 [INF] Executed action IdentityServer.Controllers.PermissionsController.UserPermissions (IdentityServer) in 1386.0952ms
2022-02-17 16:52:39.438 -08:00 [INF] Executed endpoint 'IdentityServer.Controllers.PermissionsController.UserPermissions (IdentityServer)'
2022-02-17 16:52:39.440 -08:00 [ERR] HTTP GET /api/permissions/Volumes responded 500 in 1495.3758 ms
System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Query.InvalidIncludePathError': Unable to find navigation 'Volume' specified in string based include path 'Volume'. This exception can be suppressed or logged by passing event ID 'CoreEventId.InvalidIncludePathError' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`2.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam1 arg1, TParam2 arg2)
   at Microsoft.EntityFrameworkCore.Diagnostics.CoreLoggerExtensions.InvalidIncludePathError(IDiagnosticsLogger`1 diagnostics, String navigationChain, String navigationName)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ProcessInclude(NavigationExpansionExpression source, Expression expression, Boolean thenInclude, Boolean setLoaded)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at IdentityServer.Controllers.PermissionsController.UserPermissions(String resourceTypeId) in C:\src\git\Viking\Servers\IdentityServer\IdentityServer\Controllers\PermissionsController.cs:line 110
   at lambda_method467(Closure , Object )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events, IBackChannelLogoutService backChannelLogoutService)
   at IdentityServer4.Hosting.MutualTlsEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-02-17 16:52:39.452 -08:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Query.InvalidIncludePathError': Unable to find navigation 'Volume' specified in string based include path 'Volume'. This exception can be suppressed or logged by passing event ID 'CoreEventId.InvalidIncludePathError' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`2.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam1 arg1, TParam2 arg2)
   at Microsoft.EntityFrameworkCore.Diagnostics.CoreLoggerExtensions.InvalidIncludePathError(IDiagnosticsLogger`1 diagnostics, String navigationChain, String navigationName)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ProcessInclude(NavigationExpansionExpression source, Expression expression, Boolean thenInclude, Boolean setLoaded)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at IdentityServer.Controllers.PermissionsController.UserPermissions(String resourceTypeId) in C:\src\git\Viking\Servers\IdentityServer\IdentityServer\Controllers\PermissionsController.cs:line 110
   at lambda_method467(Closure , Object )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events, IBackChannelLogoutService backChannelLogoutService)
   at IdentityServer4.Hosting.MutualTlsEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2022-02-17 16:52:39.466 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/Volumes - - - 500 - text/plain 1522.4737ms
2022-02-17 16:52:49.658 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:52:49.659 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:52:49.659 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:49.707 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:49.709 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 51.1569 ms
2022-02-17 16:52:49.711 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 53.1075ms
2022-02-17 16:52:49.764 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:52:49.765 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:52:49.766 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 1.3135 ms
2022-02-17 16:52:49.768 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 3.4980ms
2022-02-17 16:52:49.825 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:52:49.826 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:52:49.830 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:49.877 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:49.884 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIF3ATTK5L:00000002","TimeStamp":"2022-02-18T00:52:49.0000000Z","ProcessId":31080,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:52:49.934 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:49.984 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:52:50.030 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:50.081 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:52:50.086 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:52:50.087 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIF3ATTK5L:00000002","TimeStamp":"2022-02-18T00:52:50.0000000Z","ProcessId":31080,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:52:50.148 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:52:50.151 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:52:50.202 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:52:50.250 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:52:50.296 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:52:50.342 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:52:50.347 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****Y9nw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIF3ATTK5L:00000002","TimeStamp":"2022-02-18T00:52:50.0000000Z","ProcessId":31080,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:52:50.356 -08:00 [INF] HTTP POST /connect/token responded 200 in 529.8284 ms
2022-02-17 16:52:50.358 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 533.0108ms
2022-02-17 16:52:50.366 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:52:50.367 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:52:50.368 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:50.417 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:50.468 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:52:50.524 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:52:50.571 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:52:50.622 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:52:50.670 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:52:50.673 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:52:50.673 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 306.6443 ms
2022-02-17 16:52:50.675 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 308.3869ms
2022-02-17 16:52:50.683 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/CurrentUser - -
2022-02-17 16:52:50.684 -08:00 [INF] Successfully validated the token.
2022-02-17 16:52:50.685 -08:00 [INF] Start processing HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:52:50.686 -08:00 [INF] Sending HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:52:50.711 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161
2022-02-17 16:52:50.713 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2022-02-17 16:52:50.715 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:50.762 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:50.764 -08:00 [INF] {"ApiName":"mvc","Category":"Authentication","Name":"API Authentication Failure","EventType":"Failure","Id":1021,"Message":"Unknown API resource","ActivityId":"0HMFIF3ATTK5D:0000000A","TimeStamp":"2022-02-18T00:52:50.0000000Z","ProcessId":31080,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ApiAuthenticationFailureEvent"}
2022-02-17 16:52:50.769 -08:00 [ERR] No API resource with that name found. aborting
2022-02-17 16:52:50.769 -08:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2022-02-17 16:52:50.770 -08:00 [INF] HTTP POST /connect/introspect responded 401 in 56.9129 ms
2022-02-17 16:52:50.771 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161 - 401 0 - 60.1210ms
2022-02-17 16:52:50.781 -08:00 [INF] Received HTTP response headers after 95.0114ms - 401
2022-02-17 16:52:50.781 -08:00 [INF] End processing HTTP request after 96.6444ms - 401
2022-02-17 16:52:50.782 -08:00 [ERR] Error returned from introspection endpoint: Unauthorized
2022-02-17 16:52:50.783 -08:00 [INF] Introspection was not authenticated. Failure message: Error returned from introspection endpoint: Unauthorized
2022-02-17 16:52:50.783 -08:00 [INF] Authorization was successful.
2022-02-17 16:52:50.784 -08:00 [INF] Executing endpoint 'IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer)'
2022-02-17 16:52:50.784 -08:00 [INF] Route matched with {action = "GetUsername", controller = "Permissions"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] GetUsername() on controller IdentityServer.Controllers.PermissionsController (IdentityServer).
2022-02-17 16:52:50.805 -08:00 [INF] Executing action method IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer) - Validation state: "Valid"
2022-02-17 16:52:50.806 -08:00 [INF] Executed action method IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 0.0223ms.
2022-02-17 16:52:50.808 -08:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2022-02-17 16:52:50.809 -08:00 [INF] Executed action IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer) in 23.4712ms
2022-02-17 16:52:50.810 -08:00 [INF] Executed endpoint 'IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer)'
2022-02-17 16:52:50.811 -08:00 [INF] HTTP GET /api/permissions/CurrentUser responded 200 in 127.6068 ms
2022-02-17 16:52:50.812 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/CurrentUser - - - 200 - application/json;+charset=utf-8 129.5412ms
2022-02-17 16:52:50.813 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/Volume - -
2022-02-17 16:52:50.814 -08:00 [INF] Successfully validated the token.
2022-02-17 16:52:50.815 -08:00 [INF] Start processing HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:52:50.816 -08:00 [INF] Sending HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:52:50.854 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161
2022-02-17 16:52:50.856 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2022-02-17 16:52:50.857 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:50.905 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:50.907 -08:00 [INF] {"ApiName":"mvc","Category":"Authentication","Name":"API Authentication Failure","EventType":"Failure","Id":1021,"Message":"Unknown API resource","ActivityId":"0HMFIF3ATTK5D:0000000B","TimeStamp":"2022-02-18T00:52:50.0000000Z","ProcessId":31080,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ApiAuthenticationFailureEvent"}
2022-02-17 16:52:50.911 -08:00 [ERR] No API resource with that name found. aborting
2022-02-17 16:52:50.912 -08:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2022-02-17 16:52:50.912 -08:00 [INF] HTTP POST /connect/introspect responded 401 in 57.0360 ms
2022-02-17 16:52:50.914 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161 - 401 0 - 59.7093ms
2022-02-17 16:52:50.923 -08:00 [INF] Received HTTP response headers after 106.8386ms - 401
2022-02-17 16:52:50.923 -08:00 [INF] End processing HTTP request after 108.4471ms - 401
2022-02-17 16:52:50.924 -08:00 [ERR] Error returned from introspection endpoint: Unauthorized
2022-02-17 16:52:50.925 -08:00 [INF] Introspection was not authenticated. Failure message: Error returned from introspection endpoint: Unauthorized
2022-02-17 16:52:50.926 -08:00 [INF] Authorization was successful.
2022-02-17 16:52:50.926 -08:00 [INF] Executing endpoint 'IdentityServer.Controllers.PermissionsController.UserPermissions (IdentityServer)'
2022-02-17 16:52:50.927 -08:00 [INF] Route matched with {action = "UserPermissions", controller = "Permissions"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.Dictionary`2[System.Int64,System.Object]] UserPermissions(System.String) on controller IdentityServer.Controllers.PermissionsController (IdentityServer).
2022-02-17 16:52:50.947 -08:00 [INF] Executing action method IdentityServer.Controllers.PermissionsController.UserPermissions (IdentityServer) - Validation state: "Valid"
2022-02-17 16:52:52.147 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:52.195 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__username_0='jamesan' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[UserName] = @__username_0
2022-02-17 16:52:52.245 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[GroupId], [u].[UserId], [t].[Id], [t].[Description], [t].[Name], [t].[ParentID], [t].[ResourceTypeId], [g].[ContainerGroupId], [g].[MemberGroupId]
FROM [UserToGroupAssignments] AS [u]
INNER JOIN (
    SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId]
    FROM [Resource] AS [r]
    WHERE [r].[ResourceTypeId] = N'Group'
) AS [t] ON [u].[GroupId] = [t].[Id]
LEFT JOIN [GroupToGroupAssignments] AS [g] ON [t].[Id] = [g].[MemberGroupId]
WHERE [u].[UserId] = @__userId_0
ORDER BY [u].[GroupId], [u].[UserId], [t].[Id], [g].[ContainerGroupId], [g].[MemberGroupId]
2022-02-17 16:52:52.294 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__groupId_0='1'], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ContainerGroupId], [g].[MemberGroupId], [t].[Id], [t].[Description], [t].[Name], [t].[ParentID], [t].[ResourceTypeId], [g0].[ContainerGroupId], [g0].[MemberGroupId]
FROM [GroupToGroupAssignments] AS [g]
INNER JOIN (
    SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId]
    FROM [Resource] AS [r]
    WHERE [r].[ResourceTypeId] = N'Group'
) AS [t] ON [g].[ContainerGroupId] = [t].[Id]
LEFT JOIN [GroupToGroupAssignments] AS [g0] ON [t].[Id] = [g0].[MemberGroupId]
WHERE [g].[MemberGroupId] = @__groupId_0
ORDER BY [g].[ContainerGroupId], [g].[MemberGroupId], [t].[Id], [g0].[ContainerGroupId], [g0].[MemberGroupId]
2022-02-17 16:52:52.345 -08:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ResourceId], [g].[PermissionId], [g].[GroupId], [g].[GranteeType], [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [GrantedGroupPermissions] AS [g]
INNER JOIN [Resource] AS [r] ON [g].[ResourceId] = [r].[Id]
2022-02-17 16:52:52.391 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ResourceId], [r].[Name], [g].[PermissionId], [r].[ResourceTypeId]
FROM [GrantedUserPermissions] AS [g]
INNER JOIN [Resource] AS [r] ON [g].[ResourceId] = [r].[Id]
WHERE [g].[UserId] = @__userId_0
2022-02-17 16:52:52.420 -08:00 [INF] Executed action IdentityServer.Controllers.PermissionsController.UserPermissions (IdentityServer) in 1491.2217ms
2022-02-17 16:52:52.421 -08:00 [INF] Executed endpoint 'IdentityServer.Controllers.PermissionsController.UserPermissions (IdentityServer)'
2022-02-17 16:52:52.422 -08:00 [ERR] HTTP GET /api/permissions/Volume responded 500 in 1608.3013 ms
System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Query.InvalidIncludePathError': Unable to find navigation 'Volume' specified in string based include path 'Volume'. This exception can be suppressed or logged by passing event ID 'CoreEventId.InvalidIncludePathError' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`2.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam1 arg1, TParam2 arg2)
   at Microsoft.EntityFrameworkCore.Diagnostics.CoreLoggerExtensions.InvalidIncludePathError(IDiagnosticsLogger`1 diagnostics, String navigationChain, String navigationName)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ProcessInclude(NavigationExpansionExpression source, Expression expression, Boolean thenInclude, Boolean setLoaded)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at IdentityServer.Controllers.PermissionsController.UserPermissions(String resourceTypeId) in C:\src\git\Viking\Servers\IdentityServer\IdentityServer\Controllers\PermissionsController.cs:line 110
   at lambda_method467(Closure , Object )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events, IBackChannelLogoutService backChannelLogoutService)
   at IdentityServer4.Hosting.MutualTlsEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-02-17 16:52:52.434 -08:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Query.InvalidIncludePathError': Unable to find navigation 'Volume' specified in string based include path 'Volume'. This exception can be suppressed or logged by passing event ID 'CoreEventId.InvalidIncludePathError' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`2.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam1 arg1, TParam2 arg2)
   at Microsoft.EntityFrameworkCore.Diagnostics.CoreLoggerExtensions.InvalidIncludePathError(IDiagnosticsLogger`1 diagnostics, String navigationChain, String navigationName)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ProcessInclude(NavigationExpansionExpression source, Expression expression, Boolean thenInclude, Boolean setLoaded)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at IdentityServer.Controllers.PermissionsController.UserPermissions(String resourceTypeId) in C:\src\git\Viking\Servers\IdentityServer\IdentityServer\Controllers\PermissionsController.cs:line 110
   at lambda_method467(Closure , Object )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events, IBackChannelLogoutService backChannelLogoutService)
   at IdentityServer4.Hosting.MutualTlsEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2022-02-17 16:52:52.446 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/Volume - - - 500 - text/plain 1633.0482ms
2022-02-17 16:52:53.160 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:52:53.208 -08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:52:53.210 -08:00 [INF] Removing 0 grants
2022-02-17 16:52:53.255 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:52:53.257 -08:00 [INF] Removing 0 device flow codes
2022-02-17 16:52:57.348 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - -
2022-02-17 16:52:57.349 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2022-02-17 16:52:57.350 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:57.396 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:57.400 -08:00 [INF] HTTP GET /.well-known/openid-configuration responded 200 in 50.9255 ms
2022-02-17 16:52:57.401 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration - - - 200 - application/json;+charset=UTF-8 52.9975ms
2022-02-17 16:52:57.444 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - -
2022-02-17 16:52:57.445 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2022-02-17 16:52:57.446 -08:00 [INF] HTTP GET /.well-known/openid-configuration/jwks responded 200 in 1.0362 ms
2022-02-17 16:52:57.447 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/.well-known/openid-configuration/jwks - - - 200 - application/json;+charset=UTF-8 2.9003ms
2022-02-17 16:52:57.504 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147
2022-02-17 16:52:57.505 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2022-02-17 16:52:57.508 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:57.555 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:57.558 -08:00 [INF] {"ClientId":"ro.viking","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HMFIF3ATTK5O:00000002","TimeStamp":"2022-02-18T00:52:57.0000000Z","ProcessId":31080,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2022-02-17 16:52:57.612 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:57.659 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__scope_ScopeName_0='Annotation' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT [p].[ResourceTypeId]
FROM [Permissions] AS [p]
WHERE [p].[PermissionId] = @__scope_ScopeName_0
2022-02-17 16:52:57.981 -08:00 [INF] Executed DbCommand (318ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:58.028 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedUserName_0='JAMESAN' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2022-02-17 16:52:58.031 -08:00 [INF] Credentials validated for username: jamesan
2022-02-17 16:52:58.032 -08:00 [INF] {"Username":"jamesan","Provider":null,"ProviderUserId":null,"SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","DisplayName":null,"Endpoint":"Token","ClientId":"ro.viking","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HMFIF3ATTK5O:00000002","TimeStamp":"2022-02-18T00:52:58.0000000Z","ProcessId":31080,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2022-02-17 16:52:58.084 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__ResourceName_0='Viking' (Size = 128)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [Resource] AS [r]
WHERE [r].[Name] = @__ResourceName_0
2022-02-17 16:52:58.086 -08:00 [INF] Token request validation success, {"ClientId":"ro.viking","ClientName":null,"GrantType":"password","Scopes":"openid Viking.Annotation","AuthorizationCode":"********","RefreshToken":"********","UserName":"jamesan","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"jamesan","password":"***REDACTED***","scope":"openid Viking.Annotation","client_id":"ro.viking","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2022-02-17 16:52:58.137 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:52:58.185 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:52:58.233 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:52:58.279 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:52:58.283 -08:00 [INF] {"ClientId":"ro.viking","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"f89b1e95-8afd-48c4-bc81-a55be1297621","Scopes":"openid Viking.Annotation","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****yCxw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HMFIF3ATTK5O:00000002","TimeStamp":"2022-02-18T00:52:58.0000000Z","ProcessId":31080,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2022-02-17 16:52:58.292 -08:00 [INF] HTTP POST /connect/token responded 200 in 787.5527 ms
2022-02-17 16:52:58.293 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/token application/x-www-form-urlencoded 147 - 200 - application/json;+charset=UTF-8 789.0797ms
2022-02-17 16:52:58.301 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/connect/userinfo - -
2022-02-17 16:52:58.302 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2022-02-17 16:52:58.303 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:58.352 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:58.403 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__p_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2022-02-17 16:52:58.451 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__user_Id_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2022-02-17 16:52:58.499 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN (
    SELECT [a0].[Id], [a0].[Name]
    FROM [AspNetRoles] AS [a0]
    WHERE [a0].[Discriminator] = N'ApplicationRole'
) AS [t] ON [a].[RoleId] = [t].[Id]
WHERE [a].[UserId] = @__userId_0
2022-02-17 16:52:58.547 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__normalizedName_0='ADMINISTRATOR' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE ([a].[Discriminator] = N'ApplicationRole') AND ([a].[NormalizedName] = @__normalizedName_0)
2022-02-17 16:52:58.594 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__role_Id_0='cdf2b676-7edc-4d96-9ebb-8d1968734482' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2022-02-17 16:52:58.596 -08:00 [INF] Profile service returned the following claim types: sub
2022-02-17 16:52:58.597 -08:00 [INF] HTTP GET /connect/userinfo responded 200 in 295.2204 ms
2022-02-17 16:52:58.598 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/connect/userinfo - - - 200 - application/json;+charset=UTF-8 296.9464ms
2022-02-17 16:52:58.605 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/CurrentUser - -
2022-02-17 16:52:58.606 -08:00 [INF] Successfully validated the token.
2022-02-17 16:52:58.608 -08:00 [INF] Start processing HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:52:58.608 -08:00 [INF] Sending HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:52:58.629 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161
2022-02-17 16:52:58.631 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2022-02-17 16:52:58.632 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:58.678 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:58.681 -08:00 [INF] {"ApiName":"mvc","Category":"Authentication","Name":"API Authentication Failure","EventType":"Failure","Id":1021,"Message":"Unknown API resource","ActivityId":"0HMFIF3ATTK5D:0000000C","TimeStamp":"2022-02-18T00:52:58.0000000Z","ProcessId":31080,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ApiAuthenticationFailureEvent"}
2022-02-17 16:52:58.686 -08:00 [ERR] No API resource with that name found. aborting
2022-02-17 16:52:58.687 -08:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2022-02-17 16:52:58.688 -08:00 [INF] HTTP POST /connect/introspect responded 401 in 57.0378 ms
2022-02-17 16:52:58.689 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161 - 401 0 - 59.8624ms
2022-02-17 16:52:58.698 -08:00 [INF] Received HTTP response headers after 89.9169ms - 401
2022-02-17 16:52:58.699 -08:00 [INF] End processing HTTP request after 91.2354ms - 401
2022-02-17 16:52:58.700 -08:00 [ERR] Error returned from introspection endpoint: Unauthorized
2022-02-17 16:52:58.700 -08:00 [INF] Introspection was not authenticated. Failure message: Error returned from introspection endpoint: Unauthorized
2022-02-17 16:52:58.703 -08:00 [INF] Authorization was successful.
2022-02-17 16:52:58.704 -08:00 [INF] Executing endpoint 'IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer)'
2022-02-17 16:52:58.705 -08:00 [INF] Route matched with {action = "GetUsername", controller = "Permissions"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] GetUsername() on controller IdentityServer.Controllers.PermissionsController (IdentityServer).
2022-02-17 16:52:58.725 -08:00 [INF] Executing action method IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer) - Validation state: "Valid"
2022-02-17 16:52:58.726 -08:00 [INF] Executed action method IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 0.0218ms.
2022-02-17 16:52:58.728 -08:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2022-02-17 16:52:58.729 -08:00 [INF] Executed action IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer) in 23.016ms
2022-02-17 16:52:58.730 -08:00 [INF] Executed endpoint 'IdentityServer.Controllers.PermissionsController.GetUsername (IdentityServer)'
2022-02-17 16:52:58.731 -08:00 [INF] HTTP GET /api/permissions/CurrentUser responded 200 in 125.0553 ms
2022-02-17 16:52:58.732 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/CurrentUser - - - 200 - application/json;+charset=utf-8 126.8744ms
2022-02-17 16:52:58.734 -08:00 [INF] Request starting HTTP/1.1 GET https://localhost:5001/api/permissions/Volume - -
2022-02-17 16:52:58.735 -08:00 [INF] Successfully validated the token.
2022-02-17 16:52:58.736 -08:00 [INF] Start processing HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:52:58.737 -08:00 [INF] Sending HTTP request POST "https://localhost:5001/connect/introspect"
2022-02-17 16:52:58.774 -08:00 [INF] Request starting HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161
2022-02-17 16:52:58.776 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
2022-02-17 16:52:58.777 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:52:58.823 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint], [r0].[Id], [r0].[Description], [p].[ResourceTypeId], [p].[PermissionId], [p].[Description]
FROM [Resource] AS [r]
INNER JOIN [ResourceTypes] AS [r0] ON [r].[ResourceTypeId] = [r0].[Id]
LEFT JOIN [Permissions] AS [p] ON [r0].[Id] = [p].[ResourceTypeId]
WHERE 0 = 1
ORDER BY [r].[Id], [r0].[Id], [p].[ResourceTypeId], [p].[PermissionId]
2022-02-17 16:52:58.825 -08:00 [INF] {"ApiName":"mvc","Category":"Authentication","Name":"API Authentication Failure","EventType":"Failure","Id":1021,"Message":"Unknown API resource","ActivityId":"0HMFIF3ATTK5D:0000000D","TimeStamp":"2022-02-18T00:52:58.0000000Z","ProcessId":31080,"LocalIpAddress":"::1:5001","RemoteIpAddress":"::1","$type":"ApiAuthenticationFailureEvent"}
2022-02-17 16:52:58.830 -08:00 [ERR] No API resource with that name found. aborting
2022-02-17 16:52:58.831 -08:00 [ERR] API unauthorized to call introspection endpoint. aborting.
2022-02-17 16:52:58.831 -08:00 [INF] HTTP POST /connect/introspect responded 401 in 55.5025 ms
2022-02-17 16:52:58.832 -08:00 [INF] Request finished HTTP/1.1 POST https://localhost:5001/connect/introspect application/x-www-form-urlencoded 1161 - 401 0 - 58.0596ms
2022-02-17 16:52:58.841 -08:00 [INF] Received HTTP response headers after 104.1306ms - 401
2022-02-17 16:52:58.842 -08:00 [INF] End processing HTTP request after 105.7735ms - 401
2022-02-17 16:52:58.844 -08:00 [ERR] Error returned from introspection endpoint: Unauthorized
2022-02-17 16:52:58.845 -08:00 [INF] Introspection was not authenticated. Failure message: Error returned from introspection endpoint: Unauthorized
2022-02-17 16:52:58.846 -08:00 [INF] Authorization was successful.
2022-02-17 16:52:58.846 -08:00 [INF] Executing endpoint 'IdentityServer.Controllers.PermissionsController.UserPermissions (IdentityServer)'
2022-02-17 16:52:58.847 -08:00 [INF] Route matched with {action = "UserPermissions", controller = "Permissions"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.Dictionary`2[System.Int64,System.Object]] UserPermissions(System.String) on controller IdentityServer.Controllers.PermissionsController (IdentityServer).
2022-02-17 16:52:58.867 -08:00 [INF] Executing action method IdentityServer.Controllers.PermissionsController.UserPermissions (IdentityServer) - Validation state: "Valid"
2022-02-17 16:53:00.212 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: SensitiveDataLoggingEnabled DetailedErrorsEnabled 
2022-02-17 16:53:00.260 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__username_0='jamesan' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[FamilyName], [a].[GivenName], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[RegistrationDate], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[UserName] = @__username_0
2022-02-17 16:53:02.710 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[GroupId], [u].[UserId], [t].[Id], [t].[Description], [t].[Name], [t].[ParentID], [t].[ResourceTypeId], [g].[ContainerGroupId], [g].[MemberGroupId]
FROM [UserToGroupAssignments] AS [u]
INNER JOIN (
    SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId]
    FROM [Resource] AS [r]
    WHERE [r].[ResourceTypeId] = N'Group'
) AS [t] ON [u].[GroupId] = [t].[Id]
LEFT JOIN [GroupToGroupAssignments] AS [g] ON [t].[Id] = [g].[MemberGroupId]
WHERE [u].[UserId] = @__userId_0
ORDER BY [u].[GroupId], [u].[UserId], [t].[Id], [g].[ContainerGroupId], [g].[MemberGroupId]
2022-02-17 16:53:02.768 -08:00 [INF] Executed DbCommand (46ms) [Parameters=[@__groupId_0='1'], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ContainerGroupId], [g].[MemberGroupId], [t].[Id], [t].[Description], [t].[Name], [t].[ParentID], [t].[ResourceTypeId], [g0].[ContainerGroupId], [g0].[MemberGroupId]
FROM [GroupToGroupAssignments] AS [g]
INNER JOIN (
    SELECT [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId]
    FROM [Resource] AS [r]
    WHERE [r].[ResourceTypeId] = N'Group'
) AS [t] ON [g].[ContainerGroupId] = [t].[Id]
LEFT JOIN [GroupToGroupAssignments] AS [g0] ON [t].[Id] = [g0].[MemberGroupId]
WHERE [g].[MemberGroupId] = @__groupId_0
ORDER BY [g].[ContainerGroupId], [g].[MemberGroupId], [t].[Id], [g0].[ContainerGroupId], [g0].[MemberGroupId]
2022-02-17 16:53:02.822 -08:00 [INF] Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ResourceId], [g].[PermissionId], [g].[GroupId], [g].[GranteeType], [r].[Id], [r].[Description], [r].[Name], [r].[ParentID], [r].[ResourceTypeId], [r].[Endpoint]
FROM [GrantedGroupPermissions] AS [g]
INNER JOIN [Resource] AS [r] ON [g].[ResourceId] = [r].[Id]
2022-02-17 16:53:02.868 -08:00 [INF] Executed DbCommand (44ms) [Parameters=[@__userId_0='f89b1e95-8afd-48c4-bc81-a55be1297621' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [g].[ResourceId], [r].[Name], [g].[PermissionId], [r].[ResourceTypeId]
FROM [GrantedUserPermissions] AS [g]
INNER JOIN [Resource] AS [r] ON [g].[ResourceId] = [r].[Id]
WHERE [g].[UserId] = @__userId_0
2022-02-17 16:53:09.685 -08:00 [INF] Executed action IdentityServer.Controllers.PermissionsController.UserPermissions (IdentityServer) in 10836.75ms
2022-02-17 16:53:09.686 -08:00 [INF] Executed endpoint 'IdentityServer.Controllers.PermissionsController.UserPermissions (IdentityServer)'
2022-02-17 16:53:09.687 -08:00 [ERR] HTTP GET /api/permissions/Volume responded 500 in 10952.4553 ms
System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Query.InvalidIncludePathError': Unable to find navigation 'Volume' specified in string based include path 'Volume'. This exception can be suppressed or logged by passing event ID 'CoreEventId.InvalidIncludePathError' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`2.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam1 arg1, TParam2 arg2)
   at Microsoft.EntityFrameworkCore.Diagnostics.CoreLoggerExtensions.InvalidIncludePathError(IDiagnosticsLogger`1 diagnostics, String navigationChain, String navigationName)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ProcessInclude(NavigationExpansionExpression source, Expression expression, Boolean thenInclude, Boolean setLoaded)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at IdentityServer.Controllers.PermissionsController.UserPermissions(String resourceTypeId) in C:\src\git\Viking\Servers\IdentityServer\IdentityServer\Controllers\PermissionsController.cs:line 110
   at lambda_method467(Closure , Object )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events, IBackChannelLogoutService backChannelLogoutService)
   at IdentityServer4.Hosting.MutualTlsEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2022-02-17 16:53:09.702 -08:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Query.InvalidIncludePathError': Unable to find navigation 'Volume' specified in string based include path 'Volume'. This exception can be suppressed or logged by passing event ID 'CoreEventId.InvalidIncludePathError' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`2.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam1 arg1, TParam2 arg2)
   at Microsoft.EntityFrameworkCore.Diagnostics.CoreLoggerExtensions.InvalidIncludePathError(IDiagnosticsLogger`1 diagnostics, String navigationChain, String navigationName)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ProcessInclude(NavigationExpansionExpression source, Expression expression, Boolean thenInclude, Boolean setLoaded)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at IdentityServer.Controllers.PermissionsController.UserPermissions(String resourceTypeId) in C:\src\git\Viking\Servers\IdentityServer\IdentityServer\Controllers\PermissionsController.cs:line 110
   at lambda_method467(Closure , Object )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events, IBackChannelLogoutService backChannelLogoutService)
   at IdentityServer4.Hosting.MutualTlsEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2022-02-17 16:53:09.719 -08:00 [INF] Request finished HTTP/1.1 GET https://localhost:5001/api/permissions/Volume - - - 500 - text/plain 10984.9210ms
2022-02-17 16:53:23.269 -08:00 [INF] Entity Framework Core 5.0.12 initialized 'PersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: MigrationsAssembly=IdentityServer 
2022-02-17 16:53:23.317 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [p].[Key], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Expiration] < GETUTCDATE()
ORDER BY [p].[Key]
2022-02-17 16:53:23.319 -08:00 [INF] Removing 0 grants
2022-02-17 16:53:23.364 -08:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [d].[UserCode], [d].[ClientId], [d].[CreationTime], [d].[Data], [d].[Description], [d].[DeviceCode], [d].[Expiration], [d].[SessionId], [d].[SubjectId]
FROM [DeviceCodes] AS [d]
WHERE [d].[Expiration] < GETUTCDATE()
ORDER BY [d].[DeviceCode]
2022-02-17 16:53:23.366 -08:00 [INF] Removing 0 device flow codes
